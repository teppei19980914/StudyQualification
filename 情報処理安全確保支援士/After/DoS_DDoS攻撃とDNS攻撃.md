# DoS/DDoS攻撃とDNS攻撃 ― サービス妨害攻撃とDNSを標的とした攻撃手法の体系的整理

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。
**本記事は学習した内容を記載しています。**

## 該当問題

[情報セキュリティスペシャリスト平成23年秋期 午前Ⅱ 問9](https://www.sc-siken.com/kakomon/23_aki/am2_9.html)
[情報セキュリティスペシャリスト平成25年秋期 午前Ⅱ 問14](https://www.sc-siken.com/kakomon/25_aki/am2_14.html)
[情報セキュリティスペシャリスト平成26年秋期 午前Ⅱ 問9](https://www.sc-siken.com/kakomon/26_aki/am2_9.html)
[情報セキュリティスペシャリスト平成27年春期 午前Ⅱ 問10](https://www.sc-siken.com/kakomon/27_haru/am2_10.html)
[情報セキュリティスペシャリスト平成27年春期 午前Ⅱ 問15](https://www.sc-siken.com/kakomon/27_haru/am2_15.html)
[情報セキュリティスペシャリスト平成28年秋期 午前Ⅱ 問2](https://www.sc-siken.com/kakomon/28_aki/am2_2.html)
[情報処理安全確保支援士平成29年春期 午前Ⅱ 問6](https://www.sc-siken.com/kakomon/29_haru/am2_6.html)
[情報処理安全確保支援士平成29年秋期 午前Ⅱ 問6](https://www.sc-siken.com/kakomon/29_aki/am2_6.html)
[情報処理安全確保支援士平成30年秋期 午前Ⅱ 問4](https://www.sc-siken.com/kakomon/30_aki/am2_4.html)
[情報処理安全確保支援士令和4年春期 午前Ⅱ 問13](https://www.sc-siken.com/kakomon/04_haru/am2_13.html)

## DoS(Denial of Service)攻撃

DoS攻撃とは、**正規ユーザがサービスを利用できない状態を作り出す攻撃**です。

目的：

- サービス停止
- 遅延発生(可用性低下)
- 帯域や計算資源の枯渇

### DoS攻撃の分類

#### 資源枯渇型

CPU/メモリ/スレッド/帯域などの資源を大量消費させる攻撃です。

代表例：

- SYN Flood(RFC 4987)
- UDP Flood
- ICMP Flood(Ping Flood)

#### 脆弱性悪用型

実装バグを悪用してプロセスをクラッシュさせます。

例：

- Ping of Death(65535バイト超の異常パケットを送り、古いOSをクラッシュさせる攻撃)
- Teardrop攻撃(IPフラグメント再構成のバグ)

### SYN Flood(RFC 4987)

TCP接続の「SYNキュー」を枯渇させる古典的攻撃です。

#### 対策

- SYN Cookie の有効化
- Firewall/Load Balancer での connection limit

## DDoS(Distributed Denial of Service)攻撃

多数の踏み台(Bot)から攻撃を行います。
近年の攻撃の主流で、Miraiボットネットなどが有名です。

### DoS と DDoS の違い

- DoS：単一の攻撃元
- DDoS：多数の攻撃元(Botnet)

### ボットネット(Botnet)

攻撃者に遠隔操作される多数のマルウェア感染端末の集合のことです。
DDoSの主要な踏み台となります。

## Smurf攻撃(増幅型DoS)

Smurf攻撃とは、**ICMP Echo(Ping)とブロードキャストアドレスを悪用した増幅攻撃**です。

参考：
https://www.cert.org/historical/advisories/CA-1998-01.cfm

### 仕組み

Smurf攻撃は次のように行われます。

1. 攻撃者が **送信元IPを被害者に偽装**した ICMP Echo Request を「ブロードキャストアドレス」宛に送信
2. 同一ネットワーク上のすべてのホストが、被害者IPに対して **ICMP Echo Reply** を返却
3. 被害者には大量の ICMP 応答が集中し、帯域やCPUが枯渇

### 図で理解する Smurf攻撃

```
攻撃者
  |
  |(送信元IPを被害者に偽装したPing)
  v
[ネットワークのブロードキャストアドレス]
  |—— 全ホストが応答 ————|
  v                                 v
Host A ———→                      (被害者IPへ集中)
Host B ———→
Host C ———→
```

1 つの送信パケットから 100台以上のホストが返信する可能性があるため、**大規模な増幅効果**が得られます。

### Smurf攻撃が成立する条件

| 条件 | 詳細 |
|------|------|
| IPスプーフィングが可能 | 送信元IPを被害者に偽装する必要がある |
| ホストがBroadcast Pingに応答する設定 | OS側のICMP設定が脆弱 |
| ルータが directed broadcast を許可 | RFC2644以前の古い設定の場合は危険 |

RFC 2644 では **directed broadcast を禁止する**ことが強く推奨されています。

### Smurf攻撃の対策(RFC 2644/CERT推奨)

#### ルータ側の対策(最重要)

```
no ip directed-broadcast
```

Ciscoルータ推奨設定です。
外部からブロードキャストアドレス宛の ICMP を遮断できます。

#### ホスト側の対策

- Broadcast Ping の応答禁止
- 不要な ICMP メッセージをファイアウォールで制限

#### ネットワーク管理側の対策

- ブロードキャスト通信の最小化
- 帯域監視による異常トラフィック検知
- IDS/IPS による ICMP 異常パターン検出

## 増幅型DDoS攻撃(Amplification DDoS Attack)

増幅型DDoS攻撃とは、**小さな要求パケットを送信するだけで、攻撃対象に大量の応答パケットを送り付けられるような仕組みやプロトコルを悪用する攻撃方式**のことです。

特徴：

- 攻撃者が反射サーバ(DNS/NTP/SSDPなど)へ小さなリクエストを送信
- 送信元IPを標的IPに偽装(IPスプーフィング)
- 反射サーバが標的へ **巨大なレスポンス** を送信
- 結果として **大量トラフィックが標的へ集中しサービス不能(DoS)**

増幅率(Amplification Factor) = **応答サイズ / リクエストサイズ**

### 代表的な増幅型DDoS攻撃

| 種類 | 説明 | 増幅倍率 |
|------|------|-----------|
| DNS Amplification | 小さなDNS問い合わせから大きな応答 | 30〜70倍 |
| NTP Amplification | monlist 悪用 | 数百倍 |
| SSDP/UPnP | IoTデバイス悪用 | 数十〜数百倍 |
| CLDAP Amplification | 攻撃強度が高く近年増加 | 最大70倍以上 |
| Memcached Amplification | 歴史上最大級の増幅 | 最大51,000倍 |

### DNS Amplification

- リクエスト：小さなDNS問い合わせ
- 応答：大きなDNS応答(特にANYクエリ)
- 増幅率：最大 50倍超

脆弱性のある公開DNSキャッシュサーバを踏み台として悪用することで行われる分散型DDoS攻撃の一種です。

#### DNS Amplification の攻撃手順

1. 攻撃者は、脆弱性のある複数の公開DNSキャッシュサーバに対して、送信元を攻撃対象としたDNSクエリをボットを介して発行する(このとき応答パケットのサイズができるだけ多くなるようにする)
2. クエリを受け取ったDNSキャッシュサーバは、クエリの送信元に設定されている攻撃対象に対して応答パケットを一斉に送信する
3. 大量の応答パケットを受け取った攻撃対象やそれが属するネットワークは過負荷状態となり正常なサービスの提供ができなくなる

#### 踏み台にならないために

利用可能なホストのIPアドレスの範囲を設定するなど、DNSキャッシュサーバが不要なクエリを拒否するようにアクセス制限を施す必要があります。

### NTP Amplification Attack(NTP増幅攻撃)

NTP(Network Time Protocol)は、ネットワーク機器/サーバの時刻同期に使われるプロトコル(UDP/123)です。
問題となるのは、NTPの古い実装に存在した **monlist コマンドによる増幅攻撃です。**

#### monlist とは

`monlist` は「NTPサーバに最近アクセスした最大600台のクライアントリストを返す」管理者向けコマンドです。

- 要求パケット：数十バイト
- 応答パケット：数百〜数千倍

これにより、攻撃者は非常に高い増幅率を得られました。

#### 攻撃の流れ(NTP Amplification)

1. 攻撃者がNTPサーバへ `monlist` リクエスト(送信元IPを標的に偽装)
2. NTPサーバが標的へ大量の応答パケット送信
3. 標的サーバはトラフィック集中でダウン

#### 対策(RFC 5905/NTP.org)

- **monlist 機能の無効化**(`disable monitor`)
- `ntpq -c "rv 0"` で monitor 状態の確認
- NTP のアップデート(Mode 6/7 の制限)
- ファイアウォールで UDP/123 のインターネット公開を禁止
- アクセス制御(`restrict` ルール)

### SSDP Amplification(UPnP)

- リクエスト：数十B
- 応答：数百B〜数KB
- 増幅率：約30倍

### 増幅型DDoS攻撃の共通対策

#### 不要サービスの停止

- NTP(monlist含む)
- DNSオープンリゾルバ
- SSDP/UPnP
- CLDAP

#### Rate Limiting/DoS防御装置

- レート制限
- IPS/クラウドWAF
- CDNによる吸収

#### 監視とインシデントレスポンス(NIST SP 800-61)

- トラフィック監視
- 異常検知
- ISPとの連携
- フォレンジックログ収集

## DRDoS(Distributed Reflection DoS：反射型DoS攻撃)

### 定義

送信元IPを標的IPに偽装し、第三者サーバ(DNS/NTPなど)の応答を大量に標的へ送らせる攻撃です。

### 危険性

- IPスプーフィングのため攻撃元特定が困難
- 少量トラフィックで大量攻撃(増幅率が高い)
- 公開サーバが踏み台化する

### DRDoS 防御(RFC 2827/BCP38)

- ISPによる送信元アドレスフィルタリング(IPスプーフィング防止)
- DNSやNTPの公開制限
- Recursive DNS 外部公開禁止
- CDN/Anycast による負荷分散
- Rate Limit による応答数制御

## マルチベクトル型DDoS攻撃(Multi-Vector DDoS Attack)

### 定義

マルチベクトル型DDoS攻撃とは、**複数の攻撃手法を同時に組み合わせて実施される大規模DDoS攻撃**の総称です。
攻撃ベクトルが複数であるため、防御側のリソースを枯渇させ、単一の防御策では対処困難になります。

### 代表的な攻撃ベクトル

- Volumetric Attack(UDP Flood、DNS Amplification)
- Protocol Attack(TCP SYN Flood、Fragmentation攻撃)
- Application Layer Attack(HTTP GET/POST Flood)

DRDoSは **マルチベクトルDDoSの一構成要素**としてよく利用されます。
例：DNS増幅＋HTTP Flood、NTP増幅＋SYN Flood など。

## IPスプーフィング(IP Spoofing)

増幅型攻撃やSmurf攻撃に欠かせない技術です。
攻撃者が送信元IPを被害者のIPに偽装します。

### 対策

- **Ingress Filtering(RFC 2827/BCP 38)**
    外部から来たパケットの送信元IPを検証し、不正なものを破棄します。
- **Egress Filtering**
    自ネットワークから出る不正な送信元IPを遮断します。

## CDN による DDoS 軽減

Cloudflare/Akamai などが提供します。
**分散トラフィック吸収サービスです。**

## NTP(Network Time Protocol)の基礎

NTP(RFC 5905)は、ネットワーク上の端末が正確な時刻に同期するためのプロトコルであり、UDP 123番ポートを使用します。
正確な時刻は、ログ管理/電子署名/証明書の有効期限管理/セキュリティ検知など、多くのシステムの基盤となります。

### NTPの階層構造(Stratum)

- **Stratum 0**：原子時計/GPSなど基準時計
- **Stratum 1**：Stratum 0 に直接接続されたサーバ
- **Stratum 2**：Stratum 1 と同期するサーバ
- 以下同様に階層化される

### NTPの主なメッセージ構造

NTPパケットには以下が含まれます。

- LI(閏秒情報)
- VN(バージョン)
- Mode(クライアント/サーバ/ブロードキャスト等)
- 送受信タイムスタンプ

### NTPとセキュリティ運用における重要性

- ログのタイムスタンプがずれると**インシデント分析が困難**になる
- PKI証明書の有効期限の検証にも正しい時刻が必須
- Kerberos 認証など、**許容時間差(Clock Skew)** により認証失敗が起こる

## DNS キャッシュポイズニング攻撃

DNS キャッシュポイズニングとは、**DNS リゾルバに偽の DNS 応答をキャッシュさせ、利用者を攻撃者の用意した IP アドレスへ誘導する攻撃**です。

攻撃に成功すると、下記などの深刻な被害に繋がります。

- 偽サイトによる認証情報窃取
- マルウェア配布
- MITM(中間者攻撃)
- VPN やメールサーバの偽装

### DNS が攻撃に弱い理由(RFC5452 が指摘)

DNS の仕様上、以下の条件が一致すれば DNS 応答は"正当"と判定されます。

- トランザクション ID(16bit = 65,536 通り)
- 送信元ポート番号
- クエリ内容(例：www.example.com A レコード)

これらは暗号化されておらず、攻撃者が大量の偽応答を送ることで、正規応答より先に偽応答が受理されてしまいます。
(**Kaminsky Attack(2008)** で世界的に問題が顕在化)

### キャッシュポイズニング攻撃の流れ(試験でよく問われる)

1. 攻撃者が標的リゾルバに対し、大量の偽 DNS 応答を送信
2. リゾルバが外部 DNS へ問い合わせを行う
3. 正規応答が返る前に、攻撃者が偽応答を送り込む
4. トランザクション ID + 送信元ポートが一致すると偽応答がキャッシュ
5. 利用者は攻撃者サイトへ誘導される

### DNS キャッシュポイズニング対策(RFC5452/IPA)

#### 送信元ポートランダム化

UDP 53 固定では簡単に予測されるため、**1024〜65535 の範囲からランダムに選択します**(Source Port Randomization)。
攻撃成功率が大幅に低下します。

#### トランザクション ID のランダム化

高品質な乱数(CSPRNG)を利用して推測困難にします。

#### キャッシュ DNS を外部公開しない(Open Resolver 対策)

再帰問い合わせを外部に許可すると攻撃対象になるため、**内部ネットワークのみに限定します**。

#### フォワーダの利用

信頼できる上位 DNS(ISP など)を利用し、リスクを軽減します。

## カミンスキー攻撃(Kaminsky Attack)

### 定義

- Dan Kaminsky により 2008 年に公表
- DNS の設計上の弱点を突いた **DNSキャッシュポイズニング攻撃の高度化手法**

**カミンスキー攻撃とは、DNSキャッシュサーバ(フルサービスリゾルバ)に偽のDNS応答を注入し、正規ドメインの名前解決結果を攻撃者の指定したIPアドレスに書き換える攻撃です。**

### DNSキャッシュの仕組み(前提知識)

- クライアントがキャッシュDNS(リゾルバ)へ問い合わせ
- キャッシュDNSは結果を一定時間保存(TTL)
- 次回以降はキャッシュを利用

**キャッシュが汚染されると、多数の利用者が被害を受けます。**

### 従来型キャッシュポイズニングの問題点

- 同一ドメインへの問い合わせはキャッシュが効く
- 攻撃チャンスは TTL が切れた瞬間のみ
- 成功確率が低い

### カミンスキー攻撃のブレークスルー

**存在しないランダムなサブドメインを大量に問い合わせさせます。**

例：

```
aaaa.example.com
bbbb.example.com
cccc.example.com
```

- 毎回キャッシュミスが発生
- 毎回権威DNSへ問い合わせが行われる
- 攻撃チャンスを無限に生成できる

### 攻撃ステップ

1. 攻撃者が被害DNSにランダムサブドメインを問い合わせさせる
2. キャッシュDNSは権威DNSへ再帰問い合わせ
3. 攻撃者が大量の**偽DNS応答**を先回り送信
4. トランザクションIDが一致すると偽応答がキャッシュされる
5. **NSレコードやAレコードが汚染される**

### なぜ致命的か

- 偽の **NSレコード** を注入可能
- ドメイン全体の名前解決を支配できる
- フィッシング、MITM、マルウェア配布に直結

### 攻撃成功の本質的要因

| 要因 | 説明 |
|---|---|
| トランザクションIDが16bit | 総当たり可能 |
| UDP通信 | 応答の正当性検証なし |
| キャッシュ機構 | 影響範囲が大きい |
| DNSSEC未導入 | 暗号検証不可 |

### カミンスキー攻撃の対策

#### 送信元ポートランダム化(RFC 5452)

- 従来：UDP 53 固定
- 対策後：エフェメラルポート使用

攻撃成功確率を大幅に低下させます。

#### トランザクションIDの乱数強化

推測困難な乱数を使用します。

#### DNSSEC

- DNS応答に電子署名
- 正当性を暗号学的に検証

**カミンスキー攻撃を本質的に防止します。**

### カミンスキー攻撃とDNSアンプ攻撃の違い

| 攻撃 | 目的 |
|---|---|
| カミンスキー攻撃 | キャッシュ汚染 |
| DNSアンプ攻撃 | DDoS(帯域枯渇) |

**目的が全く異なります。**

## DNSSEC(DNS Security Extensions)

### 定義(RFC 4033/4034/4035)

**DNSSEC(Domain Name System Security Extensions)** とは、DNS 応答に **電子署名(公開鍵暗号)を導入し、応答の真正性および完全性を検証可能にする拡張仕様**のことです。

### DNSSECが提供するセキュリティ特性

| セキュリティ要素 | 提供可否 |
|---|---|
| 応答の真正性 | ○ |
| 応答の完全性 | ○ |
| なりすまし防止 | ○ |
| 通信内容の暗号化 | × |
| 可用性 | × |

**DNSSEC は暗号化技術ではありません。**

### DNSSECが必要となった背景

従来の DNS は以下を検証できません。

- 応答が正規の権威DNSサーバから送られたか
- 応答内容が改ざんされていないか

DNSキャッシュポイズニングやカミンスキー攻撃は **応答の正当性を検証できない設計**に起因します。
DNSSEC は **この根本問題を解決するための仕組み**です。

### 鍵の種類

| 鍵 | 役割 |
|---|---|
| ZSK(Zone Signing Key) | ゾーン内の各レコードを署名 |
| KSK(Key Signing Key) | ZSK の正当性を署名 |

### DNSSEC関連レコード

| レコード | 役割 |
|---|---|
| DNSKEY | 公開鍵を格納 |
| RRSIG | レコード集合に対する署名 |
| DS | 親ゾーンから子ゾーンへの信頼情報 |
| NSEC/NSEC3 | レコード非存在証明 |

### 信頼の連鎖(Chain of Trust)【最重要】

DNSSEC の核心は **階層構造による信頼連鎖**です。

```
ルートゾーン(.)
↓ DS
TLD(.jp)
↓ DS
example.jp
```

- 親ゾーンは **子ゾーンの KSK のハッシュ値(DS)を保持**
- 上位ゾーンが下位ゾーンの正当性を保証
- **1か所でも検証に失敗すると応答は破棄される**

### DNSSECの検証プロセス(午後頻出)

1. リゾルバが DNS 応答を受信
2. RRSIG を DNSKEY で検証
3. DNSKEY を DS レコードで検証
4. 親ゾーンへ遡って検証
5. ルートまで信頼が連鎖すれば成功

### 「存在しないこと」の証明(NSEC/NSEC3)

#### なぜ必要か

攻撃者が **NXDOMAIN 応答を偽装**することを防ぐためです。

#### NSEC

- 次に存在する名前を示す
- ゾーンウォーキング可能(弱点)

#### NSEC3

- ハッシュ化によりゾーンウォーキングを困難化
- 現在の主流方式

### DNSSECの限界(試験で問われやすい)

| 項目 | DNSSEC |
|---|---|
| キャッシュポイズニング対策 | ○ |
| なりすまし防止 | ○ |
| 通信盗聴対策 | × |
| 通信内容秘匿 | × |

通信の暗号化は **DoH/DoT** が担当します。

### DNSSECと関連技術の比較

| 技術 | 目的 |
|---|---|
| DNSSEC | 応答の真正性/完全性 |
| DoH | DNS通信の暗号化 |
| DoT | DNS通信の暗号化 |
| TSIG | DNSサーバ間認証 |
| SPF/DKIM/DMARC | メール送信ドメイン認証 |

## DNS水責め攻撃(DNS Water Torture/ランダムサブドメイン攻撃)

### 定義

**DNS水責め攻撃(DNS Water Torture Attack)** とは、キャッシュDNSサーバに対して **存在しないランダムなサブドメイン名** を大量に問い合わせさせることで、結果的に **権威DNSサーバへ過剰な問い合わせを集中させ、サービス不能(DoS)状態に陥らせる攻撃** です。

別名：

- ランダムサブドメイン攻撃
- DNS Query Flood(亜種)

### 攻撃の流れ

1. 攻撃者が多数の端末(Bot)を用意
2. 各端末がキャッシュDNSサーバに対し、以下のような問い合わせを大量送信

```
a1x9k.example.com
b7q3m.example.com
z92ld.example.com
```

3. これらは **毎回ランダム生成されるためキャッシュに存在しない**
4. キャッシュDNSは「未キャッシュ」と判断し、**権威DNSサーバへ問い合わせを転送**
5. 権威DNSサーバが大量クエリを処理できず、応答遅延や停止が発生

### 技術的ポイント

- キャッシュDNSは **キャッシュヒット率が極端に低下**
- キャッシュが効かないため、**問い合わせが必ず権威DNSへ到達**
- 通常のDNSキャッシュ最適化が機能しない

### 直接の目的

**権威DNSサーバに過剰な負荷を与え、正規利用者の名前解決を妨害すること**です。

### 間接的な狙い

- Webサイト、メール、API 等の **基盤インフラを機能停止させる**
- 企業/組織の **可用性(Availability)を破壊する**
- DDoS攻撃の一形態として、**検知/遮断を困難にする**

### なぜ「キャッシュDNS」が踏み台になるのか

DNSの基本仕様(RFC 1034/1035)では、キャッシュDNSは下記について必ず権威DNSへ問い合わせを行います。

- **一度も問い合わせたことのない名前**
- **存在しない名前(NXDOMAIN含む)**

攻撃者はこの **正当な仕様** を悪用します。

### DNS水責め攻撃の特徴整理

| 観点 | 内容 |
|---|---|
| 攻撃対象 | 権威DNSサーバ |
| 踏み台 | キャッシュDNSサーバ |
| 手法 | ランダムなサブドメイン名を大量生成 |
| キャッシュ | 効かない(毎回未キャッシュ) |
| 目的 | 可用性低下/DoS |
| 種別 | DDoS攻撃(間接型) |

### DNS水責め vs DNSアンプ攻撃

| 項目 | DNS水責め | DNSアンプ |
|---|---|---|
| 主目的 | 権威DNS過負荷 | 帯域枯渇 |
| 悪用点 | キャッシュ不成立 | 応答サイズ増幅 |
| 送信元IP偽装 | 不要 | 必要 |
| 反射 | しない | する |

### DNS水責め攻撃の対策

#### 権威DNS側の対策

- **Response Rate Limiting(RRL)**
- 存在しない名前への **応答制限**
- Anycast 配置による負荷分散

#### キャッシュDNS側の対策

- 異常なランダムクエリの検知
- 問い合わせレート制限
- 不正クライアントの遮断

#### 運用/設計面

- 権威DNSの **冗長化**
- CDN/DNSプロバイダの活用
- 監視(NXDOMAIN率の急増検知)

### DNSSECとの関係

**DNSSECは水責め攻撃を防げません。**
改ざん防止と可用性対策は別問題です。

### NXDOMAIN

- 存在しないドメイン名への応答コード
- 水責め攻撃では NXDOMAIN が大量発生する

### Anycast DNS

- 同一IPを複数拠点に配置
- 攻撃トラフィックを地理的に分散可能

## 再帰的問合せ(Recursive Query)と反復問合せ(Iterative Query)

DNS の問合せ方式は以下の 2 種類です。

### 再帰的問合せ(Recursive Query)

クライアントが DNS サーバに **「最終回答を返してほしい」** と依頼する方式です。

DNS サーバは下記へ問い合わせ、回答をクライアントに返します。

1. ルート DNS
2. TLD DNS
3. 権威 DNS

### 反復問合せ(Iterative Query)

「分かる範囲だけ返してよい」という方式です。
権威 DNS は通常反復問い合わせのみ対応します。

例：

- ルートDNS：TLD の場所だけ知らせる
- TLD DNS：権威 DNS の場所だけ知らせる

### 両者の比較

| 項目 | 再帰的問合せ | 反復問合せ |
|------|--------------|------------|
| 調査の主体 | DNS リゾルバ | クライアント |
| クエリ数 | クライアントは 1 回 | クライアントが複数回 |
| 攻撃対象 | ◎(キャッシュ汚染) | × |
| 主な利用場面 | 利用者 PC → DNS | DNS サーバ間通信 |

## 周辺知識(DNS セキュリティ)

### DNS over TLS(DoT)/DNS over HTTPS(DoH)

DNS クエリ暗号化技術です。
**キャッシュポイズニング対策ではなく、盗聴対策です。**

### ゾーン転送(AXFR)

設定ミスにより**内部ネットワーク情報が漏洩**するため、IP制限や TSIG による認証が必須です。

### NTPリフレクション攻撃とSYN Floodの違い

| 攻撃名 | 特徴 |
|--------|------|
| SYN Flood | TCP 3way を悪用、反射しない |
| Reflection Attack | UDPで反射/増幅あり |
