# デジタルコンテンツの著作権保護技術（DTCP/DTCP-IP/DTLA）

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年秋の情報処理安全確保支援士に向けて勉強中です。
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/a25279a17b210d6ed9f4)」をご参照ください。
**本記事は学習した内容を記載しています。**

## 該当問題

[情報セキュリティスペシャリスト平成26年秋期 午前Ⅱ 問23](https://www.sc-siken.com/kakomon/26_aki/am2_23.html)

## DTCP(Digital Transmission Content Protection)とは

### 定義(DTLA公式仕様)

DTCP とは、**デジタル機器間で伝送される著作権保護コンテンツを不正コピーから守るための保護技術**です。
主に以下を目的とします。

- デジタル放送/録画コンテンツの **不正複製防止**
- 正規機器間のみでの再生許可

### 保護対象

- デジタル放送(地デジ/BS/CS)
- 録画コンテンツ(HDDレコーダ等)
- 映像/音声ストリーム

## DTCP-IP(DTCP over IP)

### 定義

DTCP-IP とは、**IPネットワーク上で DTCP を適用するための拡張仕様**です。
つまり、下記の関係となります。

- DTCP：概念/保護方式
- **DTCP-IP：IPネットワーク(Ethernet/TCP-IP)向け実装**

### 利用シーン(試験で重要)

- 家庭内LANでの録画機 ⇔ テレビ ⇔ レコーダ
- DLNA機器間でのストリーミング再生

→ **インターネット全体ではなく「家庭内など限定されたIPネットワーク」** が前提です。

## DTCP-IP の技術的仕組み

### 基本構成

| 要素 | 内容 |
|---|---|
| 機器認証 | 正規ライセンス機器のみ接続可能 |
| 鍵交換 | セッション鍵を安全に共有 |
| 暗号化 | AES 等によるストリーム暗号化 |
| コピー制御 | Copy Never/Copy Once 等 |

### コピー制御情報(CCI)

放送やコンテンツには以下の属性が付与されます。

- Copy Free
- Copy Once
- Copy Never

DTCP-IP はこの制御情報を **機器間で保持/強制** します。

## DTLA(Digital Transmission Licensing Administrator)

### 定義

DTLA とは、**DTCP 技術のライセンス管理および仕様策定を行う団体**です。

### 役割

- DTCP/DTCP-IP 仕様の策定
- メーカーへのライセンス付与
- 暗号鍵/証明書管理

→ **DTLA は技術そのものではなく「管理主体」** です。

## DTCP/DTCP-IP/DTLA の関係整理(試験対策)

| 用語 | 役割 |
|---|---|
| DTCP | デジタルコンテンツ保護方式 |
| DTCP-IP | IPネットワーク向け DTCP 実装 |
| DTLA | ライセンス管理団体 |

## なぜ DTCP-IP が必要なのか(背景)

### デジタル化の課題

- デジタルデータは劣化なくコピー可能
- 家庭内LANでも簡単に複製できてしまう

### 解決策

- **暗号化 + 正規機器認証**
- 利用範囲を「家庭内/私的利用」に限定

→ 著作権者と利用者のバランスを取る技術です。

## 関連する著作権保護技術

### CSS(Content Scramble System)

- **DVD-Video** 向けの暗号化方式
- 40ビット鍵による暗号化のため、**既に解読されており安全性は低い**
- DeCSS(CSS解除ツール)の登場により事実上の保護能力を喪失
- 現在は後継の AACS に移行

### AACS(Advanced Access Content System)

- **Blu-ray Disc** 向けのコンテンツ保護方式
- CSS の脆弱性を踏まえ、より強固な暗号化(AES-128)を採用
- **特徴的な仕組み**：
  - **メディア鍵ブロック(MKB)**：不正機器のライセンスを無効化(リボケーション)可能
  - **BD+**：Blu-ray独自の追加保護レイヤー(動的な保護コード実行)
  - **デバイス鍵の階層構造**：個別機器の鍵が漏洩しても、他の機器への影響を限定

### HDCP(High-bandwidth Digital Content Protection)

- HDMI/DVI/DisplayPort など **映像インタフェース(デジタル接続)** 向け
- ディスプレイ接続時の不正コピー防止
- **送信側(プレーヤー)と受信側(ディスプレイ)の相互認証**を行い、暗号化された映像信号を伝送
- HDCP 2.x：ネットワーク経由のコンテンツ伝送にも対応

### CPRM(Content Protection for Recordable Media)

- **DVD-R/SDカード等の記録型メディア** 向け
- 記録媒体単位でのコピー制御
- メディア固有の **メディアID** と暗号鍵を組み合わせ、他のメディアへのコピーを防止
- 地上デジタル放送の「ダビング10」と組み合わせて利用される

### DRM(Digital Rights Management)

- 権利管理技術の総称
- DTCP は DRM の一種

#### DRM の仕組み

DRM は以下の要素で構成されます。

| 構成要素 | 役割 |
|---|---|
| コンテンツ暗号化 | コンテンツを暗号化し、不正アクセスを防止 |
| ライセンスサーバ | 利用権(ライセンス)の発行・管理を行う |
| 権利情報(Rights Object) | 再生回数、利用期間、コピー可否などの利用条件を定義 |
| クライアント認証 | 正規デバイス/アプリのみにコンテンツ復号を許可 |

#### DRM の動作フロー

```
1. コンテンツプロバイダがコンテンツを暗号化
2. ユーザがコンテンツを購入/ダウンロード
3. クライアントがライセンスサーバに認証要求
4. ライセンスサーバが権利情報(利用条件)と復号鍵を発行
5. クライアントが復号鍵でコンテンツを復号・再生
```

#### 代表的な DRM 技術

| DRM 技術 | 提供元 | 対象プラットフォーム |
|---|---|---|
| FairPlay | Apple | iTunes, Apple Music, Apple TV+ |
| Widevine | Google | Android, Chrome, YouTube |
| PlayReady | Microsoft | Windows, Xbox, Silverlight |

#### DRM の課題と限界

- **アナログホール(Analog Hole)**：復号後のアナログ出力をキャプチャされると保護不可
- **正規ユーザの利便性低下**：デバイス変更時の再認証、オフライン視聴制限等
- **DRM 解除ツールの存在**：技術的に完全な保護は困難

## 電子透かし(デジタルウォーターマーク)

### 定義

電子透かしとは、**画像・音声・映像などのデジタルコンテンツに、人間には知覚できない情報を埋め込む技術**です。
著作権保護やコンテンツの追跡に利用されます。

### 電子透かしの分類

#### 可視性による分類

| 分類 | 説明 | 用途 |
|---|---|---|
| **可視透かし(Visible Watermark)** | 人間が目視で確認できる透かし | 著作権表示、ロゴの重畳 |
| **不可視透かし(Invisible Watermark)** | 人間が知覚できない透かし | 著作権の証明、不正コピー追跡 |

> 試験で問われるのは主に **不可視透かし** です。

#### 耐性による分類(試験頻出)

| 分類 | 説明 | 用途 |
|---|---|---|
| **ロバスト透かし(Robust Watermark)** | 圧縮・トリミング・フォーマット変換等の加工に耐える | **著作権の証明、不正コピー追跡** |
| **フラジャイル透かし(Fragile Watermark)** | わずかな改変でも透かしが壊れる | **改ざん検知** |
| **セミフラジャイル透かし** | 軽微な加工には耐え、意図的な改変で壊れる | 改ざん検知と実用性の両立 |

### 電子透かしの目的

1. **著作権の主張・証明**：誰がコンテンツの権利者かを証明する
2. **不正コピーの追跡**：流出元の特定(フィンガープリンティングと組み合わせ)
3. **改ざん検知**：コンテンツが改変されていないことの確認(フラジャイル透かし)
4. **利用状況の追跡**：放送モニタリング等

### 電子透かしに求められる性質

| 性質 | 説明 |
|---|---|
| 非知覚性 | 人間が知覚できないこと(品質劣化が少ない) |
| 堅牢性(ロバスト性) | 圧縮・加工等に耐えること |
| 安全性 | 第三者が透かしを除去・改変できないこと |
| 容量 | 十分な情報量を埋め込めること |

### 電子透かし vs 電子署名

| 比較項目 | 電子透かし | 電子署名 |
|---|---|---|
| 埋め込み先 | コンテンツ本体に埋め込む | コンテンツとは別データ(署名値) |
| 改ざん検知 | フラジャイル透かしで可能 | ハッシュ値の検証で検知 |
| 著作権証明 | 可能(コンテンツに直接紐づく) | 署名者の証明が主目的 |
| コピー追跡 | 可能(コピー後も透かしが残る) | 不可(署名はコピーに付随しない場合がある) |

## ステガノグラフィ(Steganography)

### 定義

ステガノグラフィとは、**データの中に秘密の情報を隠蔽する技術**です。
暗号化がデータの「内容」を保護するのに対し、ステガノグラフィは **情報の「存在」そのものを隠す** ことを目的とします。

### 暗号化との違い(試験頻出)

| 比較項目 | 暗号化(Encryption) | ステガノグラフィ(Steganography) |
|---|---|---|
| 目的 | 情報の **内容** を保護 | 情報の **存在** を隠す |
| 通信の外観 | 暗号文であることが明白 | 通常のデータに見える |
| 検知 | 暗号化されていることは検知可能 | 情報が隠されていること自体を検知困難 |
| 解読 | 鍵なしでは解読不可 | 存在に気づかなければ解読の試み自体がない |

> 試験では **「暗号化は内容の秘匿、ステガノグラフィは存在の秘匿」** という対比が問われます。

### 代表的な手法

| 手法 | 説明 |
|---|---|
| **画像の最下位ビット(LSB)置換** | ピクセルの最下位ビットを秘密データに置き換える(画質への影響は極小) |
| **音声ファイルへの埋め込み** | 可聴域外や微小な音声変化に情報を埋め込む |
| **テキストへの埋め込み** | 空白文字・見えない文字・書式を利用して情報を隠す |
| **ネットワークステガノグラフィ** | プロトコルのヘッダやタイミングに情報を埋め込む |

### 電子透かしとの関係

| 比較項目 | 電子透かし | ステガノグラフィ |
|---|---|---|
| 主な目的 | 著作権保護、改ざん検知 | 秘密通信、情報隠蔽 |
| 隠す情報 | 著作権情報、識別子 | 任意の秘密データ |
| 堅牢性の重要度 | 高い(加工後も残る必要がある) | 低い(伝達できればよい) |
| カバーデータとの関係 | カバーデータ(コンテンツ)自体に価値がある | カバーデータは情報を隠す手段 |

### セキュリティ上の脅威としてのステガノグラフィ

ステガノグラフィは攻撃者にも悪用されます。

- **マルウェアの C&C 通信の隠蔽**：画像ファイルに指令を埋め込み、通常のWeb通信に偽装
- **情報窃取(Data Exfiltration)**：機密データを画像等に埋め込んで持ち出す
- **検知回避**：DLP(Data Loss Prevention)やIDS/IPSの検知を回避

## フィンガープリンティング(Digital Fingerprinting)

### 定義

フィンガープリンティングとは、**コンテンツの配布先(購入者)ごとに異なる識別情報を埋め込む技術**です。
不正コピーが流出した際に、**どの購入者から流出したかを特定**できます。

### 電子透かしとの違い

| 比較項目 | 電子透かし(ウォーターマーク) | フィンガープリンティング |
|---|---|---|
| 埋め込む情報 | **全コピーに同じ情報**(著作権者情報等) | **配布先ごとに異なる情報**(購入者ID等) |
| 主な目的 | 著作権の証明 | **流出元の特定** |
| 例 | 「(c)A社」を全コピーに埋め込む | 購入者Aには「001」、購入者Bには「002」を埋め込む |

> 試験では **「フィンガープリンティング = 購入者ごとに異なる情報を埋め込み、流出元を特定」** がポイントです。

### 結託攻撃(Collusion Attack)

フィンガープリンティングに対する攻撃手法です。

- **手法**：複数の購入者が各自のコピーを比較し、異なる部分(=フィンガープリント)を特定して除去・改変する
- **対策**：**結託耐性符号(c-secure code)**の利用。符号理論に基づき、一定人数の結託では除去できない符号を設計する

## CAS(Conditional Access System：限定受信システム)

### 定義

CAS とは、**放送コンテンツの視聴を許可された受信者のみに限定するためのシステム**です。
有料放送やデジタル放送の視聴制御に使用されます。

### B-CAS(BS-Conditional Access Systems)

日本のデジタル放送で採用されている CAS の実装です。

| 項目 | 内容 |
|---|---|
| カード | B-CAS カード(ICカード) |
| 役割 | スクランブル解除に必要な復号鍵を格納 |
| 対象 | 地デジ/BS/CS デジタル放送 |
| 暗号方式 | MULTI2 暗号(放送波のスクランブル) |

#### B-CAS の動作の仕組み

```
1. 放送局がコンテンツをスクランブル(MULTI2暗号化)して送信
2. スクランブル鍵(Ks)を ECM(Entitlement Control Message)で暗号化して送信
3. 契約情報を EMM(Entitlement Management Message)で送信
4. B-CASカードが ECM を復号してスクランブル鍵(Ks)を取得
5. スクランブル鍵でコンテンツを復号・視聴
```

#### 関連用語

| 用語 | 説明 |
|---|---|
| **ECM(Entitlement Control Message)** | スクランブル鍵を含む制御メッセージ(番組単位) |
| **EMM(Entitlement Management Message)** | 契約情報・個別鍵を含む管理メッセージ(受信機単位) |
| **スクランブル鍵(Ks)** | コンテンツの暗号化/復号に使用する鍵 |
| **ワーク鍵(Kw)** | ECM の暗号化/復号に使用する鍵 |
| **マスター鍵(Km)** | B-CAS カード内に格納される最上位鍵 |

### CAS とコピー制御の関係

| 技術 | 役割 |
|---|---|
| CAS(B-CAS) | **視聴制御**(誰が見られるか) |
| DTCP-IP | **コピー制御**(録画後の複製制限) |
| CPRM | **記録メディアのコピー制御** |

> CAS は「視聴の可否」、DTCP-IP/CPRM は「コピーの制御」と役割が異なります。

## 技術的保護手段と法的位置づけ

### 技術的保護手段の分類

| 分類 | 説明 | 具体例 |
|---|---|---|
| **アクセスコントロール** | コンテンツへのアクセス自体を制限 | CAS、DRM のライセンス認証 |
| **コピーコントロール** | コンテンツのコピー・複製を制限 | CSS、CPRM、DTCP-IP、HDCP |

### 関連法規(試験頻出)

#### 著作権法

- **技術的保護手段の回避の禁止**(著作権法第30条第1項第2号)
  - コピーコントロールを回避してコピーすることは **私的使用目的であっても違法**
  - 回避装置・プログラムの提供は **刑事罰の対象**(著作権法第120条の2)

#### 不正競争防止法

- **技術的制限手段に対する不正行為の禁止**(不正競争防止法第2条第17項・第18項)
  - アクセスコントロール/コピーコントロールを回避する機器・プログラムの提供を禁止
  - **「のみ」要件**：回避を「のみ」目的とする装置(汎用ツールは対象外)

#### 著作権法と不正競争防止法の違い(試験重要)

| 比較項目 | 著作権法 | 不正競争防止法 |
|---|---|---|
| 規制対象 | コピーコントロールの回避行為 | アクセスコントロール/コピーコントロール回避装置の **提供** |
| 回避行為自体 | 私的使用でも違法 | 直接規制なし(提供行為を規制) |
| 保護対象 | 著作物 | 営業上の利益 |

### ダビング10

日本のデジタル放送における録画ルールです。

| 項目 | 内容 |
|---|---|
| 概要 | 録画したコンテンツを **9回コピー + 1回ムーブ** できる |
| 前身 | コピーワンス(1回のみ録画可能) |
| 技術的実現 | DTCP-IP + CPRM による CCI 制御 |
| 適用対象 | 地上デジタル放送(一部BS/CS) |

## コンテンツ保護技術の全体整理

### 保護対象別の技術整理

| 保護対象 | 技術 | 方式の概要 |
|---|---|---|
| **デジタル放送** | CAS(B-CAS) | スクランブル放送の視聴制限 |
| **デジタル放送(録画後)** | DTCP-IP | IP ネットワーク上のコピー制御 |
| **DVD-Video** | CSS | 40ビット鍵によるスクランブル(脆弱) |
| **DVD-R / SDカード** | CPRM | メディアID と暗号鍵によるコピー制御 |
| **Blu-ray Disc** | AACS | AES-128 + MKB によるコンテンツ保護 |
| **映像インタフェース** | HDCP | HDMI/DVI 等のデジタル伝送路の暗号化 |
| **オンラインコンテンツ** | DRM | ライセンスサーバによる利用権管理 |

### 情報埋め込み技術の整理

| 技術 | 目的 | 埋め込む情報 | 堅牢性 |
|---|---|---|---|
| **電子透かし(ロバスト)** | 著作権証明 | 著作権者情報(全コピー共通) | 高い |
| **電子透かし(フラジャイル)** | 改ざん検知 | 完全性検証用データ | 低い(改変で壊れる) |
| **フィンガープリンティング** | 流出元特定 | 購入者固有の識別子 | 高い |
| **ステガノグラフィ** | 秘密通信 | 任意の秘密データ | 問わない |

### コンテンツ保護の3つのアプローチ(MECE整理)

| アプローチ | 説明 | 技術例 |
|---|---|---|
| **1. アクセス制御** | コンテンツの視聴・利用自体を制限 | CAS, DRM(ライセンス認証) |
| **2. コピー制御** | コンテンツの複製・転送を制限 | CSS, AACS, CPRM, DTCP-IP, HDCP |
| **3. 追跡・検知** | 不正利用の事後追跡・改ざん検知 | 電子透かし, フィンガープリンティング |
