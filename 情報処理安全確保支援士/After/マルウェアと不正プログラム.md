# マルウェアと不正プログラム ― ウイルス分類/ダウンローダ/Mirai/検知技術/Rootkit/クリプトジャッキングの体系的整理

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年秋の情報処理安全確保支援士に向けて勉強中です。
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。
**本記事は学習した内容を記載しています。**

## 該当問題

[情報セキュリティスペシャリスト平成24年秋期 午前Ⅱ 問7](https://www.sc-siken.com/kakomon/24_aki/am2_7.html)
[情報セキュリティスペシャリスト平成25年春期 午前Ⅱ 問3](https://www.sc-siken.com/kakomon/25_haru/am2_3.html)
[情報セキュリティスペシャリスト平成27年春期 午前Ⅱ 問12](https://www.sc-siken.com/kakomon/27_haru/am2_12.html)
[情報セキュリティスペシャリスト平成27年秋期 午前Ⅱ 問16](https://www.sc-siken.com/kakomon/27_aki/am2_16.html)
[情報処理安全確保支援士平成30年秋期 午前Ⅱ 問11](https://www.sc-siken.com/kakomon/30_aki/am2_11.html)
[情報処理安全確保支援士平成31年春期 午前Ⅱ 問5](https://www.sc-siken.com/kakomon/31_haru/am2_5.html)

## コンピュータウイルスの分類

### ポリモーフィック型ウイルス(Polymorphic Virus)

#### 定義

ポリモーフィック型ウイルスとは、**自己複製時に暗号化やコード変形を行い、毎回異なる形に変化するウイルス**です。
ウイルス本体は暗号化され、復号ルーチンも変形するため、シグネチャ型検知の回避を目的とします。

根拠：

- 1990年代以降、暗号化技術を利用したウイルスが登場し "polymorphic engine" として研究対象
- Symantec セキュリティレポートでも「検知回避技術の代表例」として分類

#### 特徴

- 暗号化された本体 + 変形する復号ルーチン
- シグネチャベースの検知(特定バイト列の検知)を無効化
- エンジン部分のみを改良し、多数の亜種を生成可能
- 検知には**エミュレーション**や**静的解析＋ふるまい分析**が必要

#### ポリモーフィックウイルスの代表例

- **Cascade**(1987)暗号化型ウイルスの初期例
- **Storm Worm(2007)** ポリモーフィック生成により亜種数百万以上
- 現代のマルウェア(Emotet など)も類似技術を利用

### ステルス型ウイルス(Stealth Virus)

#### 定義

ステルス型ウイルスとは、**感染の痕跡を隠蔽し、OS/アンチウイルス/ユーザから検知されにくくするウイルス**です。

#### 代表的なステルス手法

| 手法 | 内容 |
|------|-------|
| **ファイルサイズ偽装** | 感染時に元ファイルサイズを報告し、改変を隠す |
| **ディスク読込介入** | OSの I/O 要求を改ざんし、感染領域を非感染に見せる |
| **メモリ常駐型** | AV ソフトより先にロードし、検出処理を妨害 |
| **ルートキット化** | プロセス一覧/TCP接続/ファイルを隠す |

#### ステルスウイルスの例

- **Frodo 4096**(MS-DOSステルスウイルスの代表格)
- **TDL4**(高度なrootkit機能による隠蔽)

### マルチプラットホーム型ウイルス(Multi-platform/Cross-platform Virus)

#### 定義

マルチプラットホーム型ウイルスとは、**複数のOS(Windows/Linux/macOS 等)で動作するウイルス**です。

#### 特徴

- プログラム言語や共通実行環境(Java VM/Python/.NET/Flash/ブラウザ)を利用
- OS に依存しない攻撃が可能
- 標的範囲が広く、攻撃の成功率が高い
- Webベース(HTML5/JavaScript)でのマルウェアも増加

#### マルチプラットホームウイルスの例

- **Java.ByteVerify**(Java VMを悪用)
- **CrossRat**(Windows/Linux/macOS対応)
- **Script型マルウェア(JS/HTML5系)**

### メタモーフィック型ウイルス(Metamorphic Virus)

ポリモーフィックよりさらに高度な変形型です。
**復号ルーチンを持たず、ウイルス本体が毎回完全に別コードへ自動書き換え**されます。

### マクロウイルス(Macro Virus)

Excel/Word などの VBA を悪用したウイルスです。
OS に依存しないためマルチプラットホーム型の性質を持ちます。

## マルウェアの種類(全体分類)

| 種類 | 説明 |
|------|------|
| トロイの木馬 | 正規ソフトを装う不正プログラム。自律的に増殖しない |
| ワーム | 自己増殖して拡散 |
| バックドア | 遠隔操作用の裏口を作成 |
| ボット | C2から命令を受ける端末 |
| キーロガー | キー入力を盗む |
| ランサムウェア | ファイルを暗号化し金銭要求。WannaCry 等が有名 |
| ダウンローダ | **他のマルウェアを落とす役割** |
| ドロッパー | 本体を自分の内部に含んでいる |

### ダウンローダとドロッパーの違い

| 種類 | 特徴 |
|------|------|
| ダウンローダ | 感染後に本体を外部から取得 |
| ドロッパー | 本体を内部に抱えており即展開 |

## ダウンローダ型マルウェア(Downloader Malware)

### 定義

ダウンローダ型マルウェア(Downloader)とは、**自身は本体の一部機能しか持たず、感染後に外部サーバから追加のマルウェア(本体)をダウンロードして実行するマルウェアを指します。**
IPA では「二次感染を引き起こすマルウェア」として分類されています。

代表的な攻撃目的：

- 追加のバックドアや遠隔操作ツール(RAT)をインストールする
- ランサムウェアのダウンロード
- クレデンシャル窃取ツール(情報窃取型マルウェア)の展開
- ボットネットへの組み込み

### ダウンローダ型マルウェアの主な特徴

#### サイズが小さい

ダウンローダは本体ではなく「落としてくるだけ」のため非常に小型です。

#### ネットワーク経由で本体を取得

攻撃者のC2(Command & Control)サーバに接続し本体を取得します。

#### 感染端末を継続的に悪用できる

追加マルウェアの更新や追加感染が可能です。

#### 攻撃者が証跡を隠蔽しやすい

マルウェア本体は都度ダウンロードされるため、ファイルの痕跡が少ないです。

### ダウンローダ型マルウェアの侵入経路

#### メール添付(Emotet など)

Officeマクロ、ZIP添付、暗号化ZIPなどです。

#### Web 経由(ドライブバイダウンロード)

脆弱性を悪用しユーザ操作なしで感染します。

#### 正規ソフトを装う偽インストーラ

ユーザが自らダウンロードしてしまうパターンもあります。

#### USB などのリムーバブルメディア

### ダウンローダ型マルウェアの行動

| 攻撃段階 | Downloader の行動 | MITRE Technique |
|----------|------------------|-----------------|
| 初期感染 | 添付ファイル/脆弱性で侵入 | T1566, T1204 |
| 外部通信 | C2サーバへ接続 | T1071 |
| ダウンロード | 本体マルウェアを取得 | **T1105** |
| 実行 | 本体マルウェアを起動 | T1059 |
| 永続化 | レジストリ改ざんなど | T1547 |

### ダウンローダが落とす代表的なマルウェア

#### バックドア(RAT)

- 遠隔操作、ファイル窃取
- キーロギング
- 端末の完全制御

#### ランサムウェア

- データ暗号化
- 金銭要求

#### 情報窃取型(Credential Stealer)

- パスワード
- ブラウザデータ
- Cookie やセッション情報

#### ボット化(Bot/Botnet)

- 大量送信(スパム)
- DDoS 攻撃の踏み台化

### ダウンローダ対策(IPA「安全なパソコン利用」)

#### 入り口対策

- 添付ファイルのマクロ無効化
- URL フィルタリング
- メールゲートウェイでのマルウェア検知

#### 実行防止(EDR/AMソフト)

- 挙動監視(スクリプト/不審プロセス)
- EDR による通信先監視

#### 出口対策

- 不正通信のブロック(C2 への通信遮断)
- DNS フィルタリング
- プロキシログの監視

#### 多層防御(Defense in Depth)

- パッチ管理
- 権限最小化(ローカル管理者禁止)
- 不審通信の SIEM 監視

## マルウェア「Mirai」

### 定義

**Mirai は、IoT 機器を感染させてボットネットを構成し、大規模な DDoS 攻撃を実行するマルウェア**です。

- IPA(情報処理推進機構)
- JPCERT/CC
- 複数のセキュリティベンダ分析レポート

### 発見と社会的影響

- **2016年に大規模被害を引き起こし注目**
- DNS サービス事業者(Dyn)への攻撃で、Twitter/GitHub/Netflix などが一時利用不能に

**「IoT x DDoS」時代の象徴的マルウェアです。**

### IoT 機器を標的とする

Mirai が狙う代表例：

- ネットワークカメラ
- ルータ
- デジタルビデオレコーダ(DVR)

共通点：

- 常時インターネット接続
- OS が Linux 系
- 管理者設定が不十分

### デフォルト認証情報の悪用

Mirai の最大の特徴は下記です。

- **初期設定の ID/パスワードを総当たり**
  - admin/admin
  - root/12345
  - root/password など

**脆弱性ではなく「設定不備」を突く**点が重要です。

### 自己拡散型マルウェア

Mirai は感染後、下記のような動作をします。

1. インターネット上をスキャン
2. 他の IoT 機器を探索
3. 同様の方法で感染を拡大

**ワーム型の性質**を持ちます。

### Mirai の動作構造

#### 全体構成

Mirai は以下の要素で構成されます。

```
攻撃者
↓
C&Cサーバ
↓
Mirai感染IoT(ボット)
↓
DDoS攻撃対象
```

#### 感染から攻撃までの流れ

1. IoT 機器に侵入(Telnet/SSH)
2. Mirai 本体をダウンロード
3. C&C サーバに接続
4. 攻撃命令を待機
5. 指示に従い DDoS 攻撃を実行

### Mirai の最終目的：DDoS 攻撃

#### 実行される攻撃手法

Mirai が実行可能な攻撃例：

- TCP SYN Flood
- UDP Flood
- HTTP Flood
- GRE Flood

**単体は弱くても、数十万台規模で威力を発揮します。**

#### なぜ IoT が DDoS に向くのか

| 理由 | 説明 |
|---|---|
| 常時稼働 | 電源が切られにくい |
| 管理不十分 | パスワード未変更 |
| 世界中に分散 | トラフィック遮断が困難 |
| 台数が多い | 攻撃規模が巨大 |

### Mirai の派生と進化

Mirai のソースコードは **公開**されました。

その結果：

- 多数の亜種(派生マルウェア)が登場
- 新たな IoT マルウェアの基盤に

代表的派生：

- Okiru
- Satori
- Mozi

**Mirai は単発ではなく「系譜」を持ちます。**

### Mirai 対策(試験でも問われる)

#### 基本対策

- **初期 ID/パスワードの変更**
- 不要な Telnet/SSH の無効化
- ファームウェア更新

試験では **「脆弱性修正」より「設定変更」** が正解になることが多いです。

#### ネットワーク側対策

- ISP によるトラフィック監視
- 不審通信の遮断
- DDoS 対策サービスの導入

### IoT マルウェアの位置づけ

| 種別 | 特徴 |
|---|---|
| PCマルウェア | 情報窃取/ランサム |
| IoTマルウェア | **DDoS要員化** |
| Mirai | IoT DDoS の代表例 |

### ボットネットとの関係

Mirai は下記の特徴を持ちます。

- **ボットネット型マルウェア**
- 感染端末 = ボット
- C&C により一括制御

**「Mirai = IoT版ボットネット」です。**

## マルウェア検知技術

### マルウェア検知方式の全体像

マルウェア検知手法は、大きく以下の 5 つに分類されます。

| 検知方式 | 特徴 | 代表用途 |
|-----------|--------|-----------|
| パターンマッチング法 | 既知のウイルスに最も強い | 従来型アンチウイルスエンジン |
| チェックサム法 | 改ざん検知に強い | ファイル監視/整合性検査 |
| コンペア法 | 正常ファイルとの差分検出 | ブート領域検査 |
| ビヘイビア法 | 挙動から悪意を判断 | EDR/Sandboxing |
| ヒューリスティック法 | 未知/亜種に強い推論方式 | 次世代 AV の中核 |

### パターンマッチング法(Signature-based Detection)

#### 定義

IPA/AV-TEST などで「**既知のマルウェアの特徴的バイト列(シグネチャ)を用いた検知方式**」と定義されています。

#### 仕組み

- マルウェアから抽出した特徴バイト列をデータベース化
- ファイルを走査し、該当シグネチャと一致すれば検知

#### 利点

- 高速/誤検知が少ない
- シンプルな検知方式

#### 欠点

- 未知/変形型ウイルスには無力
- シグネチャ更新が必須

### チェックサム法(Checksum-based Detection)

#### 定義

チェックサム法とは、**ファイルから計算したチェックサム値を正常時の値と比較**し、ファイル改ざんを検知する方式です。

#### 長所

- ファイルの改変を高精度に検出
- ブート領域/重要ファイル監査で利用可能

#### 短所

- ウイルスがチェックサム計算を迂回する場合は検出不可
- 変形型ウイルスへの耐性は低い

### コンペア法(Compare Method)

#### 定義

**正常な基準ファイル(もしくはクリーンイメージ)と比較し、差分から感染を検出する方式**です。

#### 特徴

- OS のブート領域検査/システムファイル整合性検査に利用
- 正常ファイルを常に保持する必要がある
- ステルス型ウイルスが I/O を改ざんすると回避される

### ビヘイビア法(Behavior-based Detection)

#### 定義

ビヘイビア法とは、**ファイル書き込み/プロセス生成/レジストリ改変/通信などの挙動を監視し、悪意の有無を判断する方式**です。
これは現代の **EDR(Endpoint Detection & Response)** の基礎技術です。

#### 検知対象

- 未知マルウェア
- ファイルレスマルウェア
- スクリプト型攻撃

#### 欠点

- 正常動作との線引きが難しく、誤検知が発生しやすい
- コスト/監視負荷が高い

### ヒューリスティック法(Heuristic Detection)

#### 定義

ヒューリスティック法とは、**構造解析(静的)と挙動解析(動的)により、怪しい特徴を推論し未知マルウェアを検知する方式**です。
AV製品の「次世代検知エンジン」の中心技術です。

#### 静的ヒューリスティック

下記を解析し、マルウェアらしさを評価します。

- API 呼び出し
- 自己書換コード
- 暗号化ルーチン

#### 動的ヒューリスティック

- サンドボックスにより実際に実行して評価
- ランサムウェアのファイル大量暗号化などを検出

### 検知方式の比較

| 検知方式 | 既知ウイルス | 未知ウイルス | 変形型 | 誤検知 | 主な用途 |
|-----------|--------------|--------------|--------|--------|-----------|
| パターンマッチング | ◎ | × | × | 少 | 従来型 AV |
| チェックサム法 | △ | × | × | 少 | 改変検出 |
| コンペア法 | △ | × | × | 少 | ブート領域監査 |
| ビヘイビア法 | ○ | ○ | ○ | 多 | EDR/Sandbox |
| ヒューリスティック法 | ○ | ◎ | ○ | 中 | 次世代AV |

### 変形型ウイルス(Polymorphic/Metamorphic)

下記どちらもシグネチャ型を回避します。

- **ポリモーフィック**：暗号化＋復号ルーチン変形
- **メタモーフィック**：本体コードを完全書換

### サンドボックス(Sandbox)

仮想環境でマルウェアを実行し、挙動を観察する技術です。
Emotet/ランサムウェア対策で必須です。

### EDR(Endpoint Detection & Response)

端末の動作ログを収集し、攻撃チェーンを分析/可視化する新世代防御です。

### 機械学習によるマルウェア検知

未知マルウェア分類において、ヒューリスティック＋ML が主流です。

## Rootkit(ルートキット)

### 定義

**rootkit(ルートキット)**とは、OS やミドルウェアの機能をすり替え/隠蔽することで、マルウェアや不正活動の存在そのものを隠すためのコンポーネントを指します。

- 元々は Unix 系 OS の **root(管理者権限)** を奪った攻撃者が侵入を隠すために使ったツール群が語源
- 現在では Windows/Linux/macOS/モバイルOS/UEFI/ハイパーバイザなど、広いレイヤに存在しうる **「隠蔽型マルウェア」** の総称として用いられます。

### rootkit の主な目的

1. **マルウェアの存在の隠蔽(ステルス性の確保)**
2. **継続的な不正アクセス(永続化)**
3. **追加マルウェアのインストール/制御**
4. **認証情報/機密情報の窃取**

### rootkit の種類(レイヤ別整理)

rootkit は「どのレイヤを改ざん/フックするか」で分類されます。

#### ユーザモード rootkit

- DLL インジェクション/API フックなどにより、`ps`/`netstat`/タスクマネージャ等の表示から不正プロセスを隠蔽
- アプリケーション層で完結するため実装容易だが、**OS カーネルからの検査には比較的弱い**です。

#### カーネルモード rootkit

- OS カーネル空間でドライバとして動作し、システムコールテーブル(SSDT)やカーネル関数をフックして隠蔽
- プロセス/ファイル/レジストリ/ネットワーク接続を OS レベルで隠せるため、**検出が非常に困難**

代表的技術：

- **SSDT Hook**：システムコールテーブルを書き換え、特定API呼び出しを rootkit に転送
- **Inline Hook**：関数先頭の命令を書き換えジャンプさせる
- **DKOM(Direct Kernel Object Manipulation)**：カーネル内のプロセスリストなどのオブジェクトを直接書き換え、プロセスを一覧から除外

#### Bootkit/MBR/UEFI rootkit

- MBR/VBR/UEFI など **ブートプロセス**に侵入し、OS 起動前に自身をロードするタイプ
- OS の保護機構が有効になる前に動作するため、検出と除去が困難

#### ファームウェア rootkit

- HDD/SSD/ネットワーク機器/BIOS/UEFI など、**ハードウェアファームウェア**に侵入/改変されるタイプ
- OS 再インストール後も残存する可能性があり、実務では **機器交換やファーム再フラッシュ**が必要

#### ハイパーバイザ型 rootkit

- 仮想化環境の **ハイパーバイザ層**に潜り込み、ゲスト OS 全体を監視/操作
- ゲスト OS から見えないレイヤで動作するため、非常に高いステルス性

### rootkit の代表的な隠蔽テクニック

#### API/システムコールフック

- ファイル列挙/プロセス列挙/接続一覧取得 API の戻り値を書き換え、不正プロセス/不正ファイル/不正ポートを一覧から除外

#### DKOM(Direct Kernel Object Manipulation)

- `EPROCESS` などのカーネルオブジェクトのリンクリストを書き換え、対象プロセスを OS の管理テーブルから「見えなくする」

#### ドライバロード/偽装

- 正規ドライバに見せかけたカーネルドライバをロードし、カーネル権限で任意コードを実行/隠蔽処理

#### ログ改ざん

- OS ログ/監査ログ/アプリケーションログを改ざん/削除して痕跡隠滅

### rootkit の検出技術(Anti-rootkit)

#### シグネチャベース

- 既知 rootkit のバイナリパターン/ドライバ名/レジストリ値などをもとに検出
- 新種/亜種/難読化 rootkit には限界

#### 整合性検査(インテグリティチェック)

- 「**信頼できる基準状態**」と比較して改ざんを検出する方式
  - カーネルコードセクションのハッシュ
  - システムコールテーブルの整合性
  - ファイルシステムメタデータの比較
- Trusted Boot/Secure Boot/File Integrity Monitoring とも関連

#### メモリフォレンジック

- メモリダンプを取得し、下記などを解析して検出します。
  - 隠れプロセス
  - 不正ドライバ
  - フックされた関数
- Volatility などのメモリフォレンジックツールを使用

#### 挙動分析(ビヘイビアベース)

- 権限昇格/不審なドライバロード/カーネルAPI呼び出しパターンなどを監視
- EDR(Endpoint Detection & Response)が代表例で、ログ/メモリアクセス/ネットワーク等を総合的に分析

### rootkit への対策

#### 侵入を防ぐための予防策

- OS/ミドルウェア/ドライバの **最新パッチ適用**
- 不要な管理者権限の排除(最小権限の原則)
- 正規署名ドライバのみロードする設定(Driver Signing Enforcement)
- UEFI Secure Boot を有効化し、不正ブートローダを阻止
- 不審なソフトウェア/クラックツール/怪しいドライバを導入しない

#### 感染後の対応

rootkit は OS コードレベルで汚染するため、**完全駆除が非常に困難**とされます。
実務では以下の対応が推奨されることが多いです。

1. 信頼できる外部メディアから起動し、重要データをバックアップ
2. ストレージの完全初期化と OS のクリーンインストール
3. 必要に応じてファームウェア再フラッシュ/機器交換
4. 再構築後はパッチ/設定/権限などの見直しを実施

### rootkit と他マルウェアとの関係

rootkit は単独で動作する「攻撃本体」というより、**他マルウェアのステルス化/永続化を支援するモジュール**として用いられることが多いです。

#### ボットネット＋rootkit

- C2(Command & Control)通信/スパム送信/DDoS 機能を持つボットに rootkit が組み合わされる
- rootkit がボットプロセス/通信を隠蔽し、長期潜伏を実現

#### ランサムウェア＋rootkit

- 暗号化処理の前にセキュリティ製品を無効化し、自身の痕跡を隠すために rootkit を併用

#### APT 攻撃＋bootkit/UEFI rootkit

- 国家レベル/高度標的型攻撃では、ブートプロセスやファームウェアを侵害し、**数年単位の長期潜伏**を行うケースも報告されています。

### 周辺知識(rootkit関連)

#### ユーザモード/カーネルモードの違い

| 項目 | ユーザモードマルウェア | カーネルモード rootkit |
|------|------------------------|--------------------------|
| 権限 | OSの制限あり | OS全体を支配 |
| ステルス性 | 中程度 | 非常に高い |
| 検出難易度 | 中 | 高 |

#### Secure Boot/Trusted Boot

- UEFI Secure Boot：署名付きブートローダのみ起動を許可し、bootkit や UEFI rootkit を防ぐ仕組み
- Trusted/Measured Boot：TPM に起動プロセスの測定値を保存し、リモートからの検証(Remote Attestation)を可能にする

#### EDR/XDR

- 挙動/イベントログ/メモリアクセス/ネットワーク通信を統合監視し、rootkit を含む高度な脅威を検知/対応する仕組み
- 従来型 AV の「シグネチャ中心」から、**ふるまい/相関分析中心**へと移行

## 仮想通貨環境とクリプトジャッキング

### 仮想通貨環境とは

#### 定義

仮想通貨環境とは、**暗号資産(仮想通貨)の生成/管理/取引/検証を行うための技術基盤および運用環境の総称**です。
主に以下を含みます。

- ブロックチェーンネットワーク
- マイニング(採掘)環境
- ウォレット(秘密鍵管理)
- 取引所/ノード/スマートコントラクト

#### 仮想通貨の技術的前提

仮想通貨は以下の技術に依存します。

- 公開鍵暗号方式(ECDSA 等)
- ハッシュ関数(SHA-256 等)
- 分散合意アルゴリズム(PoW/PoS)
- P2P ネットワーク

これらは改ざん耐性を高める一方、**計算資源への依存度が高い**という特徴を持ちます。

### マイニングと計算資源

#### マイニングの概要

マイニングとは、**取引の正当性検証とブロック生成を行う計算作業**であり、成功すると報酬として仮想通貨が得られます。

- Proof of Work(PoW)では大量の CPU/GPU 計算が必要
- 電力/計算資源が直接コストになる

#### 攻撃者視点の問題点

- 正規マイニング：電気代/設備投資が必要
- 不正マイニング：**他人の計算資源を使えばコストゼロ**

ここで登場するのが **クリプトジャッキング**です。

### クリプトジャッキング(Cryptojacking)

#### 定義

**クリプトジャッキング(Cryptojacking)**とは、利用者の同意なく、他人のコンピュータやサーバの CPU/GPU 資源を用いて仮想通貨のマイニングを行う不正行為です。
IPA/JPCERT/CC/MITRE ATT&CK でも**不正なリソース利用型マルウェア行為**として整理されています。

#### マルウェアとの違い(試験で重要)

| 項目 | 情報窃取型マルウェア | クリプトジャッキング |
|---|---|---|
| 主目的 | 情報の盗難 | 計算資源の不正利用 |
| 痕跡 | データ漏えい | CPU 使用率上昇 |
| 被害 | 情報流出 | 性能劣化/電力消費 |
| 発覚 | 比較的早い | 気付きにくい |

### クリプトジャッキングの主な手法

#### マルウェア感染型

- メール添付
- 不正サイト
- 脆弱なサーバへの侵入

感染後、バックグラウンドで常時マイニングを実行します。

#### Webブラウザ型(スクリプト型)

- Web ページに JavaScript マイニングコードを埋め込む
- ページ閲覧中のみ CPU を使用

過去に **Coinhive** などが問題となりました。

#### クラウド/仮想環境の悪用(重要)

- IaaS の認証情報漏えい
- Kubernetes の設定不備
- 管理用 API の公開

### 被害の具体例

- サーバ応答遅延
- クラウド利用料金の急増
- CPU 温度上昇による機器劣化
- バッテリー消耗(モバイル端末)

### 対策(IPA/JPCERT)

#### 技術的対策

- EDR/挙動検知型ウイルス対策
- CPU 使用率の監視
- Web スクリプト制御(NoScript 等)
- クラウド IAM 設定の最小権限化

#### 運用的対策

- 不審な負荷増大の監視
- 利用料金アラート設定
- OS/ミドルウェアの脆弱性管理

### 関連知識

#### クラウドと仮想通貨攻撃

- IaaS は攻撃者にとって「理想的なマイニング環境」
- 認証情報漏えい = 即マイニング

#### MITRE ATT&CK との関係

- T1496(Resource Hijacking)として分類
- ランサムウェアとは異なる収益モデル

#### ランサムウェアとの比較

| 観点 | ランサムウェア | クリプトジャッキング |
|---|---|---|
| 収益 | 一時的 | 継続的 |
| 目立ちやすさ | 高い | 低い |
| 被害通知 | 必須 | 不要 |
