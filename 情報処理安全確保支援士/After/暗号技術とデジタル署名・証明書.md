# 暗号技術とデジタル署名・証明書 ― CRYPTREC・ハッシュ・MAC・XML署名・PKI・タイムスタンプ・ブロックチェーンの体系整理

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年秋の情報処理安全確保支援士に向けて勉強中です。
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。
**本記事は学習した内容を記載しています。**

## 該当問題

[情報セキュリティスペシャリスト平成22年秋期 午前Ⅱ 問21](https://www.sc-siken.com/kakomon/22_aki/am2_21.html)
[情報セキュリティスペシャリスト平成25年春期 午前Ⅱ 問3](https://www.sc-siken.com/kakomon/25_haru/am2_3.html)
[情報セキュリティスペシャリスト平成26年春期 午前Ⅱ 問2](https://www.sc-siken.com/kakomon/26_haru/am2_2.html)
[情報セキュリティスペシャリスト平成26年秋期 午前Ⅱ 問4](https://www.sc-siken.com/kakomon/26_aki/am2_4.html)
[情報セキュリティスペシャリスト平成28年春期 午前Ⅱ 問9](https://www.sc-siken.com/kakomon/28_haru/am2_9.html)
[情報処理安全確保支援士平成29年秋期 午前Ⅱ 問4](https://www.sc-siken.com/kakomon/29_aki/am2_4.html)
[情報処理安全確保支援士令和2年秋期 午前Ⅱ 問5](https://www.sc-siken.com/kakomon/02_aki/am2_5.html)
[情報処理安全確保支援士令和3年秋期 午前Ⅱ 問8](https://www.sc-siken.com/kakomon/03_aki/am2_8.html)
[情報処理安全確保支援士令和4年春期 午前Ⅱ 問10](https://www.sc-siken.com/kakomon/04_haru/am2_10.html)
[情報処理安全確保支援士令和5年春期 午前Ⅱ 問6](https://www.sc-siken.com/kakomon/05_haru/am2_6.html)
[情報処理安全確保支援士令和5年秋期 午前Ⅱ 問3](https://www.sc-siken.com/kakomon/05_aki/am2_3.html)
[情報処理安全確保支援士令和5年秋期 午前Ⅱ 問4](https://www.sc-siken.com/kakomon/05_aki/am2_4.html)

## CRYPTREC

電子政府で利用する暗号技術を評価し、推奨するために、総務省/経産省/IPAを中心に構成された日本政府の暗号評価機関です。
つまり、政府システムで使ってよい暗号技術を決める公式委員会という位置づけにあります。

### なぜCRYPTRECが必要なのか

暗号技術は「時間とともに安全性が劣化」し、「有名な暗号でも突然実用不適」となることがあるからです。
PCの計算性能向上や新しい攻撃手法によって暗号技術の解読時間が短くなっています。
そのため、日本政府全体で共通の安全な暗号のリストを維持しなくてはいけないことから、CRYPTRECが登場しました。
したがって、CRYPTRECが提供している内容は日本政府にとって信頼できる暗号の基準を意味します。

### CRYPTRECの構成

CRYPTRECは3部門から構成されます。

* 暗号技術評価委員会
* 暗号技術の評価ワーキンググループ
* 暗号リストWG

### CRYPTRECの成果物

CRYPTRECの最も重要な役割は電子政府推奨暗号リストの作成です。
リストは大きく3種類に分割されます。

1. 電子政府推奨暗号リスト(Recommended Ciphers)
2. 適用候補暗号リスト(Candidate Ciphers)
3. 重点検討暗号

#### 電子政府推奨暗号リスト

政府システムで積極的に使用すべき暗号を表します。

* 暗号化(共通鍵暗号)
    * AES
    * CAMELLIA
* ハッシュ関数
    * SHA-256
    * SHA-3
* 公開鍵暗号
    * RSA
    * ECDSA/ECDH

#### 適用候補暗号リスト

現時点では使ってもよいが将来の推奨入りは未定を表します。

* CHACHA20
* POLY1305

#### 重点検討暗号

安全性懸念があり、新規利用は非推奨を表します。

* SHA-1
* 3DES
* RC4
* RSA 1024bit

### CRYPTRECの評価基準

CRYPTRECが暗号の安全性を評価する際は、国際的にも認められた要素が考慮されます。

#### 評価基準例

* 現在知られている攻撃に対し十分な安全性があるか
* 安全性の根拠が理論的に明確か
* 国際標準化(ISO/NIST)の状況
* 実装効率(ハードウェア/ソフトウェア)
* 将来の計算能力(量子コンピュータ)を見据えた安全性

### CRYPTRECが廃止を決めた暗号

* MD5
    → 衝突攻撃成功が証明され、電子署名用途としては即時廃止
* SHA-1
    → 実用衝突攻撃成功が証明され、電子署名/証明書では利用禁止
* RC4
    → 機密性を確保できないため、TLSからも完全排除
* 3DES
    → ブロック長が短く(64ビット)Birthday攻撃(Sweet32攻撃)の危険性があるため、将来的に廃止予定

## 疑似乱数(PRNG: Pseudo Random Number Generator)

疑似乱数とは **決定論的アルゴリズムによって生成される乱数列** のことです。
種(Seed)が同じであれば同じ乱数列を生成します。

### PRNGの分類(エビデンス: NIST SP 800-90A Rev.1)

#### 非暗号学的 PRNG

例: LCG, Mersenne Twister

- 予測されやすいです
- 統計的には良いですが、暗号用途では不適です
- 内部状態が露呈すると将来の値が推測可能です

#### 暗号学的 PRNG(CSPRNG)

例: Hash_DRBG, HMAC_DRBG, CTR_DRBG

- 出力から内部状態が推測不能です
- Forward/Backward secrecy を満たします
- 鍵、Nonce、IV生成に必須です

## 暗号学的ハッシュ関数(NIST FIPS 180-4)

暗号学的ハッシュ関数は **任意長のデータを固定長に圧縮する一方向関数** です。

### 暗号学的性質(3要件)

| 名称 | 意味 | 説明 |
|------|------|------|
| **原像困難性** | h = H(x) から x を求めるのが困難 | 2^n の計算量 |
| **第二原像困難性** | 同じハッシュ値を与える別の入力 x' を見つけるのが困難 | 2^n の計算量 |
| **衝突困難性(衝突発見困難性)** | 異なる x, x' で H(x)=H(x') を見つけるのが困難 | 2^(n/2) の計算量 |

### 衝突発見困難性(Collision Resistance)

衝突発見困難性とは、**異なる2つの入力が同じハッシュ値になる衝突を見つけることが困難である性質**のことです。

#### なぜ「2^(n/2)」になるのか(誕生日攻撃)

- 衝突探索問題は「誕生日のパラドックス」に基づきます
- n ビットのハッシュ値の衝突発見計算量は **2^(n/2)** です
- 例: SHA-256 → **2^128** の計算量です

#### SHA-1 が廃止された理由

Google による **SHAttered(2017)** で実際に衝突が生成されたためです。

衝突実現は以下を可能にする危険があります。

- 電子署名の改ざん
- 証明書偽装
- ファイルの完全性破壊

### ハッシュ関数の代表例

| アルゴリズム | 規格 | 安全性 |
|--------------|------|--------|
| SHA-1 | FIPS 180-4 | 衝突実証済みで非推奨 |
| SHA-2(SHA-256/512) | FIPS 180-4 | 現行の標準 |
| SHA-3 | FIPS 202 | Keccakベース |

## MAC(Message Authentication Code)

MACは **メッセージの改ざん検知 + 送信元認証** を提供します。

### HMAC(RFC 2104)

- ハッシュ関数 + 秘密鍵を使用します
- SHA-256 などを利用します
- TLS, IPsec などで標準使用されています

### CMAC(NIST SP 800-38B)

- AES などのブロック暗号を利用します
- 高速でハードウェア実装に向いています

### UMAC/VMAC

- 大量データ処理向け高速MACです

### PRNG/ハッシュ/MAC の関係性

| 技術 | 関係 |
|------|------|
| PRNG | MACの鍵/Nonce/IV生成に使用 |
| ハッシュ関数 | HMACやデジタル署名の基盤となる |
| MAC | 改ざん防止と送信元認証を提供 |

### MAC とデジタル署名の比較

| 項目 | MAC | デジタル署名 |
|------|------|--------------|
| 鍵 | 共通鍵 | 公開鍵/秘密鍵 |
| 機能 | 改ざん検知/送信元認証 | 否認防止/改ざん検知 |
| 代表方式 | HMAC, CMAC | RSA, ECDSA |

## XMLデジタル署名(W3C 勧告に基づく解説)

XMLデジタル署名(XML Signature)は、**XML文書に電子署名を適用するための国際標準仕様**であり、W3C と IETF が共同策定した **W3C勧告「XML Signature Syntax and Processing」** に基づいています。

電子署名として必要な以下の性質を XML 文書上で実現します。

- **完全性(改ざん検知)**
- **認証(署名者の識別)**
- **否認防止**

特に XML は構造に自由度があり、空白や属性順序の違いで別文書と解釈されるため、**署名前処理(Transform)や正規化(Canonicalization)が不可欠**です。

### XML署名の基本構造(W3C 正式仕様)

```xml
<Signature xmlns="http://www.w3.org/2000/09/xmldsig#">

    <SignedInfo>
        <!-- 署名対象のURI、Transform、正規化、ハッシュ方式など -->
    </SignedInfo>

    <SignatureValue>
        <!-- SignedInfo を署名者の秘密鍵で署名した値 -->
    </SignatureValue>

    <KeyInfo>
        <!-- 公開鍵・X.509証明書など（任意） -->
    </KeyInfo>

</Signature>
```

#### SignedInfo

署名対象データ、Transform、ハッシュアルゴリズムを定義するブロックです。
XML署名では **文書そのものではなく、この SignedInfo 部分に対して署名を施す**ことが特徴です。
「署名対象のURI」は「\<Reference URI="署名対象のURI"\>」のように「Reference属性」に記述します。

#### SignatureValue

SignedInfo を秘密鍵で署名した値です。
検証時には公開鍵で SignatureValue を確認します。

#### KeyInfo(任意)

公開鍵情報や証明書を含められます。
セキュリティ方針により外部鍵管理とする場合は省略されます。

### 署名形式(Detached / Enveloped / Enveloping)

XML署名では、**署名が文書中のどこに配置されるか**によって形式が分かれます。

#### Detached Signature(デタッチ署名)

- 署名と署名対象が物理的に分離されています
- `<Reference URI="http://example.com/data.xml">` のように外部リソースを指定します
- 既存文書を改変できない場合に適します
- バイナリデータにも利用可能です

#### Enveloped Signature(エンベロープ署名)

署名対象 XML 文書の内部に `<Signature>` が埋め込まれる形式です。

```xml
<Document>
    <Data> ... </Data>
    <Signature> ... </Signature>
</Document>
```

- 文書全体をまとめて扱いやすいです
- 署名自身を署名対象に含めないため、Transform に **Enveloped Signature Transform** が必要です

#### Enveloping Signature(エンベローピング署名)

署名文書がデータを内包する形式です。

```xml
<Signature>
    <Object>・・・署名対象データ・・・</Object>
</Signature>
```

- 署名とデータを "1つの XML として配布したい" 場合に便利です
- XML署名が"容器"となり、複数の `<Object>` を含めることも可能です

### 正規化(Canonicalization: C14N)

XML は以下の違いだけで別文書として扱われます。

- 空白・改行
- 属性の順序
- XML 宣言の有無
- 名前空間の扱い

署名時の入力文書と検証時の文書が少しでも異なると検証に失敗するため、**正規化(C14N: Canonical XML)によって XML を唯一の形に統一** します。

例:
- `xmlns` の統一
- 属性順序の並べ替え
- 無駄な空白の除去

W3C は **Canonical XML 1.0 / 1.1**, **Exclusive Canonical XML** を勧告しています。

### Transform(署名前処理)

XML署名では署名対象データに対する前処理を **Transform 要素**で定義します。

代表例:

- **Canonicalization(正規化)**
- **XPath Transform(署名範囲の絞り込み)**
- **Enveloped Signature Transform**
  → エンベロープ署名で `<Signature>` を署名対象から除く目的です

Transform は **XMLの柔軟性による"改ざんではない差異"を吸収する**ためのしくみです。

### XML(Extensible Markup Language)

XML は W3C が策定した **構造化データを表現するためのマークアップ言語**です。

- HTML が「見た目」を記述するのに対し、XML は「データ構造」を表現します
- 階層構造で意味を表すため、電子署名の対象として扱いやすいです
- SOAP、SAML、電子政府システムなど多くの分野で利用されています

### W3C(World Wide Web Consortium)

W3C はティム・バーナーズ＝リーらが主導する **Web 技術の標準化団体**です。

- HTML / CSS / XML / SVG
- WebCrypto API
- XML Signature / XML Encryption

など、Web の基盤となる技術仕様を策定しています。

### XML署名の周辺知識

#### XML Encryption(XML暗号)

XML署名が「完全性」を担保するのに対し、**XML Encryption は「機密性」を XML レベルで実現する**ための標準仕様です。
署名と併用することが多いです。

#### XAdES(XML Advanced Electronic Signatures)

EU の電子署名法に基づく **高度電子署名規格**で、XML署名を拡張したものです。
タイムスタンプや長期検証情報の付加が可能です。

#### SAML(Security Assertion Markup Language)

シングルサインオン(SSO)で利用される認証情報を XML でやりとりする枠組みです。
SAML のアサーションには XML署名が利用されます。

#### SOAP・WS-Security

Webサービスの世界では、SOAP メッセージに対して XML署名や暗号化を適用できます。

## デジタル証明書(X.509)と PKI

### なぜ PKI が必要なのか

ユーザが「https://example.com」にアクセスするとき、次の疑問が必ず発生します。

- このサーバは本当に"example.com"なのか
- 公開鍵は本物なのか、誰かが偽サイトを作っていないか

**これを保証する技術が PKI(公開鍵基盤)です。**
PKI の目的は、**公開鍵を安全に信用できる状態にすること**です。

### PKI の構成要素

#### CA(Certification Authority: 認証局)

- 利用者へ**X.509公開鍵証明書**を発行する主体です
- インターネット世界における「信頼の根」です
- EV証明書などは**CA/B Forum**により審査基準が標準化されています

#### RA(Registration Authority: 登録局)

- 証明書申請者の本人確認を実施します
- 証明書発行は行わず、CAの前段階処理を担います

#### VA(Validation Authority: 証明書有効性検証局)

- クライアントからのリアルタイムの問合せにはOCSP(Online Certificate Status Protocol)やSCVPが用いられ、VAにはレスポンダ(サーバ)の機能が実装されます
- 以下の方法で公開鍵証明書の有効性を検証し、クライアントからの証明書の有効性に関する問い合わせに応答します
    * CAの公開鍵で署名を検証
    * 証明書の有効期限を確認
    * CRLの集中管理
    * CRLを確認

#### AA(Attribute Authority: 属性認証局)

- CAに代わり属性証明書を発行します

#### Repository

証明書/CRL を公開するサーバです。

#### Subscriber(利用者)

証明書を利用して認証/署名/暗号化を行う主体です。

### X.509 デジタル証明書とは(RFC 5280)

証明書は **公開鍵の身分証明書**です。

#### 主な構造

証明書は「CA が署名した公開鍵の名刺」です。

- Subject(誰の証明書か)
- Issuer(どの CA が保証したか)
- Public Key
- Validity(有効期間)
- Extensions(用途制限など)
- CA Signature(CA の電子署名)

### 重要拡張領域

#### Key Usage

暗号化、署名など利用用途を制限します。

#### EKU(Extended Key Usage)

serverAuth/clientAuth など詳細用途を表します。

#### SAN(Subject Alternative Name)

複数 FQDN を 1 枚にまとめます。
※ブラウザは CNではなく **SAN をチェック**します。

#### CRL Distribution Points/AIA

失効確認用 URL(CRL/OCSP)を格納します。

### PKI の信頼チェーン

```
Root CA
  ↓
Intermediate CA
  ↓
End Entity(Web サーバ等)
```

ブラウザは下記を行い、安全性を判断します。

1. 署名検証
2. チェーンの正しさ
3. 有効期間
4. SAN の一致
5. 失効状態の確認

### 証明書失効(Revocation)

証明書が有効期間中でも無効化される場合を表します。

代表例:
- 秘密鍵漏洩
- 組織変更
- サーバ廃止
- 誤発行

### CRL(Certificate Revocation List: 失効証明書リスト)

有効期限内であるにもかかわらず、秘密鍵の漏えい、紛失、証明書の被発行者の規則違反などの理由により安全性が担保されなくなったために、失効となったデジタル証明書の一覧表です。

#### CRLの構造(ASN.1)

```
CertificateList ::= SEQUENCE {
  tbsCertList          TBSCertList,
  signatureAlgorithm   AlgorithmIdentifier,
  signatureValue       BIT STRING
}

TBSCertList ::= SEQUENCE {
  version                Version OPTIONAL,
  signature              AlgorithmIdentifier,
  issuer                 Name,
  thisUpdate             Time,
  nextUpdate             Time OPTIONAL,
  revokedCertificates    SEQUENCE OF RevokedCertificate OPTIONAL,
  crlExtensions          Extensions OPTIONAL
}
```

#### RevokedCertificate の要素

- **serialNumber**
- **revocationDate**
- **extensions(失効理由、invalidityDate など)**

#### thisUpdate

CRLが発行された日時です。

#### nextUpdate

次回CRLが更新されるべき日時です。
この時刻を過ぎているCRLは信頼できません。

#### CRLの運用上の課題

- **CRLファイルの巨大化**: 発行数が増えるほどCRLが大きくなり、クライアントのダウンロード負担が増えます
- **リアルタイム性が低い**: CRLは「定期更新」であり、即時の失効反映はできません
- **大規模PKIでは非効率**: 証明書数が数百万枚を超えるとCRLだけでは運用困難になります

#### Delta CRL(差分CRL)

RFC 5280準拠の仕組みで、**CRLの差分のみ配布して効率を改善する方式**です。

##### 利点

- ネットワーク負荷を削減します
- 大規模環境で有効です

##### 注意点(午後問題向け)

- Delta CRL単体では不可です
- **Base CRL と併せて検証する必要があります**

#### CRL検証手順

1. **CRL署名検証**
2. thisUpdate/nextUpdate の妥当性確認
3. 対象証明書の serialNumber が revokedCertificates に含まれているか確認
4. 必要に応じて reasonCode の内容を参照
5. Base CRL + Delta CRL を併用する場合は整合性確認

### OCSP(Online Certificate Status Protocol)

証明書の失効状態をリアルタイムに問い合わせます。

#### 応答

- good(有効)
- revoked(失効)
- unknown(不明)

#### 利点

- CRL より最新性が高いです
- 必要な証明書だけ確認するため効率的です

### OCSP Stapling(RFC 6066)

Web サーバが事前に OCSP 応答を取得し、TLS ハンドシェイク時にクライアントへ提供する方式です。

#### メリット

- 高速化します
- プライバシーを保護します
- OCSP サーバの負荷を軽減します

### 証明書の種類

| 種類 | 用途 |
|------|------|
| サーバ証明書 | HTTPS、TLS通信 |
| クライアント証明書 | 利用者認証 |
| コード署名証明書 | ソフトウェア署名 |
| S/MIME 証明書 | メール署名/暗号化 |

### CA/B Forum Baseline Requirements

商用 CA が従う国際標準です。

- サーバ証明書の有効期間は **398日以内**です
- ドメイン所有確認の標準化が行われています
- 失効対応の統一が図られています

## タイムスタンプとその効果

### タイムスタンプとは何か

#### 定義

- RFC 3161(Time-Stamp Protocol: TSP)
- 総務省「タイムスタンプ技術解説」
- 電子署名法関連ガイドライン

**タイムスタンプとは、ある電子データが「ある時刻に確実に存在していた」ことを第三者が証明する仕組みです。**

#### タイムスタンプの本質

タイムスタンプは次の2点を証明します。

1. **存在証明**: その時刻にそのデータが存在していたことです
2. **非改ざん性の担保**: その後、内容が変更されていないことです

→ **「誰が作ったか」は証明しない**点が非常に重要です。

### タイムスタンプの仕組み

#### 基本構造

```
利用者
↓(ハッシュ値送信)
TSA(時刻認証局)
↓(署名付きタイムスタンプ)
利用者
```

- TSA: Time Stamping Authority(時刻認証局)

#### 処理の流れ

1. 対象データの **ハッシュ値** を計算します
2. ハッシュ値を TSA に送信します
3. TSA が時刻情報と受け取ったハッシュ値を **電子署名** します
4. 利用者は署名付き時刻情報を受領します

→ **元データそのものは TSA に渡さない**ため、安全性が高いです。

### タイムスタンプの効果

#### 効果1: 存在証明(存在時刻の証明)

下記のようなデータで利用され、「このデータは **この時刻より前には存在していた**」ことを証明します。

- 契約書
- 設計書
- ログデータ

#### 効果2: 改ざん検知

- 元データのハッシュ値が変わります
- タイムスタンプ検証に失敗します

→ **タイムスタンプ以降の改ざんが検出可能**です。

#### 効果3: 電子署名の有効期限問題の解消

電子署名には下記弱点があります。

- 証明書には **有効期限** があります
- 失効すると、後から署名の正当性が疑われます

##### タイムスタンプ付与の効果

「証明書が有効だった時点で署名されていた」ことを証明できます。
→ **長期署名(Long-Term Signature)を可能**にします。

### タイムスタンプと電子署名の関係

| 項目 | 電子署名 | タイムスタンプ |
|---|---|---|
| 本人性 | 証明できる | 証明しない |
| 改ざん検知 | 可能 | 可能 |
| 時刻の証明 | 不十分 | **可能** |
| 有効期限対策 | 弱い | **補完可能** |

→ **両者は競合ではなく補完関係**です。

### RFC 3161(Time-Stamp Protocol)

- IETF による国際標準です
- ハッシュアルゴリズム + 電子署名を使用します
- X.509 証明書を利用します

→ **PKI 技術の一部として位置付けられます**

### 法的証拠能力との関係

- 電子帳簿保存法
- 電子契約
- 内部統制(証跡管理)

これらでは、タイムスタンプ付きデータであること、改ざん検知可能であることが重要視されます。

## ブロックチェーン(Blockchain)

### ブロックチェーンとは(定義)

#### 定義(エビデンス)

- Satoshi Nakamoto, *Bitcoin: A Peer-to-Peer Electronic Cash System*
- NIST IR 8202
- IPA「ブロックチェーン技術概要」

**ブロックチェーンとは、取引データをまとめたブロックを時系列に連結し、それを分散管理することで、改ざん耐性と可用性を実現する分散型台帳技術です。**

### ブロックチェーンの基本構造

#### ブロックの構成要素

1つのブロックは主に次の情報で構成されます。

| 要素 | 内容 |
|---|---|
| 取引データ | トランザクションの集合 |
| 前ブロックのハッシュ値 | 直前ブロックとの連結 |
| タイムスタンプ | 作成時刻 |
| ナンス(Nonce) | 合意形成で使用 |
| 自身のハッシュ値 | ブロック全体の要約 |

→ **「前ブロックのハッシュ値」を含むことが最大の特徴**です。

#### チェーン構造の意味

```
Block(n-1) ──hash──▶ Block(n) ──hash──▶ Block(n+1)
```

- 過去のブロックを改ざんすると、以降すべてのハッシュが不整合になります

→ **連鎖構造による改ざん検知/抑止**が実現されます。

### 改ざんが困難な理由

#### ハッシュ関数による完全性保証

- ハッシュ関数の性質(SHA-256 等)
  - 一方向性
  - 衝突困難性
  - 微小変更で出力が激変

→ 取引データを1ビット変更すると、ブロック全体のハッシュが変わります。

#### 分散管理(P2Pネットワーク)

- 台帳は **複数ノードで共有** されます
- 中央サーバは不要です
- 多数決(合意形成)で正当なチェーンを決定します

→ 一部ノードの改ざんは無効化されます。

#### 合意形成アルゴリズム(Consensus)

| 方式 | 特徴 |
|---|---|
| PoW(Proof of Work) | 計算量による正当性 |
| PoS(Proof of Stake) | 保有量に応じた権利 |
| PBFT | 実用向け高速合意 |

→ 攻撃者が改ざんするには**膨大な計算資源または支配力が必要**です。

### ブロックチェーンのセキュリティ特性

#### 提供される性質(CIA 観点)

| 観点 | 実現方法 |
|---|---|
| 完全性(Integrity) | ハッシュ連鎖 |
| 可用性(Availability) | 分散管理 |
| 認証/否認防止 | 電子署名 |

**※ 機密性(Confidentiality)は標準では弱いです**
**→ 必要に応じて暗号化/許可型設計を採用します**

### 電子署名との関係

- 各取引は **送信者の秘密鍵で署名** されます
- 公開鍵で検証可能です
- なりすまし防止/否認防止を実現します

→ ブロックチェーン = **ハッシュ + 電子署名 + 分散合意** です。

### パブリック型とプライベート型

| 種別 | 特徴 | 例 |
|---|---|---|
| パブリック | 誰でも参加可 | Bitcoin, Ethereum |
| プライベート | 管理者あり | 企業内台帳 |
| コンソーシアム | 限定参加 | 金融業界 |

### 51%攻撃

- 計算能力(またはステーク)の過半数を支配します
- 不正チェーンを正当と認識させる攻撃です

→ 分散度が低いほどリスクが増大します。

### スマートコントラクト

- ブロックチェーン上で自動実行される契約です
- 例: Ethereum

#### リスク

- バグがあると修正困難です
- DAO事件(2016)が代表例です

### ブロックチェーンとデータベースの違い

| 観点 | ブロックチェーン | RDB |
|---|---|---|
| 改ざん耐性 | 高い | 低い |
| 性能 | 低め | 高速 |
| 管理者 | 不要/分散 | 必要 |
| 更新 | 追記のみ | 更新可 |

## 周辺知識

### NISTの暗号標準

* AES(FIPS-197)
* SHA-2(FIPS-180-4)
* SHA-3(FIPS-202)

### ISO/IEC暗号標準

* AES(ISO/IEC 18033-3)
* RFC/ISO のハイブリッドも多いです

### PQC(耐量子暗号: Post Quantum Cryptography)

NISTが進めている新しい暗号標準化プロジェクトです。
量子コンピュータ時代に向けてCRYSTALS-Kyberなどが選定されています。

### TLSの暗号スイート

CRYPTREC推奨暗号はTLSの暗号スイートにも反映されています。

### KDF(Key Derivation Function)

PBKDF2/HKDF/Argon2 などがあります。
弱いパスワードから安全な鍵を導出します。

### Nonce(Number used once)

チャレンジレスポンス、暗号モードで再利用が禁止されています。

### HSM(Hardware Security Module)

CA の秘密鍵を厳重に保護する装置です。

### PFS(Perfect Forward Secrecy)

ECDHE などにより、秘密鍵漏洩でも過去通信を守ります。

### ACME(Let's Encrypt)

証明書自動発行プロトコルです。
