# Enhanced Open・WPA2/WPA3・IEEE 802.1X/EAP-TLSによる無線LANセキュリティの体系的整理

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年秋の情報処理安全確保支援士に向けて勉強中です。
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/a25279a17b210d6ed9f4)」をご参照ください。
**本記事は学習した内容を記載しています。**

## 該当問題

[情報セキュリティスペシャリスト平成27年春期 午前Ⅱ 問2](https://www.sc-siken.com/kakomon/27_haru/am2_2.html)
[平成25年秋期試験問題 午前Ⅱ 問4](https://www.sc-siken.com/kakomon/26_aki/am2_25.html)
[情報セキュリティスペシャリスト平成28年春期 午前Ⅱ 問18](https://www.sc-siken.com/kakomon/28_haru/am2_18.html)
[令和3年春期試験問題 午前Ⅱ 問17](https://www.sc-siken.com/kakomon/03_haru/am2_17.html)

## 無線LANの基本

### 無線LANとは

無線LAN(Wireless LAN)は、**電波を用いて端末同士/端末とアクセスポイント(AP)を接続するLAN技術** です。代表的な規格はIEEE 802.11系列です。

- 802.11a/b/g/n/ac/ax … 物理層/データリンク層の規格(周波数帯/変調方式/最大スループットなど)
- 2.4GHz/5GHz/6GHz帯を利用します(国/規制に依存)

### 無線LAN通信の特徴

無線LAN(IEEE 802.11)は、**電波を媒体として通信する** ため、以下の性質を持ちます。

- 通信が空間に漏洩します
- 同一チャネル上の第三者が受信可能です
- 暗号化されていなければ盗聴が容易です

**「物理的に閉じた通信」ではない点が最大のリスク** です。

### 端末とAP間の通信の流れ

1. SSIDのビーコン受信
2. 認証(Authentication)
3. アソシエーション(Association)
4. データ通信

このうち **2～4の過程で暗号化の有無が決まります**。

### SSID(Service Set Identifier)

無線LANにおいて「混信」を避けるためにアクセスポイントと端末に設定するネットワーク識別子です。SSIDには最長32文字の任意の文字列を設定します。

#### 必要となった経緯

通信を行う端末とスイッチがコードで接続されている有線LANと異なり、無線LANでは1つの端末が複数のアクセスポイントと通信できてしまう「混信状態」が発生し得ます。これを回避するため、無線LANではアクセスポイントと端末にそれぞれSSIDを設定し、SSIDが一致する機器同士しか通信ができないようにアクセス制御を行っています。

### 無線LANが有線LANより難しい理由(セキュリティ面)

- 電波が **空間に漏れます**(壁/窓の外にも届きます)
- 盗聴/なりすまし/不正アクセスポイント(偽AP)が容易です
- パケットが **物理的に流出** しやすく、暗号化と認証が必須です

そのため、無線LANでは **暗号化(Confidentiality)/完全性保護(Integrity)/認証(Authentication)** がセットで問われます。

## 無線LANセキュリティの変遷(WEP → WPA → WPA2 → WPA3)

### WEP(Wired Equivalent Privacy)

- 802.11初期の標準で導入された暗号化方式です
- RC4ストリーム暗号 ＋ 24bit IV(初期化ベクトル)を使用します
- 主な問題点：
  - IVが短く再利用されやすい → キーストリーム再利用 → 暗号解読が容易です
  - 鍵管理が貧弱です(共有鍵/固定鍵)
  - CRC32による完全性保護が暗号的に弱いです

現在は **完全に使用非推奨** です。

### WPA(Wi-Fi Protected Access)

WEPの脆弱性が顕在化したのち、**暫定対策** としてWi-Fi Allianceが策定した方式です。現在はWPA2以降に移行が推奨されています。

- 暗号：TKIP(Temporal Key Integrity Protocol)
- 既存ハードウェアでのファーム更新を想定した「過渡期の方式」です

### WPA2

- IEEE 802.11iをベースにした **正式な強固セキュリティ方式** です
- 暗号：AES-CCMP(Counter Mode with CBC-MAC)を必須としています
- キーワード：**RSN(Robust Security Network)**

### WPA3

- 2018頃から導入された新世代方式です
- SAE(Simultaneous Authentication of Equals)によるパスワード認証強化を行います
- オフライン総当たり攻撃への耐性が向上しています

## WPA2の方式と構成要素

WPA2は主に以下を組み合わせて構成されています。

1. **利用者認証／ネットワーク認証**(誰が接続できるか)
2. **鍵交換(4-way ハンドシェイク)**
3. **トラフィック暗号化(AES-CCMP)**

### WPA2-Personal(WPA2-PSK)

- 共有パスフレーズ(Pre-Shared Key)を全クライアントで共用します
- 家庭/小規模オフィス向けです
- PSKからPMK(Pairwise Master Key)を導出し、そこからPTKを生成します

#### 注意点

- パスフレーズが短い／単純だと **辞書攻撃/総当たり攻撃** に脆弱です
- 共有鍵なので、1人でも漏洩すると全利用者に影響します

### WPA2-Enterprise(802.1X/EAP)

- 企業環境向けの強固な方式です
- 802.1X(ポートベース認証)＋ RADIUSサーバを利用します
- 各ユーザごとに認証/鍵生成が行われます

#### 主な構成要素

- サプリカント(Supplicant)：端末(クライアント)
- オーセンティケータ(Authenticator)：AP(スイッチ)
- 認証サーバ(Authentication Server)：RADIUSサーバ

#### 利用されるEAP方式の例

- EAP-TLS(クライアント証明書認証)
- PEAP(TLSトンネル＋内部でMS-CHAPv2など)

## 4-way ハンドシェイクの概要(IEEE 802.11i)

WPA2では、APと端末が共有しているPMK(Pairwise Master Key)から、実際にパケット暗号化に使うPTKを生成するため、**4-way ハンドシェイク** を行います。

### ステップ概要

1. **Message 1**：AP → STA
   - ランダム値ANonceを送信します

2. **Message 2**：STA → AP
   - 端末側でSNonceを生成します
   - PMK、ANonce、SNonce、MACアドレスからPTKを計算します
   - SNonceとMICをAPに送信します

3. **Message 3**：AP → STA
   - AP側でもPTKを計算し、MICを検証します
   - その後、暗号化鍵(GTKなど)を送信します

4. **Message 4**：STA → AP
   - 受信確認(ACK)を返し、セッション確立します

このハンドシェイクが正しく完了した後に、実際のデータフレームがAES-CCMPで暗号化されます。

## AES-CCMPによる暗号化/完全性保護

### CCMPとは

WEPのようなRC4＋CRC32に比べて、暗号強度/完全性ともに大幅に強化されています。

- Counter Mode with CBC-MAC
- 暗号化：AESカウンターモード
- 完全性保護：CBC-MACによるメッセージ認証

### 保護される範囲

- データフレームのペイロード部分
- 一部ヘッダの保護(完全なヘッダ保護は行われない点にも注意が必要です)

## WPA2の代表的な脅威と対策

### 弱いPSKに対するオフライン辞書攻撃

攻撃者が4-way ハンドシェイクをキャプチャすると、PSKに対する辞書攻撃/総当たり攻撃が可能となります。

#### 対策

- 長く複雑なパスフレーズ(20文字以上推奨)
- 乱数パスフレーズ＋パスワードマネージャの利用
- 可能な場合はWPA2-Enterpriseへの移行

### KRACK攻撃(Key Reinstallation Attack)

- WPA2の4-way ハンドシェイク実装の脆弱性を突く攻撃です
- 同じ鍵を再インストールさせることでnonceを再使用させ、暗号解析可能にします

#### 対策

- OS/無線LANドライバ/ファームウェアのアップデート
- AP／クライアント双方でパッチ適用

### 不正アクセスポイント(Rogue AP)/Evil Twin

- 正規APと同じSSIDを名乗る偽アクセスポイントです
- 利用者を騙して接続させ、トラフィックを盗聴/改ざんします

#### 対策

- 企業内では802.1X＋証明書を使用します
- 管理されていないAPを検出するWIPS/WIDSの利用
- 利用者教育(無料Wi-Fiのリスク周知)

## Enhanced Open

### 従来の「Open(オープン)ネットワーク」

**Openネットワーク** とは、認証も暗号化も行わずに接続できる無線LANのことです。

例：

- カフェ
- 空港
- ホテル

#### Openネットワークの問題点

| 問題 | 内容 |
|---|---|
| 盗聴 | 平文通信が可能です |
| なりすまし | 悪意あるAPの設置が容易です |
| セッション窃取 | Cookie盗聴が可能です |

HTTPSを使っても、DNSや制御情報は露出します。

### Enhanced Openとは

**Enhanced Open** とは、認証を必要としないオープンネットワークでありながら、端末とAP間の通信を暗号化する方式です。

#### 公式根拠

- Wi-Fi Alliance
- IEEE 802.11-2016 + RFC 8110(OWE)

### 正式名称

Enhanced Openは技術的には **OWE(Opportunistic Wireless Encryption)** を用いた方式です。

### 認証と暗号化の分離

Enhanced Openの特徴は以下のとおりです。

| 項目 | 内容 |
|---|---|
| 利用者認証 | 行いません |
| 通信暗号化 | 行います |
| 事前共有鍵 | 不要です |

**「誰でも接続できるが、盗聴できない」** という特徴があります。

### 鍵交換方式

- Diffie-Hellman鍵交換を使用します
- 接続ごとに **一時的なセッション鍵** を生成します

特徴は以下のとおりです。

- 他の端末の通信は復号不可です
- 鍵は接続単位で異なります

### 通信イメージ

```
端末A ──(暗号化通信)── AP
端末B ──(別鍵で暗号化)── AP
```

端末Aは端末Bの通信を盗聴できません。

### WPA2/WPA3-Enterpriseとの違い

| 項目 | Enhanced Open | WPA2/WPA3 |
|---|---|---|
| 認証 | なし | あり |
| 暗号化 | あり | あり |
| 利用対象 | 公衆無線LAN | 組織LAN |
| 鍵管理 | 自動生成 | PSK/証明書 |

### 暗号化される範囲

Enhanced Openで保護されるのは下記のとおりです。

- 端末 ⇔ AP間の無線通信

保護されないものは下記のとおりです。

- AP以降の通信(インターネット側)

### 中間者攻撃への耐性

- 盗聴：防止できます
- 偽AP：完全防止は不可です

HTTPSやVPNとの併用が望ましいです。

## IEEE 802.1Xとは

IEEE 802.1Xは、**ネットワークへの不正接続を防ぐためのポートベース認証方式** です。

### 役割(IEEE 802.1Xの中心機能)

有線LAN/無線LANの物理または論理ポートに対して「認証済み端末だけをネットワークに入れる」アクセス制御を提供します。

### 3つの構成要素

IEEE 802.1Xは以下の3つから構成されます。

| 要素 | 役割 |
|------|------|
| **Supplicant(サプリカント)** | 認証を受ける端末(PC/スマホ等) |
| **Authenticator(オーセンティケータ)** | スイッチ/無線AP(認証要求を中継) |
| **Authentication Server** | RADIUSサーバ(認証判断を行う) |

### 802.1X認証フロー

IEEE 802.1Xでは、Authenticatorは端末を即座にネットワークへ通さず、**認証フェーズ成功後にポートを開放** します。

#### 認証の流れ

このフローにより、**未認証端末の通信遮断/なりすまし防止** が可能です。

1. Supplicantがネットワークに接続します
2. Authenticatorが端末にEAP-Requestを送信します
3. SupplicantとAuthentication ServerがEAPにより認証処理を行います
4. 認証成功 → Authenticatorがポートを「Authorized」に変更します
5. 通信開始します

## EAP(Extensible Authentication Protocol)とは

EAPはRFC 3748で定義される **拡張認証プロトコル** であり、認証方式(パスワード、証明書、トークンなど)を柔軟に統合できる仕組みです。

### 頻出のEAP認証方式

| EAP方式 | 特徴 |
|----------|------|
| **EAP-TLS** | クライアント証明書による最も強固な相互認証 |
| PEAP | TLSトンネル内でユーザ名/パスワードをやり取り |
| EAP-TTLS | サーバ証明書のみ必須、内部で認証方式を選択 |

### EAPがサポートする主な認証方式

|名称|概要|
|:----|:----|
|EAP-TLS|デジタル証明書によるサーバ/クライアントの相互認証です。クライアント側にはデジタル証明書を組み込んだUSBキーやICカードがよく用いられます。|
|EAP-TTLS|TLSの仕組みでサーバを認証後、TLSのセキュアな伝送路上で様々な方法を用いてクライアントを認証します。|
|PEAP|TLSの仕組みでサーバを認証後、TLSのセキュアな伝送路上でID/パスワードによるクライアント認証をします。|
|EAP-MD5|チャレンジレスポンスでクライアントのみ認証します。|
|EAP-FAST|米シスコシステムズ社が開発した規格で、TTLSとほぼ同じ仕組みです。セキュアな伝送路の確立に証明書ではなく、DH鍵交換を用いる認証モードがあります。|

## EAP-TLS(RFC 5216)とは

EAP-TLSは **クライアント証明書とサーバ証明書の双方を用いる強固な相互認証方式** です。RFC 5216によって標準化されています。

### EAP-TLSの特徴

- **公開鍵基盤(PKI)を使用した相互認証** です
- クライアント側にも証明書が必要です
- パスワード依存がないため、フィッシング/リプレイ攻撃に強いです
- WPA2-Enterprise/WPA3-Enterpriseの標準方式です

### EAP-TLSの認証フロー(TLS Handshake利用)

```
Supplicant ⇔ Authenticator ⇔ RADIUS(Server)
      |------ TLS ClientHello -------------------->|
      |<----- TLS ServerHello + Cert --------------|
      |------ Client Certificate + Verify -------->|
      |------ TLS Finished ------------------------>|
認証成功 → Authenticator がポート開放
```

#### 特徴まとめ

- 証明書により端末の真正性を保証します
- TLSにより盗聴/改ざん/リプレイを防止します
- 最も安全な802.1X認証方式として推奨されています

### 802.1X/EAP-TLSが有効な理由

| 攻撃 | EAP-TLSが防ぐ理由 |
|------|---------------------|
| パスワード盗難 | パスワードを使いません |
| なりすまし | クライアント証明書で端末識別します |
| リプレイ攻撃 | TLSのnonce/session keyにより無効化します |
| 中間者攻撃 | サーバ証明書検証により防止します |

### よく比較される方式

| 認証方式 | 安全性 | 特徴 |
|----------|--------|-------|
| **EAP-TLS** | 最高 | 相互認証、PKI利用、最強です |
| PEAP/EAP-TTLS | 高 | TLSトンネル内でパスワード認証します |
| EAP-MD5 | 低 | パスワード認証のみ、安全性低いです |

## 周辺知識

### RADIUS(Remote Authentication Dial-In User Service)

- IEEE 802.1Xで使われる認証プロトコルです
- UDP 1812(認証)、1813(アカウンティング)

### PKI(Public Key Infrastructure)

- 証明書の発行/失効管理を行います
- EAP-TLSではクライアント証明書が必須です
- CRL/OCSPによる失効確認を行います

### WPA2-Enterprise/WPA3-Enterprise

- 無線LANで802.1X + EAPを採用しています
- 企業ネットワークで一般的です

### Supplicantソフト例

- Windows ネイティブ 802.1Xクライアント
- wpa_supplicant(Linux)
- Cisco AnyConnect NAM

### SSIDとステルスSSID

- SSIDはネットワーク識別子であり、「非公開(ステルス)」設定も可能です
- ただしビーコンを止めても、接続フレームなどからSSIDは容易に推測できるため、**セキュリティ対策とはみなされません**

### MACアドレスフィルタリング

- AP側に許可MACアドレス一覧を設定する方式です
- しかしMACアドレスは容易に偽装できるため、**補助的な対策** に留まります

### WPA3との関係

- WPA3ではEnhanced Openが標準化されています
- WPA3-Personalとは別物です

### SAEとOWEの違い

| 技術 | 用途 |
|---|---|
| SAE | パスワード認証(WPA3-Personal) |
| OWE | 認証なし暗号化(Enhanced Open) |

### 公衆無線LAN対策の全体像

| 技術 | 目的 |
|---|---|
| Enhanced Open | 無線区間盗聴防止 |
| HTTPS | 通信内容保護 |
| VPN | 全通信暗号化 |

### WPA3で追加されたポイント

- SAEによるPSK認証強化が行われています
- OWE(Opportunistic Wireless Encryption)によるオープンネットワーク暗号化が可能です
- 旧端末との後方互換性の課題があります
