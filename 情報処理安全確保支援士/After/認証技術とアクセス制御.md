# 認証技術とアクセス制御 ― AAA・チャレンジレスポンス・OTP・SSO・OAuth・多要素認証・3Dセキュア・ICカードの体系整理

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年秋の情報処理安全確保支援士に向けて勉強中です。
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/a25279a17b210d6ed9f4)」をご参照ください。
**本記事は学習した内容を記載しています。**

## 該当問題

[情報セキュリティスペシャリスト平成21年秋期 午前Ⅱ 問1](http://sc-siken.com/kakomon/21_aki/am2_1.html)
[情報セキュリティスペシャリスト平成22年春期 午前Ⅱ 問4](https://www.sc-siken.com/kakomon/22_haru/am2_4.html)
[情報セキュリティスペシャリスト平成28年秋期 午前Ⅱ 問1](https://www.sc-siken.com/kakomon/28_aki/am2_1.html)
[情報セキュリティスペシャリスト平成28年秋期 午前Ⅱ 問6](https://www.sc-siken.com/kakomon/28_aki/am2_6.html)
[情報処理安全確保支援士平成29年春期 午前Ⅱ 問14](https://www.sc-siken.com/kakomon/29_haru/am2_14.html)
[情報処理安全確保支援士令和2年秋期 午前Ⅱ 問9](https://www.sc-siken.com/kakomon/02_aki/am2_9.html)
[情報処理安全確保支援士令和5年春期 午前Ⅱ 問3](https://www.sc-siken.com/kakomon/05_haru/am2_3.html)
[情報処理安全確保支援士令和5年秋期 午前Ⅱ 問14](https://www.sc-siken.com/kakomon/05_aki/am2_14.html)
[情報処理安全確保支援士令和6年春期 午前Ⅱ 問20](https://www.sc-siken.com/kakomon/06_haru/am2_20.html)

## AAAフレームワーク

AAAはネットワークアクセス管理の基本概念であり、以下の3要素からなります。

1. Authentication(認証)
2. Authorization(認可)
3. Accounting(アカウンティング: 利用記録)

### Authentication(認証)

利用者が **誰であるか** を確認するプロセスです。

例:
- パスワード
- ワンタイムパスワード
- デジタル証明書(X.509)
- 多要素認証(MFA)

### Authorization(認可)

認証済みのユーザが **何をしてよいか** を制御する仕組みです。

例:
- VPN接続可否
- ネットワークサービス利用権限
- VLAN割当など

### Accounting(アカウンティング)

利用者の行動/接続情報を記録します。

例:
- 接続/切断時刻
- 利用したサービス
- 転送量ログ

ログ管理に関する国際基準は ISO/IEC 27002 に基づきます。

## アクセス制御モデル

### アクセス制御とは

認証済みのユーザに対して、**どのリソースに対してどのような操作を許可/拒否するかを決定する仕組み**です。認証（Authentication）の後に行われる認可（Authorization）の中核をなします。

### アクセス制御の3要素

| 要素 | 説明 |
|------|------|
| **主体（Subject）** | アクセスを要求する側（ユーザ、プロセス等） |
| **客体（Object）** | アクセスの対象となるリソース（ファイル、DB等） |
| **操作（Operation）** | 実行する行為（読取、書込、実行等） |

### 任意アクセス制御（DAC: Discretionary Access Control）

- **リソースの所有者が自由にアクセス権を設定**できるモデルです
- Unix/Linuxのファイルパーミッション（rwx）が代表例です
- 所有者が他のユーザに権限を委譲可能です

| 項目 | 内容 |
|------|------|
| 制御主体 | リソースの所有者 |
| 柔軟性 | 高い |
| 安全性 | 低い（トロイの木馬等で権限が漏洩する恐れ） |
| 代表例 | Unix/Windowsのファイルシステム |

### 強制アクセス制御（MAC: Mandatory Access Control）

- **システム管理者（セキュリティポリシー）がアクセス権を強制的に設定**するモデルです
- ユーザは自身の判断で権限を変更できません
- **機密レベル（ラベル）**に基づく制御が特徴です

| 項目 | 内容 |
|------|------|
| 制御主体 | システム（セキュリティポリシー） |
| 柔軟性 | 低い |
| 安全性 | 高い |
| 代表例 | SELinux、軍事/政府システム |

#### Bell-LaPadulaモデル（BLPモデル）

MACの代表的な数学モデルであり、**機密性を重視**します。

| ルール | 内容 | 目的 |
|--------|------|------|
| **No Read Up（単純セキュリティ特性）** | 自分より高い機密レベルの情報を読めません | 機密情報の不正閲覧防止 |
| **No Write Down（*特性/スター特性）** | 自分より低い機密レベルへ書き込めません | 機密情報の漏洩防止 |

#### Bibaモデル

**完全性を重視**するモデルです（BLPの逆）。

| ルール | 内容 | 目的 |
|--------|------|------|
| **No Read Down** | 自分より低い完全性レベルの情報を読めません | 不正確な情報の混入防止 |
| **No Write Up** | 自分より高い完全性レベルへ書き込めません | 信頼できるデータの汚染防止 |

#### Clark-Wilsonモデル

**商用環境での完全性を重視**するモデルです。

- **整合性のある操作（Well-Formed Transaction）**のみを許可します
- **職務の分離（Separation of Duty）**を強制します
- 実務的なビジネスシステムに適用されます

### ロールベースアクセス制御（RBAC: Role-Based Access Control）

- **ユーザに直接権限を与えず、役割（ロール）を介して権限を付与**するモデルです
- NIST RBAC標準（NIST INCITS 359-2004）で標準化されています

| 項目 | 内容 |
|------|------|
| 制御主体 | 管理者（ロール定義） |
| 柔軟性 | 中程度 |
| 安全性 | 高い（最小権限の原則を実現しやすい） |
| 代表例 | Active Directory、データベース権限管理 |

```
ユーザ → ロール（役割） → 権限（パーミッション）
例：田中 → 「営業部マネージャー」 → 「顧客DB読取」「売上DB読取/書込」
```

- **最小権限の原則**：必要最小限の権限のみ付与します
- **職務分離（SoD）**：1人に相反する権限を与えません（申請者と承認者を分ける等）

### 属性ベースアクセス制御（ABAC: Attribute-Based Access Control）

- **ユーザ/リソース/環境の属性を組み合わせて動的にアクセス制御**を行うモデルです
- NIST SP 800-162で定義されています

| 属性の種類 | 例 |
|-----------|------|
| **主体属性** | 部署、役職、資格、セキュリティクリアランス |
| **客体属性** | 機密レベル、データ分類、作成日 |
| **環境属性** | アクセス時刻、場所、デバイス |
| **操作属性** | 読取、書込、削除 |

```
ポリシー例：
IF 主体.部署 = "人事部" AND 客体.分類 = "個人情報" AND 環境.時刻 = "業務時間内"
THEN PERMIT(読取)
```

- RBACよりきめ細かい制御が可能です
- クラウド環境やゼロトラストアーキテクチャで採用が増加しています

### アクセス制御モデルの比較（試験頻出）

| モデル | 制御主体 | 柔軟性 | 安全性 | 適用場面 |
|--------|---------|--------|--------|---------|
| **DAC** | 所有者 | 高 | 低 | 一般OS |
| **MAC** | システム | 低 | 高 | 軍事/政府 |
| **RBAC** | 管理者(ロール) | 中 | 高 | 企業システム |
| **ABAC** | ポリシー(属性) | 最高 | 高 | クラウド/ゼロトラスト |

## RADIUS(Remote Authentication Dial-In User Service)

RADIUSはもっとも普及しているネットワーク認証プロトコルです。
Wi-Fi、VPN、スイッチ、FW など幅広い機器が対応しています。

### 特徴

- **UDPベース**(ポート: 1812/1813)
- パスワード部分のみ暗号化(共有鍵方式)
- クライアント → サーバの質問応答型
- AAA機能の集中管理が可能

### 主な用途

- 802.1X 認証(企業LAN、Wi-Fi)
- ISPにおけるユーザ認証
- VPN接続管理

### 課題

- 全文暗号化ではありません
- UDPのため信頼性が低いです
- 拡張性に限界があります

そのため、後継として DIAMETER が策定されています。

## DIAMETER(RADIUS の後継プロトコル)

**RADIUS(半径) → DIAMETER(直径)** → より強化されたAAAプロトコルであることから由来しています。

### 特徴

- **TCP または SCTP** を使用 → 高信頼です
- 全メッセージを暗号化可能(TLS/IPsec)です
- 高い拡張性(AVP: Attribute Value Pair)を備えています
- 大規模ネットワーク向けに設計されています

### 主な用途

- LTE/5G モバイルネットワークの認証基盤
- IMS(IP Multimedia Subsystem)
- 通信事業者ネットワークの加入者管理

企業LANで広く使われる RADIUS に対し、DIAMETER は通信キャリアの本格的な認証基盤として利用されています。

### RADIUS と DIAMETER の比較(試験頻出)

| 観点 | RADIUS | DIAMETER |
|------|--------|----------|
| RFC | 2865/2866 | 6733 |
| プロトコル | **UDP** | **TCP/SCTP** |
| 暗号化 | パスワードのみ | TLS/IPsec で全体暗号化 |
| 拡張性 | 低い | 高い |
| 利用領域 | 企業LAN/ISP | LTE/5G/IMS(通信事業者) |
| 信頼性 | 再送頼り | TCPにより高い信頼性 |

## チャレンジレスポンス方式(Challenge-Response Authentication)

チャレンジレスポンス方式は、**サーバがランダムな値(チャレンジ)をクライアントに送り、クライアントが秘密情報を使って応答(レスポンス)を生成する方式の認証手法**です。

重要なポイント:

- パスワードを **そのまま送信しません**
- チャレンジ値が毎回変わるため **リプレイ攻撃に耐性**があります
- パスワード盗聴リスクを大幅に低減します
- ネットワーク認証で広く採用されています(PPP/MS-CHAP/Wi-Fi 802.1X など)

### 認証の流れ

以下のようなプロセスで行われます。

1. **サーバがランダム値(Nonce)を生成して送付**します
2. クライアントは **秘密鍵またはパスワード** とチャレンジ値をハッシュ関数などで組み合わせレスポンスを生成します
3. サーバは同手順でレスポンスを計算し比較します
4. 一致すれば **正当ユーザであることを証明**されます

### CHAP(Challenge-Handshake Authentication Protocol)

PPP接続で使用されるチャレンジレスポンス方式のことです。

特徴:

- チャレンジ値はランダムです
- パスワードはネットワークに送られません
- 認証成功後も **再チャレンジ** を行うことでセッション乗っ取りを防止します
- MD5 を使用します(歴史的理由による)

CHAPメッセージ構成:

- Challenge
- Response
- Success/Failure

### ISO/IEC 9798 シリーズ(多要素認証の基盤)

ISO/IEC 9798-2:
- 対称鍵方式のチャレンジレスポンスです

ISO/IEC 9798-3:
- 公開鍵暗号を用いたチャレンジレスポンスです

公開鍵方式の場合:

- サーバは乱数をクライアントへ送信します
- クライアントが **秘密鍵で署名** → サーバが公開鍵で検証します

この仕組みは **TLS クライアント認証** の基礎となっています。

### チャレンジレスポンス方式の利点と課題

#### 利点

- パスワードの平文送信が不要です
- リプレイ攻撃耐性が高いです
- 辞書攻撃への耐性も向上します
- 認証方式として軽量で実装が容易です

#### 課題

- パスワードがハッシュ化されても、ハッシュ値自体を狙う攻撃が存在します(例: MS-CHAPv2 の脆弱性)
- ハッシュ関数の強度に依存します
- クライアント側に秘密情報管理が必要です

## ワンタイムパスワード(OTP: One-Time Password)

ワンタイムパスワードとは、**利用するたびに異なるパスワードを生成し、1回限り使用可能な認証方式**です。
パスワードの盗聴/漏えい/リプレイ攻撃を強力に防ぐため、多要素認証の一部として広く利用されます。

### OTP が防ぐ脅威

- パスワード盗聴(盗み見/キーロガー)
- ネットワーク盗聴(スニッフィング)
- リプレイ攻撃(過去の認証情報の再利用)
- パスワードリスト攻撃(固定パスワード依存のため)

### OTP の方式分類(標準規格に基づく)

OTP には大きく3つの方式があります。

| 種別 | 説明 | 主な規格 |
|------|------|-----------|
| **チャレンジ/レスポンス型 OTP** | サーバの提示する値に応じて OTP を計算 | S/KEY(RFC 1760) |
| **時間同期型 OTP** | 時刻を元に定期的に OTP 生成 | TOTP(RFC 6238) |
| **イベント同期型 OTP** | カウンタに基づき OTP 生成 | HOTP(RFC 4226) |

### S/KEY(RFC 1760)

S/KEY は **ハッシュ関数を連鎖的に適用することでワンタイムパスワードを生成する方式**です。
RFC 1760 により標準化され、初期のインターネットで広く使われました。

#### 特徴

- **オフライン攻撃に強いです(ハッシュ関数の逆算困難性)**
- サーバ側は **平文パスワードではなく「最後のハッシュ値」だけを保持**します
- チャレンジレスポンス型 OTP の基本として現在の認証方式の祖となります

#### S/KEY の仕組み(認証プロトコル)

ユーザが保持する秘密情報:
```
秘密の初期パスフレーズ P
```

サーバに登録する値:
```
H^N(P)  (ハッシュ関数を N 回適用した値)
```

#### 認証時の流れ(典型例)

1. サーバは次に必要な OTP の番号「i」を通知します
2. ユーザは OTP = H^(i)(P) を計算します
3. サーバは以下を確認します
   ```
   H(OTP) = H^(i+1)(P) ?(登録されている値)
   ```
4. 一致すれば認証成功です
5. サーバ側は登録値を H^(i)(P) に更新します

従って、**ユーザが送信する値は H^(i)(P) であり、生のパスワードやそれを逆算できる情報は含まれません。**

#### 具体的な例

ユーザがパスフレーズ P を設定し、サーバは H^100(P) を保存するとします。

認証 1 回目(i = 99)
ユーザ送信: H^99(P)
サーバは H(H^99(P)) = H^100(P) を確認し更新します。

認証 2 回目(i = 98)
同様に検証します。

これを繰り返すことで **1回限りのパスワード**が成立します。

#### S/KEY の安全性(エビデンス: ハッシュ関数の性質)

S/KEY は以下の暗号学的性質に依存します。

- **原像困難性**(H(x) から x を求めるのは困難)
- **第二原像困難性**
- **衝突困難性**

攻撃者がネットワークを盗聴して OTP(H^i(P))を取得しても、**前の値 H^(i-1)(P) を求めることはできない**ため、リプレイ攻撃が成立しません。

### 現行方式との比較(HOTP/TOTP)

| 方式 | 利点 | 欠点 |
|------|------|------|
| **S/KEY(ハッシュ連鎖)** | サーバが秘密情報を持たない/実装が簡単 | 回数管理が必須/ユーザ側計算が重い |
| **HOTP(RFC 4226)** | デバイスとサーバのカウンタ同期のみ | カウンタずれが発生 |
| **TOTP(RFC 6238)** | Google Authenticator などで主流 | デバイスとサーバの時刻同期が必要 |

## シングルサインオン(SSO)と SAML 認証

### シングルサインオン(SSO)とは

シングルサインオン(SSO)とは、**一度の認証で複数のサービスにログインできる仕組み** です。

NIST SP 800-63 では、認証(Authentication)と認可(Authorization)を区別しID 連携が行われる形態を「Federation(フェデレーション)」と定義しています。

#### SSO が必要とされる理由

- 利用者の利便性向上
- パスワード管理の負荷軽減
- パスワード再利用リスクの低減
- アクセス統制の一元管理(IDP側で統制が可能)
- ログ管理の統合

### フェデレーション(ID 連携)の構成

SSO は一般に **ID プロバイダ(IdP)** と **サービスプロバイダ(SP)** の2者間連携によって成立します。

| 役割 | 説明 |
|------|------|
| **IdP(Identity Provider)** | ユーザ認証を実施し、認証情報をトークンとして発行 |
| **SP(Service Provider)** | IdP からの認証トークンを検証し、サービスへのアクセスを許可 |

SAML/OIDC といったプロトコルにより、この認証情報の受け渡しが標準化されています。

### SAML 認証とは(エビデンス: OASIS SAML 2.0)

SAML(Security Assertion Markup Language)は**XML ベースのフェデレーション認証プロトコル**です。
代表的に利用されるのは **SAML 2.0(OASIS 標準)**です。

#### SAML の特徴

- XML + デジタル署名(XML-Signature)による高い信頼性があります
- Webブラウザによる SSO に適します(SAML Web Browser SSO Profile)
- メッセージを SP ↔ IdP 間で交換して認証連携します
- エンタープライズ SSO の定番プロトコルです(企業/大学/行政で広く採用)

### SAML の構成要素

#### Assertion

IdP が SP に渡す「ユーザ情報 + 認証結果」の XML 署名付きデータです。

含まれる情報:

- 認証方法(Password/MFA 等)
- 認証時刻
- ユーザ属性(メールアドレスなど)
- 有効期限条件(NotBefore/NotOnOrAfter)

#### Binding

SAML メッセージを HTTP 上でどう運ぶかを規定するものです。主に下記があります。

- HTTP-Redirect
- HTTP-POST(最も一般的)

#### Profile

具体的なユースケースでの振る舞いを定義しています。
- **Web Browser SSO Profile**(試験で最重要)

### SAML 認証フロー(Web Browser SSO Profile)

1. **ユーザが SP へアクセス**します
2. SP は認証が必要と判断し、**IdP にリダイレクト**します
3. **IdP がユーザを認証**(例: ID/パスワード + MFA)します
4. IdP は **署名付き SAML Assertion を生成**します
5. SP に Assertion を POST(HTTP-POST バインディング)します
6. SP は署名検証し、ユーザをログイン状態にします

このフローにより、「パスワードを SP に渡さない」= **セキュアなフェデレーション認証**が実現されます。

### SAML のセキュリティ対策(OASIS 標準)

#### XML 署名(XML Digital Signature)の検証

- Assertion の改ざん防止を行います
- IdP 公開鍵による署名検証が必須です

#### リプレイ防止

- NotBefore/NotOnOrAfter による期限管理を行います
- 一度使った Assertion ID を再使用不可にします

#### HTTPS の利用

- 機密性確保(RFC 8446/TLS1.3)を行います

#### SP と IdP の相互メタデータ交換

- 証明書
- エンドポイント URL
- 署名要求のポリシー

### SAML と他の SSO 技術の比較

| 技術 | 用途/特徴 | 基盤技術 |
|------|--------------|------------|
| **SAML 2.0** | 企業/学術機関向け、SSO の代表 | XML + 署名 |
| **OpenID Connect(OIDC)** | Web/モバイルサービス向け認証(OAuth2.0 拡張) | JSON + JWT |
| **OAuth 2.0** | 認可プロトコル(認証ではない) | Bearer Token |

試験では、**SAML = 認証連携、OAuth = 認可、OIDC = 認証** の区別を問う問題が頻出です。

### SSO の周辺知識

#### IdP/SP の役割

特に **SP が Assertion の署名を検証して認証を完了させる**という点が重要です。

#### フェデレーションメタデータ

XML 形式で、SP と IdP の設定情報(証明書/エンドポイント)を交換します。

#### シングルログアウト(SLO)

1回のログアウトで複数システムのセッション破棄を行う仕組みです。

#### JWT(JSON Web Token)

OIDC では SAML の Assertion の代わりに JWT を利用します。

## OAuth 2.0 の基礎

### OAuth 2.0 とは(エビデンス: RFC 6749)

OAuth 2.0 は **リソース所有者(ユーザ)の認証情報を第三者アプリに渡さず、安全に API 利用権限(アクセストークン)を委譲する仕組み** です。

#### 主な登場人物(RFC 6749 Section 1.1)

| 名称 | 説明 |
|------|------|
| **Resource Owner(ユーザ)** | リソースサーバ内の保護された情報へのアクセスを許可するエンドユーザーであり、クライアントの利用者 |
| **Client(クライアントアプリ)** | リソースオーナーの認可を得てリソースサーバにアクセスするサードパーティアプリケーション |
| **Authorization Server(認可サーバ)** | ユーザ認証を行い、トークンを発行 |
| **Resource Server(API サーバ)** | 保護された情報を保持し、アクセストークンの検証を行い、リソースを提供 |

OAuth2.0 は **認証ではなく認可のプロトコル** である点が重要です。

### OAuth2.0 のトークン種別(RFC 6749/RFC 6750)

#### アクセストークン(Access Token)

- API へのアクセス権限を持つトークンです
- **Bearer Token(RFC 6750)** が最も一般的です
- Bearer は「提示するだけで権限を与える」ため、**漏洩すると即悪用されます**

#### リフレッシュトークン(Refresh Token)

- アクセストークン再発行のために使用します
- 長期間有効であることが多く、厳重に管理される必要があります
- パブリッククライアントでは利用制限されることがあります

### OAuth2.0 の代表的なフロー(RFC 6749)

#### Authorization Code Grant(推奨)

最も安全とされる方式です。
サーバ側でトークン授受を行い、秘密保持が可能です。

##### PKCE(RFC 7636)

スマホアプリなどのパブリッククライアント向けに安全性を強化します。
code_verifier と code_challenge によるチャレンジレスポンスで攻撃を防ぎます。

主な防御対象:

- 認可コードの窃取攻撃
- 中間者攻撃

#### Implicit Grant

アクセストークンが URL フラグメントで直接返却される方式です。
**トークン漏洩リスクが高く、現在は使用非推奨となっています**。

#### Client Credentials Grant

サーバ間通信で利用します。
ユーザは登場しません。

#### Resource Owner Password Credentials(ROPC)

ユーザ ID/パスワードをアプリが直接受け取る方式です。
**セキュリティ上の問題から廃止方向です**。

### OAuth2.0 の脅威と対策(RFC 6819)

#### 主な攻撃例

| 攻撃 | 説明 |
|------|------|
| 認可コード窃取攻撃 | 攻撃者が認可コードを奪い取りトークンを取得 |
| リダイレクトURI差し替え | 攻撃者が悪意のコールバックURLを登録させる |
| アクセストークン漏洩 | Bearer Token が盗まれ、API が不正利用される |
| CSRF攻撃 | ログイン/認可画面への強制遷移 |

#### 重要な対策(RFC 6819)

- Redirect URI の厳格一致
- PKCE の導入
- 状態トークン state による CSRF 防止
- HTTPS の必須利用
- トークンの短命化
- Refresh Token へのローテーション導入(Token Binding)

試験では **state パラメータの役割(CSRF 対策)** が頻出です。

### OpenID Connect(認証)との違い

OAuth2.0: **認可(Authorization)**
OpenID Connect(OIDC): **認証(Authentication)**

OIDC は OAuth2.0 を拡張し、ID トークン(JWT)を使用してユーザ認証を実現します。

OIDC の主な仕様:

- ID Token(JWT)
- UserInfo エンドポイント
- Discovery(.well-known/openid-configuration)

### セキュリティトークンの仕様

| トークン | 仕様 | 特徴 |
|----------|------|------|
| JWT | RFC 7519 | 署名付き JSON。ID Token などに利用 |
| Bearer Token | RFC 6750 | 所持者に権限付与 |
| SAML Assertion | OASIS SAML | 企業の SSO で利用 |

## 多要素認証(MFA: Multi-Factor Authentication)

### 多要素認証の定義(エビデンス)

- NIST SP 800-63B(Digital Identity Guidelines)
- IPA「認証技術の解説」

**多要素認証とは、異なる種類の認証要素を2つ以上組み合わせて本人確認を行う方式です。**

### 認証要素の3分類(基本)

| 分類 | 内容 | 例 |
|---|---|---|
| 知識情報 | 本人しか知らない | パスワード、暗証番号 |
| 所持情報 | 本人が持っている | ICカード、トークン |
| 生体情報 | 本人の身体的特徴 | 指紋、顔、虹彩 |

→ **同一分類を複数使っても多要素認証にはなりません**
(例: パスワード + 秘密の質問 → 多要素ではありません)

### 多要素認証の目的

- パスワード漏えい時の被害抑止
- なりすまし/リプレイ攻撃対策
- リモートアクセスの安全性向上

## リスクベース認証(Risk-Based Authentication)

### リスクベース認証の定義

**リスクベース認証とは、利用者の状況(リスク)を評価し、その結果に応じて認証強度を動的に変化させる認証方式です。**
(エビデンス: NIST SP 800-63B, OWASP Authentication Cheat Sheet)

### 評価される主なリスク要素

| 要素 | 具体例 |
|---|---|
| 利用端末 | 登録済み端末か否か |
| 接続元IP | 国内/国外、過去実績 |
| 利用時間 | 深夜/異常時間帯 |
| 行動パターン | 通常と異なる操作 |
| 地理情報 | 短時間での国移動 |

### リスクベース認証の動作例

| 状況 | 認証動作 |
|---|---|
| 低リスク | ID + パスワードのみ |
| 中リスク | 追加でワンタイムパスワード |
| 高リスク | ログイン拒否 or 本人確認 |

→ **常に多要素を要求しない点が重要**です。

### ステップアップ認証

- リスクベース認証の実装形態です
- 通常操作 → 簡易認証
- 重要操作 → 強認証

## マトリクスコード認証(Matrix Code Authentication)

**マトリクスコード認証とは、縦横の行列(マトリクス)に配置された文字や数字の中から、指定された位置の値を入力させる認証方式です。**

### 認証要素の位置づけ

- 基本的には **知識情報**です
- 紙カードやトークンを用いる場合は **所持情報と組み合わせ可能**です

### マトリクスコード認証の特徴

| 観点 | 内容 |
|---|---|
| 利点 | ワンタイム性があり盗聴に強い |
| 欠点 | カード紛失時のリスク |
| 利用例 | インターネットバンキング |

→ **固定パスワードより安全ですが、単独では万能ではありません**

## 3Dセキュア(3-Domain Secure)

### 3Dセキュアとは

3Dセキュアとは、**オンラインクレジットカード決済時に本人認証を追加する国際標準方式**です。
不正利用対策のため EMVCo(VISA/Mastercard/JCBなど6社共同体)が標準化しています。
3Dセキュアでは **3つの"ドメイン(当事者領域)"** が連携します。

| ドメイン名 | 説明 |
|------------|------|
| **Issuer Domain** | カード発行会社(本人認証を実施) |
| **Acquirer Domain** | 加盟店側(店舗/決済代行) |
| **Interoperability Domain** | 国際ブランドのネットワーク(VISA Directory Server など) |

この「3ドメイン」が協力して不正利用を防ぐ仕組みを **3D Secure** といいます。

### 3Dセキュアの目的

- **カード情報盗用による不正決済の防止**
- **カード所有者が正しい本人であることを確認(Cardholder Authentication)**
- **加盟店のチャージバックリスク低減**

### 3Dセキュアのバージョン

#### 3D Secure 1.0

- パスワード(固定パスワード)による認証が中心です
- 認証画面がポップアップ方式で UX が悪いです
- スマホ時代に対応しきれず廃止傾向です
- フィッシングや成り済ましに弱いです

#### 3D Secure 2.0(現行方式: EMV 3DS)

**EMVCo が正式に仕様策定し、セキュリティも利便性も大幅に向上しました。**

特徴:

- **リスクベース認証(RBA)**: 高リスクのみ追加認証します
- **ワンタイムパスワード(OTP)認証対応**です
- **生体認証(指紋/顔認証)対応**です
- **アプリ内決済/スマホ決済に完全対応**しています
- **加盟店が送信するリスク情報(約100項目)で本人性を評価**します

### 3Dセキュアの認証プロセス(3DS 2.x)

オンライン決済時の簡易フロー:

1. **加盟店が決済情報 + デバイス情報を Directory Server(ブランド)へ送信**します
2. Directory Server がカード発行会社(Issuer)へ問い合わせます
3. Issuer がリスク判定します
4. **低リスク → Frictionless Flow(認証省略)**となります
5. **高リスク → 認証を要求(OTP/生体等)**します
6. 認証成功後、決済を許可します

### Frictionless Flow(認証省略型)とは

カード発行会社は加盟店から送られてくる次の情報でリスクを判定します。

**本人性が十分高いと判断されれば認証操作なしで決済が完了します。**
これにより、UX が改善され、決済離脱率が大幅に減少しました。

- 端末情報(OS/ブラウザ)
- 端末の指紋情報(Device Fingerprint)
- 過去の取引履歴
- 取引金額
- 購入商品カテゴリ
- 加盟店情報

### 3Dセキュアで使用される認証方式

3Dセキュア2は複数の認証手段をサポートします。

| 認証方式 | 説明 |
|----------|------|
| **OTP(ワンタイムパスワード)** | SMS/メール/アプリで発行 |
| **デバイス認証** | デバイス指紋/端末識別 |
| **生体認証** | 指紋認証/顔認証 |
| **Push 認証** | 銀行アプリ等の通知で認証 |
| **従来パスワード(1.0 方式)** | 互換性目的で一部残存 |

### セキュリティ強化ポイント(3DS 2.x)

#### リスクベース認証(RBA)

怪しい取引のみ認証を要求します。

#### 動的認証(Dynamic Authentication)

固定パスワードではなく、OTP や生体情報で認証します。

#### MITM/フィッシング耐性の向上

- 認証処理は **Issuer App/Issuer Server** が担当します
- 加盟店側でパスワードを扱いません

### 3Dセキュアの周辺知識

#### クレジットカード情報の非保持化

PCI DSS に基づき、加盟店はカード番号を保持しない運用が一般化されています。

#### トークナイゼーション

カード番号を安全な **トークン** に置換する方式です。

#### EMV(ICチップ)決済

- 3Dセキュアは「オンライン本人認証」です
- EMVはカード IC の「決済情報の改ざん耐性」の強化です

#### CVC/CVV

カード裏面のセキュリティコードです。
3Dセキュアと組み合わせて本人性を強化しています。

#### 不正検知システム(Fraud Detection System)

AI/機械学習で不正利用パターンを分析しています。

## ICカードの耐タンパ性(Tamper Resistance)

### ICカードとは

ICカードとは、**IC(集積回路)を内蔵し、内部で演算/記憶/暗号処理を行うカード**です。

代表例:
- クレジットカード(EMV)
- マイナンバーカード
- 住基カード
- 社員証/学生証
- SIMカード

ICカードは、**秘密鍵/個人情報/認証情報を内部に保持**するため、「盗難」「解析」「分解」に耐えることが強く求められます。

### 耐タンパ性とは何か

#### 定義(エビデンス: ISO/IEC 15408, FIPS 140)

**耐タンパ性(Tamper Resistance)**とは、**ICカードに対する物理的/電気的/環境的な不正操作(タンパリング)を検知/妨害/無効化する性質**を指します。
重要なのは「完全に防ぐ」ではなく、下記の考え方です。

- 攻撃を **困難にする**
- 攻撃を **検知する**
- 攻撃されたら **情報を破壊する**

### タンパリング攻撃とは

#### 想定される攻撃手法

| 攻撃手法 | 内容 |
|---|---|
| 物理解析 | ICチップを削る/剥がす |
| プロービング | 微細針で信号線を直接観測 |
| 電圧操作 | 電圧異常で誤動作を誘発 |
| クロック操作 | 動作タイミングをずらす |
| 温度操作 | 高温/低温による誤動作 |
| 電磁波解析 | 漏洩電磁波から秘密鍵推定 |

→ **ICカードは「攻撃される前提」で設計されます**

### ICカードの耐タンパ対策

#### 物理的耐タンパ対策

- 樹脂封止(チップを完全に覆う)
- 多層配線構造
- 配線のランダム配置

→ チップを削ると **内部配線が破壊されます**

#### センサによる検知

ICカード内部には以下のセンサが搭載されます。

| センサ | 検知内容 |
|---|---|
| 電圧センサ | 異常電圧 |
| クロックセンサ | 異常周波数 |
| 温度センサ | 高温/低温 |
| 光センサ | 封止破壊(光侵入) |

→ **異常を検知すると即座に処理停止/メモリ消去します**

#### 自己破壊/無効化機構

- 秘密鍵を即座に消去します
- ICカードを使用不能にします
- 再利用不可にします

→ **情報漏えいより「カード破壊」を優先します**

### なぜ「壊れてもよい」のか

ICカードの耐タンパ性は、**可用性よりも機密性を最優先**します。

- カードが壊れる → 利用者が再発行
- 鍵が漏れる → 全システム破綻

→ **「壊れてもいいが、漏れてはいけない」**

### 耐タンパ性と暗号モジュール評価

#### FIPS 140-2/140-3(エビデンス)

米国NISTが定める暗号モジュールの安全性基準です。
ICカードは **Level 3 以上** を満たす設計が多いです。

| レベル | 特徴 |
|---|---|
| Level 1 | 基本要件 |
| Level 2 | 改ざんの証拠(Tamper Evidence: 封印シール等の受動的な痕跡検出) |
| Level 3 | 改ざん検知・対応(Tamper Detection/Response: 能動的検知と秘密鍵消去) |
| Level 4 | 環境攻撃耐性(電圧・温度異常への包括的保護) |

### Common Criteria(ISO/IEC 15408)との関係

ICカードは CC 評価において、下記が評価対象となります。

- TOE: ICカード
- セキュリティ機能要件:
  - 物理的攻撃耐性
  - サイドチャネル耐性
  - 自己破壊機構

### ICカードの関連知識

#### 耐タンパ性 vs 耐改ざん性

| 用語 | 意味 |
|---|---|
| 耐タンパ性 | 物理攻撃への耐性 |
| 耐改ざん性 | 不正変更の防止 |

#### サイドチャネル攻撃との関係

- 電力解析
- 電磁波解析
- タイミング攻撃

→ 耐タンパ設計は **サイドチャネル対策とも密接**です。

## Kerberos認証

### Kerberosとは

**Kerberos**は、MIT（マサチューセッツ工科大学）が開発した**チケットベースのネットワーク認証プロトコル**です。Active Directoryの認証基盤として広く使用されています（RFC 4120）。

### Kerberosの構成要素

| 構成要素 | 説明 |
|---------|------|
| **KDC（Key Distribution Center）** | 認証の中核。AS + TGSで構成されます |
| **AS（Authentication Server）** | ユーザの初期認証を行い、TGTを発行します |
| **TGS（Ticket Granting Server）** | TGTを検証し、サービスチケットを発行します |
| **TGT（Ticket Granting Ticket）** | TGSに対してサービスチケットを要求するためのチケットです |
| **サービスチケット（ST）** | 特定のサービスにアクセスするためのチケットです |
| **レルム（Realm）** | Kerberosが管理する認証ドメイン（Active Directoryのドメインに相当） |

### Kerberos認証フロー（試験頻出）

```
1. ユーザ → AS：認証要求（ユーザID）
2. AS → ユーザ：TGT（ユーザの秘密鍵で暗号化）+ セッション鍵
3. ユーザ → TGS：TGT + サービス要求 + 認証子（Authenticator）
4. TGS → ユーザ：サービスチケット（サービスの秘密鍵で暗号化）
5. ユーザ → サービス：サービスチケット + 認証子
6. サービス → ユーザ：認証完了（相互認証の場合）
```

### Kerberosの特徴

| 特徴 | 説明 |
|------|------|
| **シングルサインオン** | TGT取得後は再認証なしで複数サービスにアクセスできます |
| **相互認証** | クライアントとサーバが互いの正当性を確認します |
| **チケットの有効期限** | TGT/STには有効期限があり、期限切れで再認証が必要です |
| **対称鍵暗号** | 共有秘密鍵による暗号化が基盤です |
| **タイムスタンプ** | リプレイ攻撃防止のため、時刻同期（NTP）が必須です |

### Kerberosの脅威と対策

| 脅威 | 内容 | 対策 |
|------|------|------|
| **Pass the Ticket** | 盗んだTGT/STを使いすまし | チケットの短い有効期限設定 |
| **Golden Ticket攻撃** | KDCのマスター鍵を窃取しTGTを偽造 | krbtgtアカウントのパスワード定期変更 |
| **Silver Ticket攻撃** | サービスアカウントの鍵を窃取しSTを偽造 | サービスアカウントの強力なパスワード |
| **Kerberoasting** | サービスチケットからサービスアカウントのパスワードをオフライン解析 | 管理サービスアカウントの強力なパスワード |

## パスワード認証の脅威と対策

### パスワードに対する主な攻撃手法

| 攻撃手法 | 内容 |
|---------|------|
| **ブルートフォース攻撃** | すべての文字列の組み合わせを試行します |
| **辞書攻撃** | 一般的な単語やフレーズのリストを試行します |
| **パスワードリスト攻撃** | 他サイトから漏洩したID/パスワードを流用します |
| **レインボーテーブル攻撃** | ハッシュ値から元のパスワードを逆引きする事前計算テーブルを使用します |
| **パスワードスプレー攻撃** | 多数のアカウントに対して少数の一般的パスワードを試行します |
| **クレデンシャルスタッフィング** | 漏洩した認証情報を自動化ツールで大量に試行します |

### パスワード保管のセキュリティ対策

#### ハッシュ化

- パスワードを**平文で保管しない**ことが大前提です
- SHA-256等のハッシュ関数で変換して保管します

#### ソルト（Salt）

- パスワードに**ランダムな文字列を付加**してからハッシュ化します
- ユーザごとに異なるソルトを使用します
- **レインボーテーブル攻撃を無効化**します

```
保存値 = Hash(パスワード + ソルト)
※ ソルトはハッシュ値とともに保存
```

#### ストレッチング（Key Stretching）

- ハッシュ計算を**数千～数万回繰り返し**、計算コストを増大させます
- ブルートフォース攻撃の速度を大幅に低下させます
- 代表的なアルゴリズム：**bcrypt、scrypt、Argon2、PBKDF2**

#### ペッパー（Pepper）

- ソルトとは別に、**アプリケーション側で秘密に保持する固定値**をパスワードに付加します
- データベースが漏洩しても、ペッパーがなければ解析困難です

### パスワードポリシーの推奨事項

| 項目 | NIST SP 800-63B推奨 |
|------|-------------------|
| 最小文字数 | **8文字以上**（できれば長いパスフレーズ） |
| 定期変更 | **不要**（漏洩が疑われる場合のみ変更） |
| 複雑性要件 | 強制しない（利便性低下を招くため） |
| 漏洩パスワードチェック | 既知の漏洩パスワードリストとの照合を推奨 |
| 多要素認証 | パスワード単体ではなくMFAの併用を推奨 |

## 生体認証（Biometric Authentication）の詳細

### 生体認証とは

**身体的特徴や行動的特徴を用いて本人を確認する認証方式**です。認証の3要素のうち「生体情報（Inherence）」に分類されます。

### 生体認証の種類

| 分類 | 方式 | 特徴 |
|------|------|------|
| **身体的特徴** | 指紋認証 | 最も普及、コスト低 |
| | 虹彩認証 | 精度最高、双子でも区別可能 |
| | 顔認証 | 非接触、マスク対応が課題 |
| | 静脈認証 | 偽造困難、日本で普及 |
| | 網膜認証 | 精度高いが導入コスト大 |
| **行動的特徴** | 声紋認証 | リモート認証に利用 |
| | 署名認証 | 筆圧・速度で判定 |
| | タイピングパターン | キーストロークのリズムで判定 |

### 生体認証の評価指標（試験頻出）

| 指標 | 正式名称 | 意味 |
|------|---------|------|
| **FRR** | False Rejection Rate（本人拒否率） | 本人を誤って拒否する割合 |
| **FAR** | False Acceptance Rate（他人受入率） | 他人を誤って受け入れる割合 |
| **EER** | Equal Error Rate（等価エラー率） | FRR = FARとなる点。**値が小さいほど精度が高い** |

#### FRRとFARの関係

```
閾値を厳しくする → FRR↑（本人が通りにくい）、FAR↓（他人は通りにくい）
閾値を緩くする   → FRR↓（本人が通りやすい）、FAR↑（他人も通りやすい）
```

- **セキュリティ重視**の場合：FARを低くする（閾値を厳しく）
- **利便性重視**の場合：FRRを低くする（閾値を緩く）
- **EER**は認証システムの性能を表す**総合指標**として使用されます

### 生体認証の課題

| 課題 | 内容 |
|------|------|
| **変更不可** | 生体情報は漏洩しても変更できません |
| **経年変化** | 年齢による身体変化で認識率が低下する可能性があります |
| **なりすまし** | 指紋の型取り、顔写真等による偽装リスクがあります |
| **プライバシー** | 生体情報は要配慮個人情報に該当します |
| **テンプレート保護** | 登録データ（テンプレート）の安全な管理が必要です |

## FIDO2/WebAuthn とパスキー

### FIDO（Fast IDentity Online）とは

パスワードに依存しない**公開鍵暗号ベースの認証標準**です。FIDO Allianceが策定しています。

### FIDOの世代

| 世代 | 名称 | 特徴 |
|------|------|------|
| FIDO 1.0 | UAF/U2F | UAF:生体認証、U2F:セキュリティキー |
| **FIDO2** | **WebAuthn + CTAP** | Webブラウザ標準対応、プラットフォーム認証器対応 |

### FIDO2の構成

| 要素 | 説明 |
|------|------|
| **WebAuthn（Web Authentication）** | W3C標準。ブラウザとサーバ間の認証API |
| **CTAP（Client to Authenticator Protocol）** | ブラウザと認証器間の通信プロトコル |
| **認証器（Authenticator）** | 秘密鍵を保持するデバイス（スマホ、セキュリティキー等） |

### FIDO2認証フロー

```
【登録（Registration）】
1. サーバ → ブラウザ：チャレンジ送信
2. ブラウザ → 認証器：チャレンジ転送、ユーザ検証（生体認証等）
3. 認証器：公開鍵ペアを生成、秘密鍵を安全に保管
4. 認証器 → サーバ：公開鍵 + アテステーション（認証器の信頼性証明）
5. サーバ：公開鍵を登録

【認証（Authentication）】
1. サーバ → ブラウザ：チャレンジ送信
2. ブラウザ → 認証器：チャレンジ転送、ユーザ検証
3. 認証器：秘密鍵でチャレンジに署名
4. 認証器 → サーバ：署名付きレスポンス
5. サーバ：公開鍵で署名検証 → 認証成功
```

### FIDO2のセキュリティ上の利点

| 利点 | 説明 |
|------|------|
| **フィッシング耐性** | サーバのオリジン（ドメイン）に紐づくため、偽サイトでは認証不可 |
| **サーバに秘密情報なし** | サーバは公開鍵のみ保持（漏洩しても安全） |
| **リプレイ攻撃耐性** | チャレンジ/レスポンス方式で毎回異なる値を使用 |
| **中間者攻撃耐性** | TLSチャネルバインディングにより保護 |

### パスキー（Passkey）

- FIDO2/WebAuthnに基づく**パスワードレス認証の統一ブランド名**です
- Apple/Google/Microsoftが共同推進しています
- 秘密鍵をクラウド同期することで**デバイス間の移行**が可能です
- **マルチデバイス対応FIDO認証情報**とも呼ばれます

## NIST SP 800-63（デジタルアイデンティティガイドライン）

### NIST SP 800-63の概要

米国NISTが策定した**デジタル認証に関する包括的ガイドライン**です。日本のデジタル庁のガイドラインにも影響を与えています。

### 3つの保証レベル体系

| 保証レベル | 対象 | 内容 |
|-----------|------|------|
| **IAL（Identity Assurance Level）** | 身元確認 | 本人確認の厳格さのレベル |
| **AAL（Authenticator Assurance Level）** | 認証 | 認証手段の強度レベル |
| **FAL（Federation Assurance Level）** | 連携 | フェデレーション（SSO）の信頼レベル |

### AAL（認証保証レベル）の詳細（試験頻出）

| レベル | 要件 | 認証手段の例 |
|--------|------|------------|
| **AAL1** | 単要素認証 | パスワードのみ、PIN のみ |
| **AAL2** | **多要素認証（2要素以上）** | パスワード + OTP、パスワード + FIDO |
| **AAL3** | **ハードウェアベースの多要素認証** | ハードウェアトークン + 生体認証、FIDO2セキュリティキー |

- AAL2以上では**多要素認証が必須**です
- AAL3では認証器が**暗号モジュール要件（FIPS 140 Level 2以上）**を満たす必要があります
- 政府システムのアクセスにはAAL2以上が推奨されます

### IAL（身元確認保証レベル）

| レベル | 要件 |
|--------|------|
| **IAL1** | 身元確認不要（自己申告） |
| **IAL2** | リモートまたは対面での身元確認（本人確認書類の確認） |
| **IAL3** | 対面での身元確認（高信頼性の本人確認） |

## SSOの実装方式

### SSOの主な実装方式

| 方式 | 説明 | 特徴 |
|------|------|------|
| **エージェント方式** | 各Webサーバにエージェントモジュールを導入 | サーバごとに設定が必要、構成変更時の影響が大きい |
| **リバースプロキシ方式** | 認証プロキシサーバ経由でアクセス | サーバ側の変更不要、プロキシがボトルネックになる可能性 |
| **代理認証方式** | SSOシステムがユーザに代わって各システムにログイン | レガシーシステムとの連携に有効 |
| **フェデレーション方式** | SAML/OIDCによるIdPとSP間の認証連携 | 異なる組織間でのSSO、クラウドサービスとの連携 |
| **Kerberos方式** | チケットベースの認証 | Active Directory環境の標準、社内LAN向け |

### SSOの方式比較

| 方式 | 導入コスト | 既存システム変更 | 適用場面 |
|------|----------|----------------|---------|
| エージェント方式 | 中 | 各サーバに必要 | Web系社内システム |
| リバースプロキシ方式 | 中 | 不要 | Web系社内システム |
| 代理認証方式 | 低 | 不要 | レガシーシステム |
| フェデレーション方式 | 高 | SP側対応必要 | クラウド連携 |
| Kerberos方式 | 低(AD環境) | 不要(AD参加) | Windows環境 |

## 周辺知識

### IEEE 802.1X

ネットワークアクセス制御(NAC)の標準規格です。

構成要素:
- **Supplicant**(クライアント)
- **Authenticator**(スイッチ/アクセスポイント)
- **Authentication Server**(通常 RADIUS)

### EAP(Extensible Authentication Protocol)

802.1X で利用される認証方式の枠組みです。
例: EAP-TLS、PEAP、EAP-TTLS など。

### TACACS+

Cisco中心に利用されるAAAプロトコルです。

特徴:
- **全通信が暗号化されます**
- 管理者操作に強いです
- きめ細かなコマンド権限付与が可能です

### Mutual Authentication(相互認証)

チャレンジレスポンスは **サーバ⇄クライアント双方で行い、相互認証にも応用**されます。

利用例:
- Kerberos
- TLS クライアント証明書

### Zero-Knowledge Proof(ZKP: ゼロ知識証明)

チャレンジレスポンスを高度化した概念です。

目的:
**自分の秘密を明かさずに、自分が秘密を知っていることだけを証明します。**

応用例:
- 新しい認証プロトコル(例えば SRP)
- ブロックチェーン技術内での証明手法

### FIDO認証とパスワードレス

- FIDO2/WebAuthn
- 生体認証 + 公開鍵暗号
- フィッシング耐性が高いです

## まとめ表（横断比較・出題頻度）

### 認証方式の総合比較

| 認証方式 | 認証要素 | セキュリティ強度 | フィッシング耐性 | 利便性 | 主な用途 |
|---------|---------|---------------|----------------|-------|---------|
| パスワード認証 | 知識 | 低 | 低 | 高 | 一般的なログイン |
| チャレンジレスポンス | 知識 | 中 | 中 | 中 | ネットワーク認証 |
| OTP（TOTP/HOTP） | 所持 | 中 | 低〜中 | 中 | 二要素認証の第2要素 |
| マトリクスコード | 所持 | 中 | 中 | 中 | インターネットバンキング |
| ICカード認証 | 所持 | 高 | 高 | 中 | 企業内認証、マイナンバーカード |
| 生体認証 | 生体 | 高 | 高 | 高 | スマートフォン、入退室管理 |
| FIDO2/WebAuthn | 所持+生体 | 最高 | 最高 | 高 | パスワードレス認証 |
| Kerberos | 知識→チケット | 高 | 中 | 高(SSO) | Active Directory環境 |
| クライアント証明書 | 所持 | 高 | 高 | 低（導入負荷） | VPN、企業内システム |

### アクセス制御モデル比較

| モデル | 正式名称 | アクセス権決定者 | 特徴 | 適用例 |
|-------|---------|---------------|------|-------|
| DAC | 任意アクセス制御 | リソース所有者 | 柔軟だがトロイの木馬に脆弱 | UNIX/Windows標準ファイル権限 |
| MAC | 強制アクセス制御 | システム（セキュリティポリシー） | 厳格、ラベルベース | 軍事・政府機関 |
| RBAC | ロールベースアクセス制御 | 管理者（役割定義） | 職務に基づく権限管理 | 企業システム全般 |
| ABAC | 属性ベースアクセス制御 | ポリシーエンジン（属性評価） | 動的・きめ細かい制御 | クラウド環境、ゼロトラスト |

### セキュリティモデル比較

| モデル | 保護対象 | 基本ルール | 目的 |
|-------|---------|----------|------|
| Bell-LaPadula | 機密性 | No Read Up / No Write Down | 情報の上方流出防止 |
| Biba | 完全性 | No Read Down / No Write Up | 情報の下方汚染防止 |
| Clark-Wilson | 完全性 | 整合性制約 + 職務分離 | 商用環境のデータ完全性保証 |
| Chinese Wall | 機密性 + 利益相反防止 | 利益相反クラス間のアクセス禁止 | コンサルティング・金融業 |

### 認証プロトコル比較（RADIUS / DIAMETER / Kerberos / TACACS+）

| 項目 | RADIUS | DIAMETER | Kerberos | TACACS+ |
|------|--------|----------|----------|---------|
| トランスポート | UDP | TCP/SCTP | TCP/UDP | TCP |
| 暗号化 | パスワードのみ | IPsec/TLS | チケット暗号化 | 全通信暗号化 |
| 認証と認可 | 一体 | 分離可能 | チケットベース | 完全分離 |
| 主な用途 | ISP、VPN、無線LAN | モバイル(LTE/5G) | AD環境SSO | ネットワーク機器管理 |
| 標準化 | RFC 2865 | RFC 6733 | RFC 4120 | Cisco独自拡張 |
| スケーラビリティ | 中 | 高 | 中 | 低〜中 |
| フェイルオーバー | △（手動） | ○（標準対応） | ○（冗長KDC） | △ |

### 認証要素の3分類

| 認証要素 | 説明 | 具体例 | 長所 | 短所 |
|---------|------|-------|------|------|
| 知識（Something you know） | 本人だけが知っている情報 | パスワード、PIN、秘密の質問 | 導入容易、コスト低 | 漏洩・推測・忘失リスク |
| 所持（Something you have） | 本人だけが持っている物 | ICカード、トークン、スマートフォン | 知識より強固 | 紛失・盗難・複製リスク |
| 生体（Something you are） | 本人の身体的・行動的特徴 | 指紋、虹彩、静脈、顔、声紋 | 忘失・紛失なし | 変更不可、誤認識、プライバシー |

### 多要素認証（MFA）の組み合わせパターン

| パターン | 要素の組み合わせ | 具体例 | セキュリティ強度 |
|---------|---------------|-------|---------------|
| 知識 + 所持 | パスワード + OTPトークン | インターネットバンキング | 高 |
| 知識 + 生体 | パスワード + 指紋 | スマートフォンアプリ | 高 |
| 所持 + 生体 | ICカード + 指紋 | 入退室管理 | 非常に高 |
| 知識 + 所持 + 生体 | パスワード + カード + 指紋 | 高セキュリティ区画 | 最高 |

※ 同一要素の組み合わせ（パスワード + PIN）は **多要素認証ではない**（二段階認証に分類）

### 生体認証方式の比較

| 方式 | 認証精度 | 偽造耐性 | ユーザ受容性 | 導入コスト | 特記事項 |
|------|---------|---------|------------|----------|---------|
| 指紋認証 | 高 | 中 | 高 | 低 | 最も普及、スマートフォン標準搭載 |
| 静脈認証 | 非常に高 | 高 | 高 | 中 | 体内情報のため偽造困難 |
| 虹彩認証 | 最高 | 高 | 中 | 高 | 双子でも識別可能 |
| 顔認証 | 中〜高 | 中 | 高 | 低〜中 | マスク・照明で精度低下 |
| 声紋認証 | 中 | 低 | 高 | 低 | 体調・環境で変動 |
| 署名認証 | 中 | 中 | 高 | 低 | 行動的特徴、筆圧も含む |

### OTP方式の比較

| 方式 | 仕組み | 同期方法 | メリット | デメリット |
|------|-------|---------|---------|----------|
| 時刻同期方式（TOTP） | 現在時刻 + 共有秘密鍵からOTP生成 | 時刻 | 実装が容易、広く普及 | サーバ・クライアント間の時刻同期が必要 |
| カウンタ同期方式（HOTP） | カウンタ値 + 共有秘密鍵からOTP生成 | カウンタ | 時刻同期不要 | カウンタずれ時の再同期が必要 |
| チャレンジレスポンス方式 | サーバ送信のチャレンジに応答 | なし（都度） | リプレイ攻撃に強い | 通信が必要 |
| S/Key | ハッシュチェーンを逆順に使用 | カウンタ | サーバ側に秘密不要 | 使い切り、再初期化が必要 |
| マトリクス方式 | 乱数表の指定位置から読取 | 表の共有 | オフラインで利用可能 | 表の紛失・コピーリスク |

### SSO方式の比較

| 方式 | 仕組み | 導入コスト | 既存システム変更 | 適用場面 | 注意点 |
|------|-------|----------|----------------|---------|-------|
| エージェント方式 | 各Webサーバにエージェント導入 | 中 | 各サーバに必要 | Web系社内システム | サーバごとの導入・管理負荷 |
| リバースプロキシ方式 | 認証プロキシ経由でアクセス | 中 | 不要 | Web系社内システム | プロキシがSPOF・ボトルネック |
| 代理認証方式 | SSOシステムが代理ログイン | 低 | 不要 | レガシーシステム | パスワード一元管理が必要 |
| フェデレーション方式 | SAML/OIDCでIdP-SP間連携 | 高 | SP側対応必要 | クラウド連携、組織間SSO | 標準プロトコル対応が前提 |
| Kerberos方式 | チケットベース認証 | 低(AD環境) | 不要(AD参加) | Windows環境 | Kerberos対応が必要 |

### OAuth 2.0 / OpenID Connect / SAML 比較

| 項目 | OAuth 2.0 | OpenID Connect | SAML 2.0 |
|------|----------|---------------|----------|
| 目的 | 認可（リソースアクセス委譲） | 認証 + 認可 | 認証（SSO） |
| トークン形式 | アクセストークン | IDトークン（JWT） + アクセストークン | SAMLアサーション（XML） |
| プロトコル | HTTP/REST | HTTP/REST | HTTP/SOAP/XML |
| 主な用途 | API認可、SNS連携 | Webアプリ認証、SSO | 企業SSO、フェデレーション |
| フロー | 認可コードフロー等4種 | 認可コードフロー | SP-initiated / IdP-initiated |
| セキュリティ | PKCE、state、nonce | OAuth 2.0ベース + ID検証 | XML署名、暗号化 |
| モバイル対応 | ○（ネイティブ対応） | ○（ネイティブ対応） | △（XML処理が重い） |

### NIST SP 800-63 認証保証レベル（AAL）比較

| レベル | 認証要素 | 認証強度 | 具体例 | 適用場面 |
|-------|---------|---------|-------|---------|
| AAL1 | 単一要素 | 低 | パスワードのみ | 一般Webサービス |
| AAL2 | 多要素認証 | 中 | パスワード + OTP/FIDO | 行政サービス、金融 |
| AAL3 | 多要素 + ハードウェア暗号モジュール | 高 | FIDO2ハードウェアキー | 高セキュリティ環境 |

### 3Dセキュアのバージョン比較

| 項目 | 3Dセキュア 1.0 | 3Dセキュア 2.0（EMV 3DS） |
|------|--------------|------------------------|
| 認証方式 | 固定パスワード | リスクベース認証 + ワンタイムパスワード |
| ユーザ体験 | 毎回パスワード入力（離脱率高） | リスク低ければ認証省略（フリクションレス） |
| デバイス情報 | 未使用 | デバイス情報・行動履歴を分析 |
| モバイル対応 | △ | ○（SDK提供） |
| 加盟店影響 | チャージバック免除 | チャージバック免除（条件緩和） |
| 導入状況 | 2022年10月終了 | 現行標準（EMVCo管理） |

### パスワード攻撃手法の分類

| 攻撃手法 | 概要 | 対象 | 対策 |
|---------|------|------|------|
| ブルートフォース攻撃 | 総当たりで試行 | 特定アカウント | アカウントロックアウト、長いパスワード |
| 辞書攻撃 | 辞書の単語を順に試行 | 特定アカウント | 辞書にない複雑なパスワード |
| パスワードリスト攻撃 | 漏洩リストを別サービスで試行 | 複数サービス | パスワードの使い回し禁止 |
| リバースブルートフォース | 固定パスワードで複数IDを試行 | 複数アカウント | 一般的なパスワードの禁止 |
| パスワードスプレー | 少数パスワードで多数IDに低速試行 | 複数アカウント | ログ監視、異常検知 |
| レインボーテーブル攻撃 | 事前計算済みハッシュで逆引き | ハッシュDB | ソルト付きハッシュ |
| クレデンシャルスタッフィング | 大量の漏洩認証情報を自動試行 | 複数サービス | MFA、CAPTCHA、WAF |

### パスワード保存方式の比較

| 方式 | 仕組み | 特徴 | 推奨度 |
|------|-------|------|-------|
| 平文保存 | パスワードをそのまま保存 | 漏洩時に即座に悪用される | × |
| 単純ハッシュ | SHA-256等でハッシュ化 | レインボーテーブル攻撃に脆弱 | △ |
| ソルト + ハッシュ | ユーザ固有の乱数を付加してハッシュ | レインボーテーブル無効化 | ○ |
| ストレッチング | ハッシュを数千〜数万回繰り返し | 総当たりの計算コスト増大 | ○ |
| bcrypt | Blowfishベース、コスト調整可能 | 時間経過に応じた強度調整が容易 | ◎ |
| scrypt | メモリハード関数 | GPU/ASIC攻撃への耐性 | ◎ |
| Argon2 | Password Hashing Competition優勝 | メモリ・CPU・並列度を調整可能 | ◎（最推奨） |
| ペッパー | サーバ側の秘密鍵を追加付与 | DB漏洩だけでは解読不可 | ソルトと併用 |

### 出題テーマ別の試験対策重要度

| テーマ | 午前II | 午後I・II | 頻出キーワード |
|-------|--------|----------|-------------|
| 認証方式全般（知識/所持/生体） | ★★★ | ★★ | 多要素認証、認証要素の分類 |
| チャレンジレスポンス方式 | ★★★ | ★★ | ハッシュ関数、リプレイ攻撃防止 |
| OTP（TOTP/HOTP/S/Key） | ★★ | ★ | 時刻同期、カウンタ同期、ハッシュチェーン |
| RADIUS / IEEE 802.1X | ★★★ | ★★★ | EAP-TLS、PEAP、サプリカント |
| Kerberos認証 | ★★ | ★★ | TGT、KDC、チケット、Golden Ticket |
| OAuth 2.0 / OpenID Connect | ★★★ | ★★★ | 認可コードフロー、PKCE、IDトークン |
| SAML / SSO | ★★★ | ★★★ | IdP、SP、SAMLアサーション、フェデレーション |
| アクセス制御モデル（DAC/MAC/RBAC/ABAC） | ★★★ | ★★ | Bell-LaPadula、Biba、最小権限 |
| FIDO2 / WebAuthn / パスキー | ★★ | ★★ | 公開鍵暗号、フィッシング耐性 |
| 生体認証（FAR/FRR/EER） | ★★ | ★ | 本人拒否率、他人受入率、等価エラー率 |
| パスワード攻撃と保存方式 | ★★ | ★★ | ソルト、ストレッチング、bcrypt/Argon2 |
| 3Dセキュア | ★ | ★★ | リスクベース認証、EMV 3DS |
| リスクベース認証 | ★★ | ★★ | 追加認証、デバイスフィンガープリント |
| NIST SP 800-63 | ★ | ★ | IAL/AAL/FAL、認証保証レベル |
| 多要素認証（MFA） | ★★★ | ★★★ | 二要素vs二段階、認証バイパス攻撃 |
