# 3Dセキュア(3‑Domain Secure)

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報処理安全確保支援士令和2年秋期 午前Ⅱ 問9](https://www.sc-siken.com/kakomon/02_aki/am2_9.html)  

## 1. 3Dセキュア(3‑Domain Secure)とは  

3Dセキュアとは、**オンラインクレジットカード決済時に本人認証を追加する国際標準方式**です。  
不正利用対策のため EMVCo(VISA/Mastercard/JCBなど6社共同体)が標準化しています。  
3Dセキュアでは **3つの“ドメイン(当事者領域)”** が連携します。  

| ドメイン名 | 説明 |
|------------|------|
| **Issuer Domain** | カード発行会社(本人認証を実施) |
| **Acquirer Domain** | 加盟店側(店舗/決済代行) |
| **Interoperability Domain** | 国際ブランドのネットワーク(VISA Directory Server など) |

この「3ドメイン」が協力して不正利用を防ぐ仕組みを **3D Secure** といいます。  

## 2. 3Dセキュアの目的  

- **カード情報盗用による不正決済の防止**  
- **カード所有者が正しい本人であることを確認(Cardholder Authentication)**  
- **加盟店のチャージバックリスク低減**  

## 3. 3Dセキュアのバージョン

### ■ 3D Secure 1.0

- パスワード(固定パスワード)による認証が中心  
- 認証画面がポップアップ方式で UX が悪い  
- スマホ時代に対応しきれず廃止傾向  
- フィッシングや成り済ましに弱い  

### ■ 3D Secure 2.0(現行方式：EMV 3DS)

* **EMVCo が正式に仕様策定。セキュリティも利便性も大幅に向上。**  

特徴：  

- **リスクベース認証(RBA)**  
  → 高リスクのみ追加認証。  
- **ワンタイムパスワード(OTP)認証対応**  
- **生体認証(指紋/顔認証)対応**  
- **アプリ内決済/スマホ決済に完全対応**  
- **加盟店が送信するリスク情報(約100項目)で本人性を評価**  

## 4. 3Dセキュアの認証プロセス(3DS 2.x)

オンライン決済時の簡易フロー：  

1. **加盟店が決済情報＋デバイス情報を Directory Server(ブランド)へ送信**  
2. Directory Server がカード発行会社(Issuer)へ問い合わせ  
3. Issuer がリスク判定  
4. **低リスク → Frictionless Flow(認証省略)**  
5. **高リスク → 認証を要求(OTP/生体等)**  
6. 認証成功後、決済を許可  

## 5. Frictionless Flow(認証省略型)とは  

カード発行会社は加盟店から送られてくる次の情報でリスクを判定します。  

**本人性が十分高いと判断されれば認証操作なしで決済が完了します。**  
これにより、UX が改善され、決済離脱率が大幅に減少しました。  

- 端末情報(OS/ブラウザ)  
- 端末の指紋情報(Device Fingerprint)  
- 過去の取引履歴  
- 取引金額  
- 購入商品カテゴリ  
- 加盟店情報  

## 6. 3Dセキュアで使用される認証方式  

3Dセキュア2は複数の認証手段をサポートします。  

| 認証方式 | 説明 |
|----------|------|
| **OTP(ワンタイムパスワード)** | SMS/メール/アプリで発行 |
| **デバイス認証** | デバイス指紋/端末識別 |
| **生体認証** | 指紋認証/顔認証 |
| **Push 認証** | 銀行アプリ等の通知で認証 |
| **従来パスワード(1.0 方式)** | 互換性目的で一部残存 |

## 7. セキュリティ強化ポイント(3DS 2.x)

#### ■ リスクベース認証(RBA)

怪しい取引のみ認証を要求します。  

#### ■ 動的認証(Dynamic Authentication)

固定パスワードではなく、OTP や生体情報で認証します。  

#### ■ MITM/フィッシング耐性の向上

- 認証処理は **Issuer App/Issuer Server** が担当  
- 加盟店側でパスワードを扱わない  

## 8. 周辺知識

### 8.1 クレジットカード情報の非保持化

PCI DSS に基づき、加盟店はカード番号を保持しない運用が一般化されています。  

### 8.2 トークナイゼーション

カード番号を安全な **トークン** に置換する方式です。  

### 8.3 EMV(ICチップ)決済

- 3Dセキュアは「オンライン本人認証」  
- EMVはカード IC の「決済情報の改ざん耐性」の強化  

### 8.4 CVC/CVV

カード裏面のセキュリティコードです。  
3Dセキュアと組み合わせて本人性を強化しています。  

### 8.5 不正検知システム(Fraud Detection System)

AI/機械学習で不正利用パターンを分析しています。  
