# ARPとRARP

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報セキュリティスペシャリスト平成23年秋期 午前Ⅱ 問19](https://www.sc-siken.com/kakomon/23_aki/am2_19.html)  

## ARPとRARP

ARP(Address Resolution Protocol)およびRARP(Reverse Address Resolution Protocol)は、**IPアドレスとMACアドレスの対応関係を解決するためのプロトコル**です。  

これらは TCP/IP ネットワークにおけるL2–L3間の重要な橋渡しを担い、ネットワークの基本理解だけでなくセキュリティ試験でも頻出のテーマです。  

## 2. ARP(Address Resolution Protocol)

### ■ 概要(エビデンス：RFC 826)

ARP は **IPアドレス → MACアドレス** を解決するプロトコルで、同一ネットワーク内で通信する際に必須となります。  

### ■ ARPが必要となる理由

イーサネットでの通信は最終的に **MACアドレス宛て** にフレームを送信するため、IPアドレス宛ての通信であっても、宛先MACアドレスが分からなければ通信できません。

### ■ ARPリクエスト/リプライ

| 種類 | 説明 |
|------|------|
| **ARP Request** | ブロードキャストで「このIPの持ち主は誰？」と質問する |
| **ARP Reply** | 対応するMACアドレスをユニキャストで返信 |

### ■ ARPテーブル

その結果は ARP キャッシュとして一定時間 OS に保存されます。  
キャッシュの保持期間は OS によって異なります。  

## 3. ARPのセキュリティ問題

ARP は非常に単純で、**認証機能が存在しない**ため、攻撃に悪用されます。  

### ● ARPスプーフィング(ARP Poisoning)

攻撃者が「私はこのIPのMACアドレスです」と偽ARP返信を送ることで被害者の ARP テーブルを書き換える攻撃です。  

これにより、下記などが可能となります。

- MITM(中間者攻撃)  
- パケット盗聴  
- セッションハイジャック  

### ■ 対策

- 静的ARP設定(小規模ネットワーク向け)  
- DHCP Snooping + Dynamic ARP Inspection(スイッチ機能)  
- ポートセキュリティ  
- IPS/IDS による異常ARP検知  

## 4. RARP(Reverse ARP)

### ■ 概要(エビデンス：RFC 903)

RARP は、ARP の逆で **MACアドレス → IPアドレス** を解決するプロトコルです。  

### ■ RARP が使われていた目的

IPアドレスを持たないディスクレス端末(昔のWS)などが**自分のMACアドレスを送信し、RARPサーバからIPアドレスを配布してもらう**用途に利用されました。  

## 5. RARPが使われなくなった理由

RARP には構造的な制約があり、現在では **BOOTP → DHCP が主流**です。  

### ■ RARP の欠点

- 返せる情報が **IPアドレスだけ**  
- L2で動作するため **ルータを越えられない**  
- 柔軟性が低く拡張不可  

### ■ 代替技術

| 技術 | 説明 |
|------|------|
| **BOOTP(RFC 951)** | IPに加えサブネットマスクなども提供可能 |
| **DHCP(RFC 2131)** | 動的割り当て、高い拡張性、現在の標準 |

## 6. ARP/RARPに関連する周辺知識

### ■ 1. GARP(Gratuitous ARP)

自分自身のARP情報をネットワークに通知するARPのことです。  

用途：  

- IPアドレス重複検知  
- VRRP/HSRP での仮想IP切替通知  

### ■ 2. Proxy ARP

ルータが別ネットワークの端末の代わりにARP応答を返す技術です。  
セキュリティ上推奨されません。  

### ■ 3. NDP(Neighbor Discovery Protocol)

IPv6 では ARP に相当するのは NDP(RFC 4861)です。  
ICMPv6 を利用している点が大きな特徴です。  

### ■ 4. DHCP

IPアドレスを自動割り当てする仕組みです。  
ステートレス/ステートフル機能があり、IPv6 DHCPv6 と組み合わせることもある。  

### ■ 5. VLANとARPの関係

ARPはブロードキャストであるため、**VLAN境界を越えることはない**(L2セグメント内で完結)です。
