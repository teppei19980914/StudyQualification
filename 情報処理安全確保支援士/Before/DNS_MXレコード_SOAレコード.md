# DNS/MXレコード/SOAレコード

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報セキュリティスペシャリスト平成27年秋期 午前Ⅱ 問18](https://www.sc-siken.com/kakomon/27_aki/am2_18.html)  

## DNS(Domain Name System)とは

### DNSの役割(RFC 1034/RFC 1035)

DNSは、**ドメイン名とIPアドレスなどの各種情報を対応付ける分散型データベースシステム**です。  

主な役割：  

- ドメイン名 → IPアドレス(A/AAAA)
- メール配送先の決定(MX)
- 権威情報/管理情報の提供(SOA)
- 各種サービス情報の提供(TXT, SRV 等)

DNSは **階層構造(ルート → TLD → 権威DNS)** を持つ分散管理方式です。

## MXレコード(Mail Exchanger Record)

### 定義と目的(RFC 5321/RFC 1035)

**MXレコード**は、**そのドメイン宛の電子メールをどのメールサーバに配送するかを指定するDNSレコード**です。  
つまり、「このドメインのメールは、どのサーバが受信担当か」を示す役割を持ちます。  

### 3.2 MXレコードの構造

例：  

```
example.com. MX 10 mail1.example.com.
example.com. MX 20 mail2.example.com.
```


構成要素：  

| 要素 | 意味 |
|---|---|
| 優先度(Preference) | 数値が小さいほど優先 |
| メールサーバ名 | 実際にメールを受信するホスト名 |

### 優先度(Preference)の意味

- 数値が **小さい方が優先**
- 第一サーバ障害時に、第二/第三サーバへフォールバック

例：  

- `10` → プライマリ
- `20` → バックアップ

### 試験での重要ポイント(MX)

- **MXレコードは「メール配送経路」を制御**
- IPアドレスは直接書かない(A/AAAAで解決)
- SMTPサーバは **MXレコードを参照して配送先を決定**

→ 「メールサーバ自身が参照する」のではなく、**送信側SMTPサーバがDNSを引く**点が頻出の引っかけです。  

## SOAレコード(Start of Authority Record)

### 定義(RFC 1035)

**SOAレコード**は、**そのDNSゾーンに関する「管理情報の起点」を示すレコード**です。  
つまり、「このゾーンの責任者は誰か」「ゾーン情報はどのように管理されているか」を定義しています。  

### SOAレコードの構造

例：  

```
example.com. SOA ns1.example.com. admin.example.com. (
2024010101 ; Serial
3600 ; Refresh
900 ; Retry
604800 ; Expire
86400 ; Minimum
)
```

### 各フィールドの意味

| フィールド | 意味 |
|---|---|
| MNAME | プライマリDNSサーバ |
| RNAME | 管理者メールアドレス(@は.で表記) |
| Serial | ゾーンファイルの版数 |
| Refresh | セカンダリDNSが更新確認する間隔 |
| Retry | 再試行間隔 |
| Expire | ゾーン情報の有効期限 |
| Minimum | ネガティブキャッシュTTL |

### 試験で特に問われる点(SOA)

- **Serial番号が更新管理の要**
- セカンダリDNSは **Serialの増加で変更を検知**
- SOAは **ゾーンごとに必ず1つ存在**

→ 「SOAは名前解決用」ではなく、**DNS運用/同期管理用レコード**です。

## MXレコードとSOAレコードの違い(整理)

| 観点 | MX | SOA |
|---|---|---|
| 主目的 | メール配送制御 | ゾーン管理 |
| 参照主体 | 送信SMTP | DNSサーバ |
| 設定数 | 複数可 | 原則1つ |
| 試験頻度 | 高 | 非常に高 |

## DNSの主なレコード

### A/AAAAレコード

- A：IPv4アドレス
- AAAA：IPv6アドレス

### NSレコード

- ゾーンを管理する権威DNSサーバを指定

### CNAMEレコード

- 別名(エイリアス)定義
- MXの参照先には **CNAMEは不可(RFC制約)**

### TXTレコード

- 任意文字列
- SPF/DKIM/DMARC で利用

### PTRレコード

- IP → ドメイン名(逆引きDNS)
- メールのスパム対策で重要

## セキュリティ観点の補足

- **MX誤設定**  
  → メール不達/スパム対策失敗
- **SOA Serial未更新**  
  → DNS変更が反映されない
- **DNS自体は改ざん対策が弱い**  
  → DNSSECで補完
