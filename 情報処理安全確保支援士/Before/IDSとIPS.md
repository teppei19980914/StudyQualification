# IDSとIPS

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報処理安全確保支援士令和5年春期 午前Ⅱ 問12](https://www.sc-siken.com/kakomon/05_haru/am2_12.html)  

## IDS(Intrusion Detection System)

ネットワークやホストに対する不正行為を検知する仕組みです。  

### IDSの種類

NIDS(Network IDS)：ネットワーク全体を監視  
HIDS(Host IDS)：ホスト内部のログ/ファイル改ざんを監視  

## IPS(Intrusion Prevention System)

ネットワークやホストに対する不正行為を検知し、リアルタイムで防御する仕組みです。  

### IDSとIPSとの違い

|項目|IDS|IPS|
|:----|:----|:----|
|主目的|検知|検知＋防御|
|動作|パッシブ|インライン（通信経路上）|
|誤検知時|アラートのみ|通信遮断のリスク|

### シグネチャ型IPS(Signature-based IPS)

既知の攻撃パターン(シグネチャ)と一致するネットワークトラフィックを検知/遮断する方式です。  

#### シグネチャ型IPSの特徴

##### 長所

1. 既知攻撃に対して高精度(誤検知が少ない)  
2. 明確な攻撃パターンを確実にブロックできる  
3. 運用しやすい(シグネチャ更新で対策可能)  

##### 短所

1. 未知攻撃(ゼロデイ)には弱い  
2. シグネチャ更新が遅いと防げない  
3. 高度に難読化・変形された攻撃を見逃す可能性  

### アノマリ型IPS

正常な通信パターンを基準として学習し、その基準から逸脱(アノマリ：異常)した通信を不正として検知/遮断する方式です。  

#### アノマリ型IPS

##### 長所

1. 未知攻撃(ゼロデイ)に強い  
2. 攻撃の変形/難読化にも強い  
3. 内部不正や標的型攻撃に強い  

##### 短所

1. 誤検知(False Positive)が多い  
2. 運用不可が高い  
3. 学習期間が必要  

#### シグネチャ型IPSとアノマリ型IPSの違い

|種類|概要|長所|短所|
|:----|:----|:----|:----|
|シグネチャ型|既知攻撃パターン照合|精度高い|ゼロデイに弱い|
|アノマリ（異常検知）型|正常パターンからの逸脱を検知|未知攻撃に強い|誤検知が多い|
|ハイブリッド型|両方組み合わせ|バランス良|実装が複雑|

### IPSが遮断する攻撃例

* SQLインジェクション  
* XSS  
* 既知マルウェアのC2通信  
* スキャン(Nmap, Masscan)  
* シェルコード(RCE攻撃)  
* サーバ攻撃(Apache/PHP脆弱性)  
* コマンドインジェクション  
* 暗号化通信内でのスキャン  
* Dosのシグネチャ攻撃

## 周辺知識

### UTM(統合脅威管理)

FW/IPS/アンチウィルス/SPAM対策を統合したもので、中小企業向けです。  

### SIEM(Security Information and Event Management)

ログを統合収集し、AI/相関分析で権威を検出します。  
SOCで利用されるツールです。  

### ゼロトラストとの関係性

IPS/IDSはゼロトラストの継続的監視を支える技術でもあります。  

### IPSと比較される技術(EDR/XDR/NDR)

|種類|監視対象|
|:----|:----|
|EDR|エンドポイント|
|NDR|ネットワーク通信（IPSと類似）|
|XDR|それらを統合|
