# IEEE 802.1X と EAP-TLS

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報セキュリティスペシャリスト平成27年春期 午前Ⅱ 問2](https://www.sc-siken.com/kakomon/27_haru/am2_2.html)  

## IEEE 802.1X とは  

IEEE 802.1X は、**ネットワークへの不正接続を防ぐためのポートベース認証方式**です。  

#### 役割(IEEE 802.1X の中心機能)

- 有線 LAN/無線 LAN の物理または論理ポートに対して「認証済み端末だけをネットワークに入れる」アクセス制御を提供します。  

#### 3つの構成要素  

IEEE 802.1X は以下の 3 つから構成されます。  

| 要素 | 役割 |
|------|------|
| **Supplicant(サプリカント)** | 認証を受ける端末(PC/スマホ等) |
| **Authenticator(オーセンティケータ)** | スイッチ/無線AP(認証要求を中継) |
| **Authentication Server** | RADIUS サーバ(認証判断を行う) |

## 802.1X 認証フロー  

IEEE 802.1X では、Authenticator は端末を即座にネットワークへ通さず、**認証フェーズ成功後にポートを開放**します。  

#### 認証の流れ

このフローにより、**未認証端末の通信遮断/なりすまし防止**が可能です。  

1. Supplicant がネットワークに接続  
2. Authenticator が端末に EAP-Request を送信  
3. Supplicant と Authentication Server が EAP により認証処理  
4. 認証成功 → Authenticator がポートを「Authorized」に変更  
5. 通信開始  

## EAP(Extensible Authentication Protocol)とは  

EAP は RFC 3748 で定義される **拡張認証プロトコル**であり、認証方式(パスワード、証明書、トークンなど)を柔軟に統合できる仕組みです。  

頻出の EAP 認証方式：  

| EAP方式 | 特徴 |
|----------|------|
| **EAP-TLS** | クライアント証明書による最も強固な相互認証 |
| PEAP | TLS トンネル内でユーザ名/パスワードをやり取り |
| EAP-TTLS | サーバ証明書のみ必須、内部で認証方式を選択 |

## EAP-TLS(RFC 5216)とは  

EAP-TLS は **クライアント証明書とサーバ証明書の双方を用いる強固な相互認証方式**です。  
RFC 5216 によって標準化されています。  

#### EAP-TLS の特徴

- **公開鍵基盤(PKI)を使用した相互認証**  
- クライアント側にも証明書が必要  
- パスワード依存がないため、フィッシング/リプレイ攻撃に強い  
- WPA2-Enterprise/WPA3-Enterprise の標準方式  

## EAP-TLS の認証フロー(TLS Handshake 利用)

```
Supplicant ⇔ Authenticator ⇔ RADIUS(Server)
      |------ TLS ClientHello -------------------->|
      |<----- TLS ServerHello + Cert --------------|
      |------ Client Certificate + Verify -------->|
      |------ TLS Finished ------------------------>|
認証成功 → Authenticator がポート開放
```

#### 特徴まとめ

- 証明書により端末の真正性を保証  
- TLS により盗聴/改ざん/リプレイを防止  
- 最も安全な 802.1X 認証方式として推奨  

## 802.1X/EAP-TLS が有効な理由

| 攻撃 | EAP-TLS が防ぐ理由 |
|------|---------------------|
| パスワード盗難 | パスワードを使わない |
| なりすまし | クライアント証明書で端末識別 |
| リプレイ攻撃 | TLS の nonce/session key により無効化 |
| 中間者攻撃 | サーバ証明書検証により防止 |

## EAPがサポートする主な認証方式

|名称|概要|
|:----|:----|
|EAP-TLS|デジタル証明書によるサーバ/クライアントの相互認証。クライアント側にはデジタル証明書を組み込んだUSBキーやICカードがよく用いられる。|
|EAP-TTLS|TLSの仕組みでサーバを認証後、TLSのセキュアな伝送路上で様々な方法を用いてクライアントを認証する。|
|PEAP|TLSの仕組みでサーバを認証後、TLSのセキュアな伝送路上でID/パスワードによるクライアント認証をする。|
|EAP-MD5|チャレンジレスポンスでクライアントのみ認証|
|EAP-FAST|米シスコシステムズ社が開発した規格で、TTLSとほぼ同じ仕組み。セキュアな伝送路の確立に証明書ではなく、DH鍵交換を用いるむ認証モードがある。|

## よく比較される方式

| 認証方式 | 安全性 | 特徴 |
|----------|--------|-------|
| **EAP-TLS** | ★★★★★ | 相互認証、PKI利用、最強 |
| PEAP/EAP-TTLS | ★★★★☆ | TLS トンネル内でパスワード認証 |
| EAP-MD5 | ★☆☆☆☆ | パスワード認証のみ、安全性低い |

## 周辺知識

### RADIUS(Remote Authentication Dial-In User Service)

- IEEE 802.1X で使われる認証プロトコル  
- UDP 1812(認証)、1813(アカウンティング)  

### PKI(Public Key Infrastructure)

- 証明書の発行/失効管理  
- EAP-TLS ではクライアント証明書が必須  
- CRL/OCSP による失効確認  

### WPA2-Enterprise/WPA3-Enterprise  

- 無線 LAN で 802.1X + EAP を採用  
- 企業ネットワークで一般的  

### Supplicant ソフト例  

- Windows ネイティブ 802.1X クライアント  
- wpa_supplicant(Linux)  
- Cisco AnyConnect NAM  
