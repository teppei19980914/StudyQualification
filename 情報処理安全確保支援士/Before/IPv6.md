# IPv6

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報処理安全確保支援士令和4年秋期 午前Ⅱ 問18](https://www.sc-siken.com/kakomon/04_aki/am2_18.html)  

## 1. IPv6 とは  

IPv6(Internet Protocol version 6)は **IPv4 の後継規格として IETF が策定した次世代 IP プロトコル(RFC 8200)**であり、アドレス枯渇の解消とプロトコルの簡素化が目的です。  

## 2. IPv6 の主要特徴(RFC 8200)

### ■ 2.1 128bit の巨大アドレス空間  

IPv4(32bit：約 43 億)に対し、IPv6 は **128bit(約 3.4×10³⁸)** のアドレス空間を持ちます。  

### ■ 2.2 固定長 40 バイトのシンプルなヘッダ  

- IPv4 のヘッダを簡素化  
- ルータでの高速処理が可能  
- チェックサムは廃止(上位層で実施)  

### ■ 2.3 拡張ヘッダによる柔軟性  

セキュリティ(IPsec)、ルーティング、トンネルなどを追加可能です。  

### ■ 2.4 NAT を前提としない設計  

IPv4 のアドレス不足対策である NAT は想定していません。  
エンドツーエンド通信を復権する思想があります。  

### ■ 2.5 IPsec のサポート

当初 RFC 4294 で IPsec の実装が必須(MUST)とされていましたが、RFC 6434(2011年)により推奨(SHOULD)に緩和されました。  

## 3. IPv6 アドレス表記(RFC 4291)

16bit × 8 ブロックを 16 進数で記述：  

```
2001:0db8:abcd:0012:0000:0000:0000:0001
```

省略ルール：  

- 先頭ゼロ省略：`0001 → 1`  
- 連続ゼロ省略：`::`(1度のみ使用)  

例：  

```
2001:db8:abcd:12::1
```

---

## 4. IPv6 アドレス種別

| 種別 | プレフィックス | 用途 |
|------|----------------|------|
| グローバルユニキャスト | 2000::/3 | 全世界で到達可能 |
| リンクローカル | fe80::/10 | 同一リンク内のみ、全インタフェースに自動設定 |
| ユニークローカル(ULA) | fc00::/7 | 組織内専用(IPv4 プライベート相当) |
| マルチキャスト | ff00::/8 | ブロードキャストの代替 |
| ループバック | ::1 | 自身を指す |

※ ブロードキャストアドレスは **IPv6 には存在しません**。  

## 5. IPv6 の自動設定(SLAAC)

### ■ 5.1 SLAAC(Stateless Address Auto Configuration)

ルータ広告(RA)を用いて **ステートレスにアドレスを自動設定**する方式です。  

### ■ 5.2 Interface ID の生成法

MAC から生成した EUI-64 は追跡されやすいため、**現在はプライバシー拡張が推奨**されます。  

- **EUI-64(MAC アドレスから生成)**  
- **RFC 4941 プライバシーアドレス(ランダム生成)**  

## 6. IPv6 に必須の ICMPv6(RFC 4861)

ICMPv6 は IPv6 ネットワーク制御の中心です。  
以下の重要機能を持ちます。  

- Neighbor Discovery(IPv4 ARP に相当)  
- アドレス重複検出(DAD)  
- ルータ探索(RS/RA)  
- パスMTUディスカバリ(PMTUD)

**ICMPv6 を FW で遮断するとネットワークが正常に動作しない**ため注意が必要です。  

## 7. IPv6 のセキュリティ

### ■ 7.1 IPv6 固有のリスク  

- RA 偽装攻撃(偽ルータによる乗っ取り)  
- DHCPv6 偽装  
- 拡張ヘッダ悪用(FW バイパス)  
- トンネリング(6to4, Teredo)悪用  

### ■ 7.2 対策  

- RA ガード  
- DHCPv6 ガード  
- IPv6 拡張ヘッダ制御  
- 不要な IPv6 機能を無効化  

## 8. IPv4 と IPv6 の比較(試験頻出)

| 項目 | IPv4 | IPv6 |
|------|------|------|
| アドレス長 | 32bit | 128bit |
| NAT | 必須に近い | 不要 |
| ブロードキャスト | あり | 廃止 |
| 自動設定 | DHCP | SLAAC/DHCPv6 |
| セキュリティ | オプション | IPsec 推奨(SHOULD) |
| ICMP | 補助的 | 中核的(ND に不可欠) |

## 9. IPv6 移行技術

| 技術 | 説明 |
|------|------|
| **デュアルスタック** | IPv4/IPv6 の併用(最も一般的) |
| **6to4/ISATAP/Teredo** | IPv6 を IPv4 トンネル内で運ぶ方式 |
| **NAT64/DNS64** | IPv6-only 環境から IPv4 サーバへ接続 |
