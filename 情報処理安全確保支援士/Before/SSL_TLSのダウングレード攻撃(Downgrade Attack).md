# SSL/TLSのダウングレード攻撃(Downgrade Attack)

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報処理安全確保支援士平成29年春期 午前Ⅱ 問2](https://www.sc-siken.com/kakomon/29_haru/am2_2.html)  

## SSL/TLSのダウングレード攻撃とは(定義)

### 定義(エビデンス)

**SSL/TLSのダウングレード攻撃**とは、クライアントとサーバ間のTLS通信において、攻撃者が通信を妨害/改変することで、本来使用可能な新しいTLSバージョンや強力な暗号方式ではなく、脆弱な旧バージョン/弱い暗号方式を強制的に使用させる攻撃です。  

## SSL/TLSの前提知識(必須)

### バージョンネゴシエーションの仕組み

TLS通信は、以下の流れで開始されます。  

1. **ClientHello**
   - クライアントが対応可能なTLSバージョン一覧を提示
   - 利用可能な暗号スイートを提示
2. **ServerHello**
   - サーバが採用するTLSバージョンと暗号方式を選択

→ **双方が対応している中で、最も高い共通レベルが選ばれる**

### 下位互換性という設計思想

- 古いクライアントでも接続できるように
- SSL 3.0/TLS 1.0/TLS 1.1 を残している環境が多かった

→ この「互換性」が攻撃の起点になる

## ダウングレード攻撃の基本原理

### 攻撃の本質

攻撃者は、下記の点が重要です。  

- 通信内容を解読する必要はない
- **ハンドシェイクを妨害/失敗させるだけでよい**

### 典型的な攻撃シナリオ

1. クライアントが TLS 1.2/1.3 を提案
2. 攻撃者が通信を妨害(パケット破棄/改変)
3. 接続失敗と誤認させる
4. クライアントが **古いTLS/SSLで再接続**
5. サーバがそれを受け入れる
6. **弱い暗号通信が成立**

## なぜ危険なのか

ダウングレード攻撃が危険な理由は、次のとおりです。  
**攻撃者が「脆弱性を新たに作る」のではなく、すでに存在する脆弱な仕様を“使わせる”点にある**

### 利用される代表的な脆弱プロトコル

| プロトコル | 問題点 |
|---|---|
| SSL 2.0 | 設計的に破綻(使用禁止) |
| SSL 3.0 | POODLE 攻撃 |
| TLS 1.0 | BEAST 攻撃 |
| 弱い暗号 | RC4, EXPORT 暗号 |

## 代表的なダウングレード攻撃の実例

### POODLE攻撃(SSL 3.0)

- SSL 3.0 のパディング処理の欠陥を悪用
- ダウングレードにより SSL 3.0 を使わせる
- Cookie 情報などが漏洩

### FREAK攻撃(EXPORT暗号)

- 米国の旧輸出規制向け弱暗号を利用
- 鍵長が極端に短く、現実的に解読可能

### Logjam攻撃

- 弱い Diffie-Hellman パラメータを強制
- 中間者攻撃が可能

## 主な対策(頻出)

### 古いプロトコルの無効化

- SSL 2.0/3.0 を完全に無効
- TLS 1.0/1.1 も非推奨

### TLS_FALLBACK_SCSV(RFC 7507)

- 不正なダウングレードを検知する仕組み
- 意図しない再接続を拒否

### 強力な暗号スイートのみ許可

- EXPORT暗号の禁止
- RC4の禁止
- 安全なAEAD暗号(AES-GCMなど)を使用

### HSTS(HTTP Strict Transport Security)

- HTTPS 強制
- プロトコルダウングレードの抑止

## 関連知識①：中間者攻撃(MITM)との関係

ダウングレード攻撃は、下記のとおりです。  

- **MITM攻撃の一種**
- ただし「盗聴」よりも「弱体化」が目的

## 関連知識②：TLS 1.3 での改善点

TLS 1.3 では：

- 古い暗号/プロトコルを完全排除
- ハンドシェイクが簡素化
- ダウングレード耐性が強化
