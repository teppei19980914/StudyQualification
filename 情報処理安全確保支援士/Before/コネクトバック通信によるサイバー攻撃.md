# コネクトバック通信によるサイバー攻撃

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報処理安全確保支援士令和7年春期 午前Ⅱ 問8](https://www.sc-siken.com/kakomon/07_haru/am2_8.html)  

## サイバー攻撃

ネットワークや情報システムに対して不正な行為を行い、情報のCIA(機密性・完全性・可用性)を損なう行為の総称です。  

### 分類

IPAは、サイバー攻撃を大きく次の4分類で把握していることを求めます。  

1. 初期侵入系  
2. 内部活動  
3. 目的達成  
4. 持続性確保  

#### 初期侵入系

攻撃の最初の入り口に使われる手法です。  

1. マルウェア配布（ウィルス・トロイ・ランサムウェア）  
2. フィッシング/スピアフィッシング  
3. 脆弱性攻撃（SQLi, XSS, RCE, Log4Shell など）  
4. パスワード攻撃（辞書攻撃・総当たり）  
5. 不正な外部デバイス（USB等）  

#### 内部活動

侵入後に攻撃者が行う行為のことです。  

1. バックドア設置（コネクトバック通信など）  
2. 権限昇格（Privilege Escalation）  
3. 内部スキャン（他ホストを調査）  
4. ラテラルムーブメント（横展開）  
5. ログ消去・痕跡隠蔽（Timestomping など）  

#### 目的達成

侵入によって達成しようとする主目的です。  

1. 情報窃取（個人情報・顧客情報・機密データ）  
2. 改ざん（Web改ざん・設定ファイル改ざん）  
3. 破壊（ランサムウェア暗号化）  
4. サービス妨害（DDoS）  
5. 金銭要求（身代金要求）  

#### 持続性確保

長期間にわたり内部に潜伏するための活動です。  

1. C&Cサーバとの継続通信（コネクトバック／Beaconing）  
2. タスク登録・レジストリ改変による永続化  
3. 更新機能付きマルウェア  

### ライフサイクル

1. 偵察（Reconnaissance）  
2. 武器化（Weaponization）  
3. 配送（Delivery）  
4. 悪用（Exploitation）  インストール（Installation）  
5. C&C通信（Command & Control）  
    → コネクトバックはこの段階  
6. 目的実行（Actions on Objectives）  

## コネクトバック通信

マルウェアに感染した内部ネットワークの端末などが、自ら外部の攻撃者のサーバに接続する通信方式です。  
「リバースシェル」や「リバースコネクション」とも呼ばれます。  

### 特徴

通常、企業ネットワークでは下記のようなFWが設定されています。  

外部 → 内部（インバウンド通信）：原則ブロック  
内部 → 外部（アウトバウンド通信）：業務で必要となるため許可  

上記の構成は、外部からの不正アクセスを防ぐことを目的とした境界防御の基本です。  
しかし、コネクトバックは内部から外部の攻撃者サーバにアクセスするため、こうした境界防御をすり抜けてしまうという大きな強みがあります。  

したがって、**そもそもマルウェアに感染しない**ことを前提に、*EDR(Endpoint Detection and Response)* を前提とする必要があります。  

## 周辺知識

|用語|内容|
|:----|:----|
|C&Cサーバ（Command & Control）|攻撃者が遠隔操作するための司令室|
|Beaconing（ビーコン通信）|一定間隔で攻撃者に“生存報告”を送る仕組み（高度なAPT攻撃で多用）|
|ゼロトラスト|「内部は安全」という前提を破壊する思想|
|暗号化されたコネクトバック（HTTPS/DoH）|通信が暗号化されていることで、解析が困難となり、IDS/IPSで内容確認ができない|
|EDR (Endpoint Detection and Response)|各エンドポイント (PC、サーバ等) の挙動を監視|
|ネットワークセグメンテーション|内部ネットワークを複数の論理／物理セグメントに分割|
|プロキシサーバ／Firewall|アウトバウンドを含めた通信の入り口に設置し、不要通信を制限・ログ取得|
|ラテラルムーブメント|一台の侵害からネットワーク内部を横展開し、他ホストやサーバを次々に侵害する動き|

