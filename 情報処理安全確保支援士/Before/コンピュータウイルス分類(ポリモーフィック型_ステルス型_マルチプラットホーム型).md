# コンピュータウイルス分類(ポリモーフィック型/ステルス型/マルチプラットホーム型)

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報セキュリティスペシャリスト平成24年秋期 午前Ⅱ 問7](https://www.sc-siken.com/kakomon/24_aki/am2_7.html)  

## 1. ポリモーフィック型ウイルス(Polymorphic Virus)

### 1.1 定義  

ポリモーフィック型ウイルスとは、**自己複製時に暗号化やコード変形を行い、毎回異なる形に変化するウイルス**です。  
ウイルス本体は暗号化され、複合ルーチンも変形するため、シグネチャ型検知の回避を目的とする。  

根拠：  

- 1990年代以降、暗号化技術を利用したウイルスが登場し “polymorphic engine” として研究対象  
- Symantec セキュリティレポートでも「検知回避技術の代表例」として分類  

### 1.2 特徴  

- 暗号化された本体 + 変形する復号ルーチン  
- シグネチャベースの検知(特定バイト列の検知)を無効化  
- エンジン部分のみを改良し、多数の亜種を生成可能  
- 検知には**エミュレーション**や**静的解析＋ふるまい分析**が必要  

### 1.3 ポリモーフィックウイルスの代表例  

- **Cascade**(1987)暗号化型ウイルスの初期例  
- **Storm Worm(2007)** ポリモーフィック生成により亜種数百万以上  
- 現代のマルウェア(Emotet など)も類似技術を利用  

## 2. ステルス型ウイルス(Stealth Virus)

### 2.1 定義  

ステルス型ウイルスとは、**感染の痕跡を隠蔽し、OS/アンチウイルス/ユーザから検知されにくくするウイルス**です。  

エビデンス：  

- “Computer Virus Research and Defense (Fred Cohen)”  
- ステルス化はウイルスの代表的研究カテゴリとして位置付け  

### 2.2 代表的なステルス手法  

| 手法 | 内容 |
|------|-------|
| **ファイルサイズ偽装** | 感染時に元ファイルサイズを報告し、改変を隠す |
| **ディスク読込介入** | OSの I/O 要求を改ざんし、感染領域を非感染に見せる |
| **メモリ常駐型** | AV ソフトより先にロードし、検出処理を妨害 |
| **ルートキット化** | プロセス一覧/TCP接続/ファイルを隠す |

### 2.3 ステルスウイルスの例  

- **Frodo 4096**(MS-DOSステルスウイルスの代表格)  
- **TDL4**(高度なrootkit機能による隠蔽)  

## 3. マルチプラットホーム型ウイルス(Multi-platform/Cross-platform Virus)

### 3.1 定義  

マルチプラットホーム型ウイルスとは、**複数のOS(Windows/Linux/macOS 等)で動作するウイルス**です。  

裏付け：  

- AV-TEST、Kaspersky レポートにおける “Cross-platform malware” 分類  
- Java/JavaScript/Python/Macro などの共通ランタイムを悪用する例が増加  

### 3.2 特徴  

- プログラム言語や共通実行環境(Java VM/Python/.NET/Flash/ブラウザ)を利用  
- OS に依存しない攻撃が可能  
- 標的範囲が広く、攻撃の成功率が高い  
- Webベース(HTML5/JavaScript)でのマルウェアも増加  

### 3.3 マルチプラットホームウイルスの例  

- **Java.ByteVerify**(Java VMを悪用)  
- **CrossRat**(Windows/Linux/macOS対応)  
- **Script型マルウェア(JS/HTML5系)**  

## 4. 周辺知識：ウイルス分類と関連マルウェア技術

### 4.1 メタモーフィック型ウイルス(Metamorphic Virus)

ポリモーフィックよりさらに高度な変形型です。  
**復号ルーチンを持たず、ウイルス本体が毎回完全に別コードへ自動書き換え**されます。  

### 4.2 マクロウイルス(Macro Virus)

Excel/Word などの VBA を悪用したうウィルスです。  
OS に依存しないためマルチプラットホーム型の性質を持ちます。　　

### 4.3 ボット(Bot/Botnet)

外部から攻撃者に遠隔操作される感染端末のことです。  
DDoS 攻撃、フィッシングの踏み台などに利用されます。  

### 4.4 トロイの木馬(Trojan Horse)

有用なソフトに見せかけて感染させます。  
自律的に増殖しない点がウイルスと異なります。  

### 4.5 ランサムウェア(Ransomware)

ファイルを暗号化し、身代金を要求するマルウェアです。  
WannaCry 等が有名です。  

### 4.6 Rootkit(ルートキット)

OS の内部構造を改ざんし、マルウェアの存在を隠す技術です。  
ステルス型ウイルスの一部として利用されます。  

## 5. ウイルス検知手法

| 手法 | 説明 |
|------|------|
| **シグネチャ検知** | 特定バイト列を検知。ポリモーフィックには弱い |
| **ヒューリスティック検知** | 挙動/構造の特徴から悪意を推定 |
| **サンドボックス検知** | 仮想実行し挙動分析 |
| **機械学習ベース検知** | 学習モデルにより未知マルウェアを識別 |
