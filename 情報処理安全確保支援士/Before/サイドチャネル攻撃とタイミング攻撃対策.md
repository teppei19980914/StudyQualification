# サイドチャネル攻撃とタイミング攻撃対策(RFC/NIST/学術研究ベース)

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報セキュリティスペシャリスト平成24年春期 午前Ⅱ 問8](https://www.sc-siken.com/kakomon/24_haru/am2_8.html)  
[情報セキュリティスペシャリスト平成25年春期 午前Ⅱ 問5](https://www.sc-siken.com/kakomon/25_haru/am2_5.html)  
[情報処理安全確保支援士令和2年秋期 午前Ⅱ 問4](https://www.sc-siken.com/kakomon/02_aki/am2_4.html)  
[情報処理安全確保支援士令和5年秋期 午前Ⅱ 問12](https://www.sc-siken.com/kakomon/05_aki/am2_12.html)  

## サイドチャネル攻撃とは(Side‑Channel Attack)

サイドチャネル攻撃とは、**暗号アルゴリズムそのものではなく、実装が漏らす物理的特徴を観測して秘密情報を推定する攻撃です**。  

使用されるサイドチャネル例：  

- **処理時間(Timing)**  
- **電力消費(Power Consumption)**  
- **電磁放射(EM Emission)**  
- **キャッシュ動作(Cache Access/Branch Prediction)**  
- **音響ノイズ(Acoustic)**  
- **温度変化**  
- **DRAM残留(Cold Boot Attack)**  

暗号理論が安全でも、**実装が情報漏洩を起こす**と攻撃が成立してしまいます。  

## タイミング攻撃(Timing Attack)  

タイミング攻撃は、処理の実行時間の差から秘密情報(特に秘密鍵)を推定する手法です。  

#### 典型的な例：RSA の平方式処理

RSA の `square-and-multiply`(平方/乗算)処理は、秘密鍵のビットに応じて計算手順が変化します。  

- 0ビット → square のみ  
- 1ビット → square + multiply  

この違いが **実行時間差として観測可能** になり、攻撃者は距離が離れたネットワーク越しでも鍵を推定できるケースがあります。  

**実際に Kocher(1996)が RSA の秘密鍵の抽出に成功した歴史的攻撃です。**  

## 代表的なサイドチャネル攻撃

### 電力解析(Power Analysis Attack)

#### SPA(Simple Power Analysis)

電力波形の形状から処理分岐を読み取ります。  

#### DPA(Differential Power Analysis)

統計解析を駆使し微弱な電力差から秘密鍵を抽出します。  
**実世界のICカード攻撃で最も実用的です。**  

### 電磁波解析(EMA)

チップの処理に伴う電磁放射を専用センサで受信し、内部状態を再構築します。  

### キャッシュ攻撃(Cache Side‑Channel)

CPUキャッシュの「ヒット/ミス」による時間差を利用します。  

- AES の S‑box 参照時間から鍵推定  
- Spectre/Meltdown 系の投機実行攻撃  
- Flush+Reload/Prime+Probe など有名手法が多数  

### 音響攻撃(Acoustic Cryptanalysis)

RSA 計算中の CPU コイルの音を分析し秘密鍵を復元します。  

### Cold Boot Attack

DRAM は電源断後も数秒〜数分残留します。  
冷却すると残留時間が伸び、鍵情報が読み取られる。  

## タイミング攻撃の対策  

タイミング攻撃防止はサイドチャネル対策の中核です。  

### 定数時間実装(Constant‑Time Implementation)

処理時間が秘密情報に依存しないよう設計します。  

例：  

- `if (bit == 1)` といった条件分岐を排除  
- テーブル参照(S‑boxなど)を同一パターンに固定  
- RSA の「恒等時間モンゴメリ乗算」  
- ECDH の「Montgomery Ladder」(RFC 7748)  

RFC 7748(X25519/X448)は定数時間実装を強制する仕様です。  

### ランダム化(Blinding/Randomization)

#### RSA Blinding  

RSA の演算にランダム値を掛けて処理分岐の揺らぎを吸収します。  

#### ECC Blinding

楕円曲線スカラー値に乱数を加えます。  
ランダム性により処理時間の相関を破壊します。  

### ノイズ付加(Noise Injection)

電力消費、時間、EMリークに揺らぎを加え、統計解析を困難にします。  

### キャッシュ対策

- キャッシュを使わない計算パターン  
- キャッシュラインの分離  
- Speculative Execution の制御(Spectre対策)  
- Kernel Page Table Isolation(Meltdown対策)  

### 物理的対策(FIPS 140‑3 HSM要件)

- 電磁シールド  
- 電力線ノイズ吸収  
- タンパーレジスタント筐体  
- 不正開封検知  
- 鍵削除機能  

政府利用機関向けモジュールは FIPS 140‑3 認証が必須です。  

### FIPS(Federal Information Processing Standards)

NISTが制定しているアメリカ合衆国の情報処理標準規格群です。  
領域ごとに様々なセキュリティ対策基準が規定されています。  

## その他の「暗号を破る」攻撃手法(体系整理)

### 計算量ベースの攻撃

- ブルートフォース  
- 辞書攻撃  
- レインボーテーブル  

### 通信経路攻撃

- MITM攻撃  
- リプレイ攻撃  
- ダウングレード攻撃(SSL 3.0/TLS1.0強制)  

### プロトコル攻撃

- パディングオラクル攻撃  
- BLEICHENBACHER攻撃(PKCS#1 v1.5)  
- Lucky13(CBC)  

### 実装攻撃(Implementation Attacks)

- サイドチャネル攻撃(Timing/Power/Cache…)  
- フォールト攻撃(Fault Injection)  
- グリッチ攻撃(電圧/クロック異常注入)  

## 周辺知識：フォールト攻撃との違い

#### サイドチャネル攻撃  

**観測** による解析をします。  

#### フォールト攻撃  

**故意にエラーを発生させ、その結果から鍵を推定します。**  

例：  

RSA CRT をエラー化 → “Bellcore Attack” で秘密鍵を流出させます。  
