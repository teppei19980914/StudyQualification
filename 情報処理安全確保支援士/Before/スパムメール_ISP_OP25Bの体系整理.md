# スパムメール/ISP/OP25B の体系整理  

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報セキュリティスペシャリスト平成21年春期 午前Ⅱ 問4](https://www.sc-siken.com/kakomon/21_haru/am2_4.html)  
[情報セキュリティスペシャリスト平成24年秋期 午前Ⅱ 問5](https://www.sc-siken.com/kakomon/24_aki/am2_5.html)  
[情報セキュリティスペシャリスト平成28年春期 午前Ⅱ 問13](https://www.sc-siken.com/kakomon/28_haru/am2_13.html)  

## スパムメール(迷惑メール)とは  

**受信者の同意なく、一方向に大量に送信される電子メール**を指します。

スパムメールが問題となる理由：  

- マルウェア拡散(例：Emotet)  
- フィッシング詐欺(偽ログインページ)  
- 業務メールサーバの過負荷  
- 企業ブランドの毀損  

スパム送信元の多くは **マルウェアに感染した端末(Zombie PC)** が多くを占めます。  

## SMTP と宛先ポート番号 25 番  

SMTP(Simple Mail Transfer Protocol)は **電子メールの送信プロトコル** であり、RFC 2821(後継 RFC 5321)で定義されています。  

### ポート番号の役割  

|ポート番号|役割|RFC|
|---------|------|-----|
|**25(SMTP)**|メールサーバ間の配送(MTA間通信)|RFC 5321|
|**587(Submission)**|利用者→ISP のメール送信(認証必須)|RFC 6409|
|**465(SMTPS)**|TLSラップ方式(現在は「サブミッション TLS」)|RFC 8314|

### なぜポート 25 が問題になるのか  

- 認証が不要  
- 暗号化されていないことが多い  
- マルウェアが **直接外部のメールサーバへ送信できてしまう**  

これが **OP25B が導入される理由**です。  

## ISP(Internet Service Provider)  

ISP は総務省が定義する **電気通信事業者**であり、インターネット接続/メールサービス/セキュリティ対策を提供します。  

ISP の義務(総務省ガイドライン)：  

- 迷惑メール対策(OP25B の実施推奨)  
- 不正通信の遮断  
- 利用者通知/教育  
- ログ管理  

## OP25B(Outbound Port 25 Blocking)  

OP25B とは、**ISP が利用者端末から外部へのポート 25 宛の通信を遮断する仕組み**です。  

### OP25B が解決する問題  

マルウェアに感染した PC が**ISP のメールサーバを経由せずに世界中へ spam を直接送信**することを防止します。  

### 利用者はどうやってメールを送信するのか  

RFC 6409 に基づき **ポート 587 + SMTP AUTH(ユーザ認証)** を使用します。  

### 試験対策

以下の3つの条件すべてに合致する通信をISP側で遮断します。

* **ISP管理下**の動的IPアドレスから
* ISPのメールサーバを経由せずに**外向き（インターネット方向）**に発信される
* **SMTP**通信（TCPポート25番）

## スパムメール対策技術(送信ドメイン認証)

### SPF(Sender Policy Framework)  

**DNS に「送信を許可するメールサーバ」を登録する仕組みです。**  

### DKIM(DomainKeys Identified Mail)  

**送信ドメインによる電子署名を付与し、改ざん/なりすましを検知します。**  

### DMARC(Domain-based Message Authentication, Reporting & Conformance)  

SPF/DKIM の結果に基づく **受信側の拒否ルール** を定義しています。  

## その他のスパム対策

### ブラックリスト方式(RBL：Realtime Blackhole List)  

悪意のある IP アドレス/ドメインを登録し拒否します。  

### ホワイトリスト方式  

信頼できる相手のみ受信を許可します。  

### Content Filter(内容解析)  

- ベイズ推定  
- 機械学習  
- URL 評価(ブラックリスト参照)  

### SMTP AUTH(認証)  

Submission(587)で必須です。  
ID/パスワードで本人性を確認。  

## スパム関連の攻撃手法

|攻撃手法|説明|
|--------|------|
|フィッシング|偽装したログインページへ誘導|
|スピアフィッシング|特定の組織/人物を狙い撃ち|
|BEC(ビジネスメール詐欺)|取引先を装った送金指示など|
|Emotet などのマルウェア添付|添付ファイル/URLで感染|
|Typosquatting|類似ドメインによる偽サイト|
