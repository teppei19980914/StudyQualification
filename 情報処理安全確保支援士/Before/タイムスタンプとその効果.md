# タイムスタンプとその効果

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報セキュリティスペシャリスト平成22年秋期 午前Ⅱ 問21](https://www.sc-siken.com/kakomon/22_aki/am2_21.html)  

## タイムスタンプとは何か

### 定義

- RFC 3161(Time-Stamp Protocol : TSP)
- 総務省「タイムスタンプ技術解説」
- 電子署名法関連ガイドライン

**タイムスタンプとは、ある電子データが「ある時刻に確実に存在していた」ことを第三者が証明する仕組みです。**

### タイムスタンプの本質

タイムスタンプは次の2点を証明します。

1. **存在証明**  
   - その時刻にそのデータが存在していた
2. **非改ざん性の担保**  
   - その後、内容が変更されていない

→ **「誰が作ったか」は証明しない**点が非常に重要

## タイムスタンプの仕組み

### 基本構造

```
利用者
↓(ハッシュ値送信)
TSA(時刻認証局)
↓(署名付きタイムスタンプ)
利用者
```

- TSA：Time Stamping Authority(時刻認証局)

### 処理の流れ

1. 対象データの **ハッシュ値** を計算
2. ハッシュ値を TSA に送信
3. TSA が
   - 時刻情報
   - 受け取ったハッシュ値
   を **電子署名**
4. 利用者は署名付き時刻情報を受領

→ **元データそのものは TSA に渡さない**ため、安全性が高い

## タイムスタンプの効果

### 効果①：存在証明(存在時刻の証明)

下記のようなデータで利用され、「このデータは **この時刻より前には存在していた**」ことを証明します。  

- 契約書
- 設計書
- ログデータ

### 効果②：改ざん検知

- 元データのハッシュ値が変わる
- タイムスタンプ検証に失敗

→ **タイムスタンプ以降の改ざんが検出可能**

### 効果③：電子署名の有効期限問題の解消

電子署名には下記弱点があります。

- 証明書には **有効期限** がある
- 失効すると、後から署名の正当性が疑われる

#### タイムスタンプ付与の効果

「証明書が有効だった時点で署名されていた」ことを証明できます。  
→ **長期署名(Long-Term Signature)を可能**

## タイムスタンプと電子署名の関係

| 項目 | 電子署名 | タイムスタンプ |
|---|---|---|
| 本人性 | 証明できる | 証明しない |
| 改ざん検知 | 可能 | 可能 |
| 時刻の証明 | 不十分 | **可能** |
| 有効期限対策 | 弱い | **補完可能** |

→ **両者は競合ではなく補完関係**

## 関連知識①：RFC 3161(Time-Stamp Protocol)

- IETF による国際標準
- ハッシュアルゴリズム＋電子署名
- X.509 証明書を利用

→ **PKI 技術の一部として位置付けられる**

## 関連知識②：法的証拠能力との関係

- 電子帳簿保存法
- 電子契約
- 内部統制(証跡管理)

これらでは、下記であることが重要視されます。  

- タイムスタンプ付きデータ
- 改ざん検知可能
