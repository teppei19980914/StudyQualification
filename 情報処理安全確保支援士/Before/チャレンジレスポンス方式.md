# チャレンジレスポンス方式  

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報セキュリティスペシャリスト平成21年秋期 午前Ⅱ 問1](http://sc-siken.com/kakomon/21_aki/am2_1.html)  

## 1. チャレンジレスポンス方式(Challenge-Response Authentication)

チャレンジレスポンス方式は、**サーバがランダムな値(チャレンジ)をクライアントに送り、クライアントが秘密情報を使って応答(レスポンス)を生成する方式の認証手法**です。  

重要なポイント：  

- パスワードを **そのまま送信しない**  
- チャレンジ値が毎回変わるため **リプレイ攻撃に耐性**  
- パスワード盗聴リスクを大幅に低減  
- ネットワーク認証で広く採用(PPP/MS-CHAP/Wi-Fi 802.1X など)  

## 2. 認証の流れ(一般的なチャレンジレスポンス)

以下のようなプロセスで行われます。  

1. **サーバがランダム値(Nonce)を生成して送付**  
2. クライアントは **秘密鍵またはパスワード** とチャレンジ値をハッシュ関数などで組み合わせレスポンスを生成  
3. サーバは同手順でレスポンスを計算し比較  
4. 一致すれば **正当ユーザであることを証明**  

## 3. エビデンスに基づく代表例

### ■ CHAP(Challenge-Handshake Authentication Protocol) 

PPP接続で使用されるチャレンジレスポンス方式のことです。  

特徴：  

- チャレンジ値はランダム  
- パスワードはネットワークに送られない  
- 認証成功後も **再チャレンジ** を行うことでセッション乗っ取りを防止  
- MD5 を使用(歴史的理由による)  

CHAP メッセージ構成：  

- Challenge  
- Response  
- Success/Failure  

### ■ ISO/IEC 9798 シリーズ(多要素認証の基盤)

ISO/IEC 9798-2：  
- 対称鍵方式のチャレンジレスポンス  

ISO/IEC 9798-3：  
- 公開鍵暗号を用いたチャレンジレスポンス  

公開鍵方式の場合：  

- サーバは乱数をクライアントへ送信  
- クライアントが **秘密鍵で署名** → サーバが公開鍵で検証  

この仕組みは **TLS クライアント認証** の基礎となっています。  

## 4. チャレンジレスポンス方式の利点と課題

### ■ 利点

- パスワードの平文送信が不要  
- リプレイ攻撃耐性が高い  
- 辞書攻撃への耐性も向上  
- 認証方式として軽量で実装が容易  

### ■ 課題

- パスワードがハッシュ化されても、ハッシュ値自体を狙う攻撃が存在  
  (例：MS-CHAPv2 の脆弱性)  
- ハッシュ関数の強度に依存  
- クライアント側に秘密情報管理が必要  

## 5. 周辺知識(試験によく出る)

### ■ 1. One-time Password(OTP：ワンタイムパスワード)

チャレンジレスポンスの概念を発展させた方式です。  

代表例：  
- HOTP(RFC 4226)  
- TOTP(RFC 6238)  

特長：  
**毎回異なるパスワードを生成 → 盗まれても再利用されません。**  

### ■ 2. Mutual Authentication(相互認証)

チャレンジレスポンスは **サーバ⇄クライアント双方で行い、相互認証にも応用**されます。  

利用例：  

- Kerberos  
- TLS クライアント証明書  

### ■ 3. Zero-Knowledge Proof(ZKP：ゼロ知識証明)

チャレンジレスポンスを高度化した概念です。  

目的：  

**自分の秘密を明かさずに、自分が秘密を知っていることだけを証明します。**  

応用例：  

- 新しい認証プロトコル(例えば SRP)  
- ブロックチェーン技術内での証明手法  
