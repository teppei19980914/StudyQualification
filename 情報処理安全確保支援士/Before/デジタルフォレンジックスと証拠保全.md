# デジタルフォレンジックスと証拠保全

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報処理安全確保支援士平成29年秋期 午前Ⅱ 問16](https://www.sc-siken.com/kakomon/29_aki/am2_16.html)  
[情報処理安全確保支援士令和3年秋期 午前Ⅱ 問12](https://www.sc-siken.com/kakomon/03_aki/am2_12.html)  

## デジタルフォレンジックスとは

### 定義(エビデンス)

**デジタルフォレンジックス(Digital Forensics)**とは、コンピュータやネットワーク等の電子的記録を**法的証拠として利用可能な形で収集/保全/解析/報告する技術および手続**です。  

#### 主な定義元

- NIST SP 800-86  
- ACPO Guidelines(英警察)
- IPA「デジタル/フォレンジック/ガイドライン」

### デジタルフォレンジックスの目的

| 観点 | 内容 |
|---|---|
| 技術的目的 | インシデント原因/侵入経路の特定 |
| 法的目的 | 証拠能力を保持した証拠提出 |
| 組織的目的 | 再発防止/内部統制 |

→ **「調査」ではなく「証拠化」が本質**である点が重要です。

## フォレンジックスで最重要となる考え方

### 証拠能力の維持

証拠は以下を満たす必要があります。  

- 完全性(改ざんされていない)
- 再現性(第三者が検証可能)
- 追跡性(誰が/いつ/何をしたか)

これを支えるのが **証拠保全の原則**です。

## 証拠の滅失を避けるための原則(最重要)

### 原則の背景

デジタルデータは、下記などにより **瞬時に消失/変化** します。  
そのため、**誤った手順＝証拠能力の喪失**につながります。  

- 電源断
- 再起動
- 通信切断

### 基本原則(エビデンス：ACPO/IPA)

#### 原則①：原本に手を加えない

- 原本データは変更しない
- 作業は必ず **複製(イメージ)** に対して実施

#### 原則②：完全性を証明できること

- ハッシュ値(SHA-256等)で改ざん検証
- 取得前後でハッシュ一致を確認

#### 原則③：第三者が検証可能であること

- 手順書/ログを残す
- 属人化しない

#### 原則④：責任の所在を明確にする

- 誰が証拠を扱ったか(Chain of Custody)

## 証拠保全の順番(Order of Volatility)

### なぜ「順番」が重要か

デジタル証拠には **揮発性の違い**があります。
→ 消えやすいものから優先的に保全する必要があります。

### 証拠保全の代表的な順序(試験頻出)

以下は **IPA/NIST で広く採用されている順序**です。  

| 優先度 | 証拠例 |
|---|---|
| ① 最優先 | CPUレジスタ、キャッシュ |
| ② | メインメモリ(RAM) |
| ③ | ネットワーク接続情報、通信セッション |
| ④ | 実行中プロセス、ログインユーザ |
| ⑤ | ディスク上のログ、ファイル |
| ⑥ | バックアップ媒体 |

**ポイント：「電源を切る前にメモリを取る」**  
**参考URL：[RFC3227 証拠収集とアーカイビングのためのガイドライン](https://www.nic.ad.jp/ja/tech/ipa/RFC3227JA.html)**  

### 試験で狙われる誤り例

❌ まず電源を切る  
    → RAM 情報が消失  

❌ OS標準コマンドで操作  
    → 証拠改変の疑い  

## Chain of Custody(証拠管理の連鎖)

### 概要

**Chain of Custody** とは、証拠が取得されてから提出されるまでの管理/移動/取扱の記録のことです。  

### 記録すべき情報

- 証拠ID
- 取得日時
- 取得者
- 保管場所
- 取扱履歴

## デジタルフォレンジックスの一般的プロセス

| フェーズ | 内容 |
|---|---|
| 収集 | 証拠取得(揮発性優先) |
| 保全 | ハッシュ計算/封印 |
| 解析 | 不正操作/侵入経路分析 |
| 報告 | 時系列/因果関係整理 |

## 周辺知識(試験で差がつく)

### ライブフォレンジックス

- 稼働中システムから証拠取得
- メモリ/通信情報が対象
- 証拠改変リスクあり → 熟練が必要

### デッドフォレンジックス

- 電源断後の記憶媒体解析
- 再現性が高い
- 揮発情報は取得不可

### ハッシュアルゴリズム

| アルゴリズム | 用途 |
|---|---|
| SHA-256 | 証拠完全性確認 |
| SHA-1 | 非推奨 |
| MD5 | 衝突のため不可 |
