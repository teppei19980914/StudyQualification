# マルウェア検知技術の体系的まとめ

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報セキュリティスペシャリスト平成25年春期 午前Ⅱ 問3](https://www.sc-siken.com/kakomon/25_haru/am2_3.html)  

## 1. マルウェア検知方式の全体像

マルウェア検知手法は、大きく以下の 5 つに分類されます。  

| 検知方式 | 特徴 | 代表用途 |
|-----------|--------|-----------|
| パターンマッチング法 | 既知のウイルスに最も強い | 従来型アンチウイルスエンジン |
| チェックサム法 | 改ざん検知に強い | ファイル監視/整合性検査 |
| コンペア法 | 正常ファイルとの差分検出 | ブート領域検査 |
| ビヘイビア法 | 挙動から悪意を判断 | EDR/Sandboxing |
| ヒューリスティック法 | 未知/亜種に強い推論方式 | 次世代 AV の中核 |

## 2. パターンマッチング法(Signature-based Detection)

### 2.1 定義  

IPA/AV-TEST などで「**既知のマルウェアの特徴的バイト列(シグネチャ)を用いた検知方式**」と定義されています。  

### 2.2 仕組み  

- マルウェアから抽出した特徴バイト列をデータベース化  
- ファイルを走査し、該当シグネチャと一致すれば検知  

### 2.3 利点  

- 高速/誤検知が少ない  
- シンプルな検知方式  

### 2.4 欠点  

- 未知/変形型ウイルスには無力  
- シグネチャ更新が必須  

## 3. チェックサム法(Checksum-based Detection)

### 3.1 定義  

チェックサム法とは、**ファイルから計算したチェックサム値を正常時の値と比較**し、ファイル改ざんを検知する方式です。  

### 3.2 特徴  

#### ✔ 長所

- ファイルの改変を高精度に検出  
- ブート領域/重要ファイル監査で利用可能  

#### ✘ 短所

- ウイルスがチェックサム計算を迂回する場合は検出不可  
- 変形型ウイルスへの耐性は低い  

## 4. コンペア法(Compare Method)

### 4.1 定義  

**正常な基準ファイル(もしくはクリーンイメージ)と比較し、差分から感染を検出する方式**です。  

### 4.2 特徴  

- OS のブート領域検査/システムファイル整合性検査に利用  
- 正常ファイルを常に保持する必要がある  
- ステルス型ウイルスが I/O を改ざんすると回避される  

## 5. ビヘイビア法(Behavior-based Detection)

### 5.1 定義  

ビヘイビア法とは、**ファイル書き込み/プロセス生成/レジストリ改変/通信などの挙動を監視し、悪意の有無を判断する方式**です。  
これは現代の **EDR(Endpoint Detection & Response)** の基礎技術。  

### 5.2 検知対象  

- 未知マルウェア  
- ファイルレスマルウェア  
- スクリプト型攻撃  

### 5.3 欠点  

- 正常動作との線引きが難しく、誤検知が発生しやすい  
- コスト/監視負荷が高い  

## 6. ヒューリスティック法(Heuristic Detection)

### 6.1 定義  

ヒューリスティック法とは、**構造解析(静的)と挙動解析(動的)により、怪しい特徴を推論し未知マルウェアを検知する方式**です。  
AV製品の「次世代検知エンジン」の中心技術です。  

### 6.2 種類  

#### ● 静的ヒューリスティック  

下記を解析し、マルウェアらしさを評価します。  

- API 呼び出し  
- 自己書換コード  
- 暗号化ルーチン  

#### ● 動的ヒューリスティック  

- サンドボックスにより実際に実行して評価  
- ランサムウェアのファイル大量暗号化などを検出  

## 7. 検知方式の比較

| 検知方式 | 既知ウイルス | 未知ウイルス | 変形型 | 誤検知 | 主な用途 |
|-----------|--------------|--------------|--------|--------|-----------|
| パターンマッチング | ◎ | × | × | 少 | 従来型 AV |
| チェックサム法 | △ | × | × | 少 | 改変検出 |
| コンペア法 | △ | × | × | 少 | ブート領域監査 |
| ビヘイビア法 | ○ | ○ | ○ | 多 | EDR/Sandbox |
| ヒューリスティック法 | ○ | ◎ | ○ | 中 | 次世代AV |

## 8. 周辺知識

### 8.1 サンドボックス(Sandbox)  

仮想環境でマルウェアを実行し、挙動を観察する技術です。  
Emotet/ランサムウェア対策で必須です。  

### 8.2 EDR(Endpoint Detection & Response)  

端末の動作ログを収集し、攻撃チェーンを分析/可視化する新世代防御です。  

### 8.3 機械学習によるマルウェア検知  

未知マルウェア分類において、ヒューリスティック＋ML が主流です。  

### 8.4 変形型ウイルス(Polymorphic/Metamorphic)

下記どちらもシグネチャ型を回避します。  

- **ポリモーフィック**：暗号化＋復号ルーチン変形  
- **メタモーフィック**：本体コードを完全書換  
