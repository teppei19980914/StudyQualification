# リスクベース認証/マトリクスコード認証/多要素認証

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報セキュリティスペシャリスト平成28年秋期 午前Ⅱ 問6](https://www.sc-siken.com/kakomon/28_aki/am2_6.html)  

## 多要素認証(MFA：Multi-Factor Authentication)

### 多要素認証の定義(エビデンス)

- NIST SP 800-63B(Digital Identity Guidelines)
- IPA「認証技術の解説」

**多要素認証とは、異なる種類の認証要素を2つ以上組み合わせて本人確認を行う方式です。**

### 認証要素の3分類(基本)

| 分類 | 内容 | 例 |
|---|---|---|
| 知識情報 | 本人しか知らない | パスワード、暗証番号 |
| 所持情報 | 本人が持っている | ICカード、トークン |
| 生体情報 | 本人の身体的特徴 | 指紋、顔、虹彩 |

→ **同一分類を複数使っても多要素認証にはならない**  
(例：パスワード＋秘密の質問 → 多要素ではない)

### 多要素認証の目的

- パスワード漏えい時の被害抑止
- なりすまし/リプレイ攻撃対策
- リモートアクセスの安全性向上

## マトリクスコード認証(Matrix Code Authentication)

### マトリクスコード認証の概要

**マトリクスコード認証とは、縦横の行列(マトリクス)に配置された文字や数字の中から、指定された位置の値を入力させる認証方式です。**

### 認証要素の位置づけ

- 基本的には **知識情報**
- 紙カードやトークンを用いる場合は **所持情報と組み合わせ可能**

### マトリクスコード認証の特徴

| 観点 | 内容 |
|---|---|
| 利点 | ワンタイム性があり盗聴に強い |
| 欠点 | カード紛失時のリスク |
| 利用例 | インターネットバンキング |

→ **固定パスワードより安全だが、単独では万能ではない**

## リスクベース認証(Risk-Based Authentication)

### リスクベース認証の定義(本問の核心)

**リスクベース認証とは、利用者の状況(リスク)を評価し、その結果に応じて認証強度を動的に変化させる認証方式です。**
(エビデンス：NIST SP 800-63B, OWASP Authentication Cheat Sheet)

### 評価される主なリスク要素

| 要素 | 具体例 |
|---|---|
| 利用端末 | 登録済み端末か否か |
| 接続元IP | 国内/国外、過去実績 |
| 利用時間 | 深夜/異常時間帯 |
| 行動パターン | 通常と異なる操作 |
| 地理情報 | 短時間での国移動 |

### リスクベース認証の動作例

| 状況 | 認証動作 |
|---|---|
| 低リスク | ID＋パスワードのみ |
| 中リスク | 追加でワンタイムパスワード |
| 高リスク | ログイン拒否 or 本人確認 |

→ **常に多要素を要求しない点が重要**

## 周辺知識①：ワンタイムパスワード(OTP)

- HOTP(RFC 4226)
- TOTP(RFC 6238)

→ 時間やカウンタに基づく一時的パスワード

## 周辺知識②：FIDO認証とパスワードレス

- FIDO2/WebAuthn
- 生体認証＋公開鍵暗号
- フィッシング耐性が高い

## 周辺知識③：ステップアップ認証

- リスクベース認証の実装形態
- 通常操作 → 簡易認証
- 重要操作 → 強認証
