# 仮想通貨環境とクリプトジャッキング

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報処理安全確保支援士平成31年春期 午前Ⅱ 問5](https://www.sc-siken.com/kakomon/31_haru/am2_5.html)  

## 仮想通貨環境とは

### 定義

仮想通貨環境とは、**暗号資産(仮想通貨)の生成/管理/取引/検証を行うための技術基盤および運用環境の総称**です。  
主に以下を含みます。  

- ブロックチェーンネットワーク
- マイニング(採掘)環境
- ウォレット(秘密鍵管理)
- 取引所/ノード/スマートコントラクト

### 仮想通貨の技術的前提

仮想通貨は以下の技術に依存します。

- 公開鍵暗号方式(ECDSA 等)
- ハッシュ関数(SHA-256 等)
- 分散合意アルゴリズム(PoW/PoS)
- P2P ネットワーク

※ これらは改ざん耐性を高める一方、**計算資源への依存度が高い**という特徴を持ちます。  

## マイニングと計算資源

### マイニングの概要

マイニングとは、**取引の正当性検証とブロック生成を行う計算作業**であり、成功すると報酬として仮想通貨が得られます。  

- Proof of Work(PoW)では大量の CPU/GPU 計算が必要
- 電力/計算資源が直接コストになる

### 攻撃者視点の問題点

- 正規マイニング：電気代/設備投資が必要
- 不正マイニング：**他人の計算資源を使えばコストゼロ**

→ ここで登場するのが **クリプトジャッキング**です。  

## クリプトジャッキングとは

### 定義(エビデンス)

**クリプトジャッキング(Cryptojacking)**とは、利用者の同意なく、他人のコンピュータやサーバの CPU/GPU 資源を用いて仮想通貨のマイニングを行う不正行為です。  
IPA/JPCERT/CC/MITRE ATT&CK でも**不正なリソース利用型マルウェア行為**として整理されています。  

### マルウェアとの違い(試験で重要)

| 項目 | 情報窃取型マルウェア | クリプトジャッキング |
|---|---|---|
| 主目的 | 情報の盗難 | 計算資源の不正利用 |
| 痕跡 | データ漏えい | CPU 使用率上昇 |
| 被害 | 情報流出 | 性能劣化/電力消費 |
| 発覚 | 比較的早い | 気付きにくい |

## クリプトジャッキングの主な手法

### マルウェア感染型

- メール添付
- 不正サイト
- 脆弱なサーバへの侵入

感染後、バックグラウンドで常時マイニングを実行します。

### Webブラウザ型(スクリプト型)

- Web ページに JavaScript マイニングコードを埋め込む
- ページ閲覧中のみ CPU を使用

過去に **Coinhive** などが問題となりました。  

### クラウド/仮想環境の悪用(重要)

- IaaS の認証情報漏えい
- Kubernetes の設定不備
- 管理用 API の公開

## 被害の具体例

- サーバ応答遅延
- クラウド利用料金の急増
- CPU 温度上昇による機器劣化
- バッテリー消耗(モバイル端末)

## 対策(エビデンス：IPA/JPCERT)

### 技術的対策

- EDR/挙動検知型ウイルス対策
- CPU 使用率の監視
- Web スクリプト制御(NoScript 等)
- クラウド IAM 設定の最小権限化

### 運用的対策

- 不審な負荷増大の監視
- 利用料金アラート設定
- OS/ミドルウェアの脆弱性管理

## 関連知識

### クラウドと仮想通貨攻撃

- IaaS は攻撃者にとって「理想的なマイニング環境」
- 認証情報漏えい＝即マイニング

### MITRE ATT&CK との関係

- T1496(Resource Hijacking)として分類
- ランサムウェアとは異なる収益モデル

### ランサムウェアとの比較

| 観点 | ランサムウェア | クリプトジャッキング |
|---|---|---|
| 収益 | 一時的 | 継続的 |
| 目立ちやすさ | 高い | 低い |
| 被害通知 | 必須 | 不要 |
