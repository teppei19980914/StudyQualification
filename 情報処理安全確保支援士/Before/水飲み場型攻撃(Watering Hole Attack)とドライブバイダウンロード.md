# 水飲み場型攻撃(Watering Hole Attack)とドライブバイダウンロード

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報セキュリティスペシャリスト平成27年秋期 午前Ⅱ 問8](https://www.sc-siken.com/kakomon/27_aki/am2_8.html)  

## 1. 水飲み場型攻撃(Watering Hole Attack)

### ■ 1.1 定義  

水飲み場型攻撃とは、**攻撃者がターゲット組織のユーザが日常的に利用している Web サイトを侵害し、その利用を通じてマルウェア感染させる攻撃手法**です。  

名前の由来：  

- 野生動物が水飲み場に集まる習性を利用するように、“ターゲットが訪れると分かっている場所(サイト)”に罠を仕掛けることに由来しています。  

### ■ 1.2 攻撃の流れ(MITRE ATT&CK: T1189)

1. 攻撃者が標的企業の社員がよくアクセスするサイトを調査  
2. その Web サイトに対して脆弱性攻撃やパスワード窃取により改ざん  
3. 改ざんページにマルウェア配布スクリプトを設置  
4. 標的企業のユーザがそのサイトにアクセス  
5. ブラウザやプラグインの脆弱性を悪用し感染  
6. 攻撃者が内部ネットワーク侵害へと横展開(Lateral Movement)  

### ■ 1.3 水飲み場型攻撃の特徴

- **標的型(Targeted Attack)である**  
- メールではなく Web 経由で感染  
- 社外の Web サイトが攻撃点となる  
- 感染に気付きにくい  
- APT 攻撃(高度持続的攻撃)の一部として利用されやすい  

## 2. ドライブバイダウンロード(Drive-by Download)

### ■ 2.1 定義(OWASP)

ドライブバイダウンロードとは、利用者が Web サイトを閲覧しただけで、**意図せずマルウェアがダウンロード/実行される攻撃**です。  
ユーザ操作(クリック/保存)を必要としない点が特徴です。  

### ■ 2.2 典型的な攻撃手法

- ブラウザの脆弱性(Chrome/IE/Firefox)  
- プラグインの脆弱性(Flash, Java, Silverlight)  
- アドネットワーク経由の悪性広告(Malvertising)  
- スクリプトによる exploit kit 呼び出し  

### ■ 2.3 代表的な Exploit Kit

| Exploit Kit | 特徴 |
|--------------|------|
| Angler EK | Flash/IE 脆弱性を攻撃、最盛期に流行 |
| Nuclear EK | 暗号化通信により検知困難 |
| Blackhole EK | 初期の大規模攻撃ツール |

## 3. 水飲み場攻撃とドライブバイダウンロードの関係

水飲み場型攻撃の改ざんサイトではしばしば**ドライブバイダウンロードが仕掛けられています。**
すなわち、下記のような関係が成り立ちます。  

- 水飲み場型攻撃 ＝ 侵害された信頼サイトで待ち伏せ  
- ドライブバイダウンロード ＝ 感染手口

## 4. 具体的な攻撃例(実在の事例)

- 国内外の政府機関サイト改ざんによる標的型攻撃  
- ソフトウェア企業のサイトに不正 iframe を埋め込み感染  
- ゼロデイ脆弱性を使った攻撃が高頻度で利用  

APT 攻撃グループ(例：APT10, Lazarus)がよく使用します。  

## 5. 対策(IPA/NIST SP800-30)

### ■ 5.1 Web ブラウザ側の対策

- ブラウザ/プラグインを最新に保つ  
- Flash や Java を無効化  
- URL フィルタリング(不正サイト遮断)  
- スクリプト制御(NoScript 等)  
- サンドボックス実行(Chrome/Edge)  

### ■ 5.2 組織側の対策

- EDR(Endpoint Detection & Response)  
- Proxy での不正通信検知  
- 社員のアクセス先ドメイン監査  
- 改ざんサイトが判明した場合の迅速なブロック  

### ■ 5.3 Web サイト運営側の対策

- CMS(WordPress など)の脆弱性対策  
- パスワード強化/多要素認証  
- Web サーバの脆弱性管理  
- 改ざん検知ツール(WAF, Integrity Monitor)  

## 6. 周辺知識(試験で頻出)

### ■ 6.1 APT(Advanced Persistent Threat)

標的型攻撃の総称。長期間/継続的な侵害活動を行います。  

### ■ 6.2 CSRF/XSS との違い

- XSS：攻撃者がスクリプトを実行させる(サイトは攻撃者未侵害)  
- 水飲み場攻撃：**サイトが攻撃者により侵害されている**  

### ■ 6.3 マルウェア配布の手口

- マルバタイジング(Malvertising)  
- Fake Update(偽更新)  
- ソーシャルエンジニアリングによる誘導  

### ■ 6.4 ゼロデイ攻撃

未知の脆弱性が使われるため、防御が困難です。  
