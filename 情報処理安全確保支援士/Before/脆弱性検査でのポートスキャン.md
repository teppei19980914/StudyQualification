# 脆弱性検査でのポートスキャン

## はじめに

2025年10月のプロジェクトマネージャ試験受験を終え、2026年春の情報処理安全確保支援士に向けて勉強中です。  
本記事を含めた各知識のインデックスや学習の道のりについては、「[情報処理安全確保支援士への道のり(随時更新中)](https://qiita.com/teppei19980914/items/6411cb70f2937cbefdcc)」をご参照ください。  
**本記事は学習した内容を記載しています。**  

## 該当問題

[情報セキュリティスペシャリスト平成27年秋期 午前Ⅱ 問15](https://www.sc-siken.com/kakomon/27_aki/am2_15.html)  

## 脆弱性検査(Vulnerability Assessment)

システムの弱点(脆弱性)を特定するために、ネットワークスキャン/サービス列挙/設定診断/既知脆弱性の検査などを体系的に行うプロセスです。  

### 脆弱性検査の主要手法

* ネットワークスキャン(Port Scanning/Service Scanning)  
* ホスト設定評価(Configuration Review)  
* アプリケーション脆弱性検査(Web/API)  
* パッチ適用状況の確認  
* 脆弱性スキャナ(例：Nessus/OpenVAS)の使用  

## ポートスキャン(Port Scanning)

ターゲットホストのポート(TCP/UDP)に対し、接続要求またはパケットを送り、開いているポート(Open)/閉じているポート(Closed)/フィルタリングされているポートを識別する行為で鵜ｓ。  
**ポートスキャンは脆弱性検査の基礎であり、攻撃者の偵察の第一段階**  

### 代表的なポートスキャン手法

1. TCP Connect Scan(フルコネクトスキャン)  
    * OSが行う通常の3ウェイハンドシェイクを実行  
    * 最も確実だが目立つ  
2. SYN Scan(半開スキャン/Stealth Scan)  
    * SYN → SYN/ACK(Open)で判断  
    * 完全接続しないためステルス性が高い  
    * Nmapのデフォルト手法  
3. UDP Scan  
    * UDPは応答が返却されないため難しい  
    * ICMP Port UnreachableでCloseを判定  
4. FIN/Xmas/Nullスキャン  
    * FW回避のために使われる  
    * 現代のODでは対策されていることが多い  

### ポートスキャンでわかる情報

* 稼働中のサービス(例：22/ssh, 80/http, 443/https)  
* 不要なサービスの発見  
* ファイアウォールの設定状況  
* 外部公開されてはいけない管理ポート(Telnet/RDP等)  
* 攻撃対象となりうるソフトウェア(Apache/MySQLなど)

### ポートスキャンの結果

* 開いているポートがわかることで、攻撃対象の入り口となる  
    * 80/tcp：XSS, SQLi, OSコマンドインジェクション  
    * 22/tcp：SSHブルートフォース  
    * 445/tcp：SMB脆弱性(EternalBlue)  
    * 3389/tcp：RDP強制攻撃  
    * 161/udp：SNMP情報漏えい  

## 脆弱性スキャナ(Vulnerability Scanner)の仕組み

### 主なスキャナ

* Nessus  
* OpenVAS  
* QualysGuard  
* Nikto(Web)  
* Burp Suite(Webアプリ)  

### 実施内容

* ポートスキャン  
* サービスバナー取得(Banner Grabbing)  
* バージョン判定  
* 既知脆弱性DB(CVE/NVD)との照合  
* 設定ミス(Misconfiguration)検査  
* 弱いパスワードの試行  

## 周辺知識

### OSフィンガプリント(OS Fingerprinting)

「SYN/ACKのTTL値」や「応答フラグの違い」からOSを推測する技術です。  

### Banner Grabbing(バナー取得)

```TEXT
$ nc example.com 80
HTTP/1.1 200 OK
Server: Apache/2.4.1
```

サーバのバージョン等が漏れることにより、該当バージョンの脆弱性が特定されてしまいます。  

### ファイアウォール越えのスキャン

* Idle Scan(ゾンビホストを利用)  
* Fragmentation(パケット断片化)  
* Source Port Manipulation(DNSポート53を偽装)  

### ポートステート分類(Nmap)

|Closed|意味|
|:----|:----|
|Open|受信し応答あり(サービス稼働中)|
|Closed|応答はあるがサービスなし|
|Filtered|FWにより遮断、応答なし|
|Unfiltered|応答はあるが状態不明|

### 脆弱性検査とペネトレーションテストとの違い

下記表のとおり、脆弱性検査は「安全に弱点を洗い出す」ものであり、ペネトレーションテストは「実際に侵入できるかを確認する」ものです。  

|種類|目的|内容|
|:----|:----|:----|
|脆弱性検査(VA)|弱点を見つける|スキャン中心、非破壊|
|侵入テスト(Penetration Test)|実際に突破できるか|攻撃を実行(制御された攻撃)|
